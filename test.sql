-- Q0001 [OK]
MERGE INTO "MARKETS" T
USING (SELECT 3272639 AS MARKET_ID, 9583731 AS POPULATION) S
ON (T."MARKET_ID" = S.MARKET_ID)
WHEN MATCHED THEN UPDATE SET T."POPULATION" = S.POPULATION
WHEN NOT MATCHED THEN INSERT ("MARKET_ID","POPULATION") VALUES (S.MARKET_ID, S.POPULATION);
-- Q0002 [OK]
INSERT INTO "DIM_DATE" ("SALES_DATE") VALUES (DATE '2009-09-08');
-- Q0003 [OK]
UPDATE "MARKETS" SET "POPULATION" = 19054354 WHERE "MARKET_ID" = 4904069;
-- Q0004 [FAIL]
SELECT * FROM "SALESX" LIMIT 10;
-- Q0005 [OK_PREP]
INSERT INTO "MARKETS" ("MARKET_ID","POPULATION") VALUES (?, ?);
-- Q0006 [OK]
DELETE FROM "SALES_POSITIONS" WHERE "SALES_ID" = 738869;
-- Q0007 [FAIL]
SELECT "NOPE" FROM "SALES" LIMIT 10;
-- Q0008 [OK]
SELECT S."SALES_ID", S."SALES_DATE", SP."ARTICLE_ID", SP."AMOUNT" FROM "SALES" S JOIN "SALES_POSITIONS" SP ON SP."SALES_ID" = S."SALES_ID" LIMIT 200;
-- Q0009 [OK]
UPDATE "MARKETS" SET "POPULATION" = 1185387 WHERE "MARKET_ID" = 4612561;
-- Q0010 [OK]
MERGE INTO "MARKETS" T
USING (SELECT 6185514 AS MARKET_ID, 6740940 AS POPULATION) S
ON (T."MARKET_ID" = S.MARKET_ID)
WHEN MATCHED THEN UPDATE SET T."POPULATION" = S.POPULATION
WHEN NOT MATCHED THEN INSERT ("MARKET_ID","POPULATION") VALUES (S.MARKET_ID, S.POPULATION);
-- Q0011 [FAIL]
SELECT M."MARKET_ID" FROM "MARKETS" M WHERE M."CITY_NAME" IS NOT NULL;
-- Q0012 [OK]
INSERT INTO "MARKETS" ("MARKET_ID","POPULATION") VALUES (5231953, 8262910);
-- Q0013 [OK_PREP]
UPDATE "MARKETS" SET "POPULATION" = ? WHERE "MARKET_ID" = ?;
-- Q0014 [OK]
SELECT "MARKET_ID", "LONGITUDE", "LATITUDE", "CITY_ID" FROM "MARKETS" LIMIT 100;
-- Q0015 [OK_PREP]
MERGE INTO "MARKETS" T
USING (SELECT ? AS MARKET_ID, ? AS POPULATION) S
ON (T."MARKET_ID" = S.MARKET_ID)
WHEN MATCHED THEN UPDATE SET T."POPULATION" = S.POPULATION
WHEN NOT MATCHED THEN INSERT ("MARKET_ID","POPULATION") VALUES (S.MARKET_ID, S.POPULATION);
-- Q0016 [OK]
SELECT S."SALES_ID", S."SALES_DATE", SP."ARTICLE_ID", SP."AMOUNT" FROM "SALES" S JOIN "SALES_POSITIONS" SP ON SP."SALES_ID" = S."SALES_ID" LIMIT 200;
-- Q0017 [OK_PREP]
SELECT * FROM "SALES" WHERE "SALES_DATE" BETWEEN ? AND ? LIMIT 200;
-- Q0018 [OK_PREP]
INSERT INTO "DIM_DATE" ("SALES_DATE") VALUES (?);
-- Q0019 [OK]
DELETE FROM "SALES_POSITIONS" WHERE "SALES_ID" = 8229694;
-- Q0020 [OK]
SELECT
  S."MARKET_ID",
  S."SALES_DATE",
  S."SALES_ID",
  S."PRICE",
  SUM(S."PRICE") OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE") AS DAY_MARKET_REVENUE,
  ROW_NUMBER() OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE" ORDER BY S."PRICE" DESC NULLS LAST) AS RN
FROM "SALES" S
WHERE S."SALES_DATE" IS NOT NULL
QUALIFY RN <= 50
ORDER BY DAY_MARKET_REVENUE DESC NULLS LAST;
-- Q0021 [OK]
INSERT INTO "MARKETS" ("MARKET_ID","POPULATION") VALUES (5857426, 3498945);
-- Q0022 [OK]
INSERT INTO "MARKETS" ("MARKET_ID","POPULATION") VALUES (5289947, 6514228);
-- Q0023 [OK]
SELECT M."MARKET_ID", C."COUNTRY_CODE", M."POPULATION" FROM "MARKETS" M LEFT JOIN "CITIES" C ON C."CITY_ID" = M."CITY_ID" LIMIT 200;
-- Q0024 [OK]
INSERT INTO "MARKETS" ("MARKET_ID","POPULATION") VALUES (6180820, 678659);
-- Q0025 [FAIL]
SELECT 1/0;
-- Q0026 [OK]
SELECT
  S."MARKET_ID",
  S."SALES_DATE",
  S."SALES_ID",
  S."PRICE",
  SUM(S."PRICE") OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE") AS DAY_MARKET_REVENUE,
  ROW_NUMBER() OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE" ORDER BY S."PRICE" DESC NULLS LAST) AS RN
FROM "SALES" S
WHERE S."SALES_DATE" IS NOT NULL
QUALIFY RN <= 50
ORDER BY DAY_MARKET_REVENUE DESC NULLS LAST;
-- Q0027 [OK]
SELECT S."SALES_ID", S."SALES_DATE", SP."ARTICLE_ID", SP."AMOUNT" FROM "SALES" S JOIN "SALES_POSITIONS" SP ON SP."SALES_ID" = S."SALES_ID" LIMIT 200;
-- Q0028 [FAIL]
UPDATE "MARKETS" SET "NOT_A_COL" = 1 WHERE "MARKET_ID" = 1;
-- Q0029 [OK]
UPDATE "MARKETS" SET "POPULATION" = 14236869 WHERE "MARKET_ID" = 3370632;
-- Q0030 [OK]
SELECT "TMP_OLD_NR" FROM "ARTICLE" WHERE "TMP_OLD_NR" IS NOT NULL LIMIT 100;
-- Q0031 [OK]
SELECT "QUANTITY_UNIT" FROM "ARTICLE" WHERE "QUANTITY_UNIT" IS NOT NULL LIMIT 100;
-- Q0032 [OK]
UPDATE "MARKETS" SET "POPULATION" = 5314551 WHERE "MARKET_ID" = 4766575;
-- Q0033 [OK_PREP]
SELECT COUNT(*) FROM "SALES" WHERE "MARKET_ID" = ?;
-- Q0034 [OK]
SELECT M."MARKET_ID", C."COUNTRY_CODE", M."POPULATION" FROM "MARKETS" M LEFT JOIN "CITIES" C ON C."CITY_ID" = M."CITY_ID" LIMIT 200;
-- Q0035 [OK]
INSERT INTO "DIM_DATE" ("SALES_DATE") VALUES (DATE '2022-09-22');
-- Q0036 [OK]
DELETE FROM "SALES_POSITIONS" WHERE "SALES_ID" = 8791080;
-- Q0037 [OK]
SELECT "PRICE", "CANCELED" FROM "SALES_POSITIONS" WHERE "PRICE" IS NOT NULL LIMIT 100;
-- Q0038 [OK]
MERGE INTO "MARKETS" T
USING (SELECT 412205 AS MARKET_ID, 6236952 AS POPULATION) S
ON (T."MARKET_ID" = S.MARKET_ID)
WHEN MATCHED THEN UPDATE SET T."POPULATION" = S.POPULATION
WHEN NOT MATCHED THEN INSERT ("MARKET_ID","POPULATION") VALUES (S.MARKET_ID, S.POPULATION);
-- Q0039 [OK]
SELECT "TERMINAL_DAILY_SALES_NR", "TERMINAL_ID", "SALES_ID" FROM "SALES" WHERE "TERMINAL_ID" IS NOT NULL LIMIT 100;
-- Q0040 [OK]
UPDATE "MARKETS" SET "POPULATION" = 13068710 WHERE "MARKET_ID" = 5007475;
-- Q0041 [OK]
SELECT
  S."MARKET_ID",
  S."SALES_DATE",
  S."SALES_ID",
  S."PRICE",
  SUM(S."PRICE") OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE") AS DAY_MARKET_REVENUE,
  ROW_NUMBER() OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE" ORDER BY S."PRICE" DESC NULLS LAST) AS RN
FROM "SALES" S
WHERE S."SALES_DATE" IS NOT NULL
QUALIFY RN <= 50
ORDER BY DAY_MARKET_REVENUE DESC NULLS LAST;
-- Q0042 [FAIL]
SELECT TO_DATE('not-a-date', 'YYYY-MM-DD');
-- Q0043 [FAIL]
DELETEE FROM "SALES";
-- Q0044 [OK]
SELECT SP."SALES_ID", A."PRODUCT_GROUP", SUM(SP."AMOUNT") AS UNITS FROM "SALES_POSITIONS" SP JOIN "ARTICLE" A ON A."ARTICLE_ID" = SP."ARTICLE_ID" GROUP BY SP."SALES_ID", A."PRODUCT_GROUP" ORDER BY UNITS DESC NULLS LAST LIMIT 200;
-- Q0045 [OK]
SELECT S."SALES_ID", S."SALES_DATE", SP."ARTICLE_ID", SP."AMOUNT" FROM "SALES" S JOIN "SALES_POSITIONS" SP ON SP."SALES_ID" = S."SALES_ID" LIMIT 200;
-- Q0046 [OK]
SELECT
  S."MARKET_ID",
  S."SALES_DATE",
  S."SALES_ID",
  S."PRICE",
  SUM(S."PRICE") OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE") AS DAY_MARKET_REVENUE,
  ROW_NUMBER() OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE" ORDER BY S."PRICE" DESC NULLS LAST) AS RN
FROM "SALES" S
WHERE S."SALES_DATE" IS NOT NULL
QUALIFY RN <= 50
ORDER BY DAY_MARKET_REVENUE DESC NULLS LAST;
-- Q0047 [OK]
SELECT "CITY_NAME", "COUNTRY_CODE", "LON" FROM "CITIES" WHERE "CITY_NAME" IS NOT NULL LIMIT 100;
-- Q0048 [OK]
INSERT INTO "DIM_DATE" ("SALES_DATE") VALUES (DATE '2015-12-26');
-- Q0049 [OK]
SELECT
  S."MARKET_ID",
  S."SALES_DATE",
  S."SALES_ID",
  S."PRICE",
  SUM(S."PRICE") OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE") AS DAY_MARKET_REVENUE,
  ROW_NUMBER() OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE" ORDER BY S."PRICE" DESC NULLS LAST) AS RN
FROM "SALES" S
WHERE S."SALES_DATE" IS NOT NULL
QUALIFY RN <= 50
ORDER BY DAY_MARKET_REVENUE DESC NULLS LAST;
-- Q0050 [OK]
DELETE FROM "SALES_POSITIONS" WHERE "SALES_ID" = 9867314;
-- Q0051 [OK]
INSERT INTO "DIM_DATE" ("SALES_DATE") VALUES (DATE '2020-03-07');
-- Q0052 [OK]
INSERT INTO "DIM_DATE" ("SALES_DATE") VALUES (DATE '2010-11-24');
-- Q0053 [OK]
MERGE INTO "MARKETS" T
USING (SELECT 242457 AS MARKET_ID, 3270200 AS POPULATION) S
ON (T."MARKET_ID" = S.MARKET_ID)
WHEN MATCHED THEN UPDATE SET T."POPULATION" = S.POPULATION
WHEN NOT MATCHED THEN INSERT ("MARKET_ID","POPULATION") VALUES (S.MARKET_ID, S.POPULATION);
-- Q0054 [OK]
SELECT S."SALES_ID", S."SALES_DATE", SP."ARTICLE_ID", SP."AMOUNT" FROM "SALES" S JOIN "SALES_POSITIONS" SP ON SP."SALES_ID" = S."SALES_ID" LIMIT 200;
-- Q0055 [OK]
SELECT S."SALES_ID", S."SALES_DATE", SP."ARTICLE_ID", SP."AMOUNT" FROM "SALES" S JOIN "SALES_POSITIONS" SP ON SP."SALES_ID" = S."SALES_ID" LIMIT 200;
-- Q0056 [OK]
INSERT INTO "MARKETS" ("MARKET_ID","POPULATION") VALUES (9510136, 3954646);
-- Q0057 [OK]
INSERT INTO "DIM_DATE" ("SALES_DATE") VALUES (DATE '2013-04-16');
-- Q0058 [OK_PREP]
INSERT INTO "MARKETS" ("MARKET_ID","POPULATION") VALUES (?, ?);
-- Q0059 [OK]
MERGE INTO "MARKETS" T
USING (SELECT 6770384 AS MARKET_ID, 9432024 AS POPULATION) S
ON (T."MARKET_ID" = S.MARKET_ID)
WHEN MATCHED THEN UPDATE SET T."POPULATION" = S.POPULATION
WHEN NOT MATCHED THEN INSERT ("MARKET_ID","POPULATION") VALUES (S.MARKET_ID, S.POPULATION);
-- Q0060 [OK]
INSERT INTO "DIM_DATE" ("SALES_DATE") VALUES (DATE '2025-08-28');
-- Q0061 [OK]
SELECT M."MARKET_ID", C."COUNTRY_CODE", M."POPULATION" FROM "MARKETS" M LEFT JOIN "CITIES" C ON C."CITY_ID" = M."CITY_ID" LIMIT 200;
-- Q0062 [OK]
SELECT "POSITION_ID", "AMOUNT", "VOUCHER_ID" FROM "SALES_POSITIONS" LIMIT 100;
-- Q0063 [OK]
SELECT SP."SALES_ID", A."PRODUCT_GROUP", SUM(SP."AMOUNT") AS UNITS FROM "SALES_POSITIONS" SP JOIN "ARTICLE" A ON A."ARTICLE_ID" = SP."ARTICLE_ID" GROUP BY SP."SALES_ID", A."PRODUCT_GROUP" ORDER BY UNITS DESC NULLS LAST LIMIT 200;
-- Q0064 [OK]
INSERT INTO "DIM_DATE" ("SALES_DATE") VALUES (DATE '2019-05-14');
-- Q0065 [OK]
SELECT S."SALES_ID", S."SALES_DATE", SP."ARTICLE_ID", SP."AMOUNT" FROM "SALES" S JOIN "SALES_POSITIONS" SP ON SP."SALES_ID" = S."SALES_ID" LIMIT 200;
-- Q0066 [OK]
INSERT INTO "DIM_DATE" ("SALES_DATE") VALUES (DATE '2024-07-09');
-- Q0067 [OK]
SELECT
  S."MARKET_ID",
  S."SALES_DATE",
  S."SALES_ID",
  S."PRICE",
  SUM(S."PRICE") OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE") AS DAY_MARKET_REVENUE,
  ROW_NUMBER() OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE" ORDER BY S."PRICE" DESC NULLS LAST) AS RN
FROM "SALES" S
WHERE S."SALES_DATE" IS NOT NULL
QUALIFY RN <= 50
ORDER BY DAY_MARKET_REVENUE DESC NULLS LAST;
-- Q0068 [OK]
SELECT "SALES_ID", "AMOUNT", "ARTICLE_ID" FROM "SALES_POSITIONS" LIMIT 100;
-- Q0069 [OK]
INSERT INTO "MARKETS" ("MARKET_ID","POPULATION") VALUES (471842, 6672289);
-- Q0070 [OK_PREP]
INSERT INTO "MARKETS" ("MARKET_ID","POPULATION") VALUES (?, ?);
-- Q0071 [OK_PREP]
INSERT INTO "DIM_DATE" ("SALES_DATE") VALUES (?);
-- Q0072 [OK]
INSERT INTO "MARKETS" ("MARKET_ID","POPULATION") VALUES (3866249, 1548215);
-- Q0073 [OK]
INSERT INTO "DIM_DATE" ("SALES_DATE") VALUES (DATE '2013-09-01');
-- Q0074 [OK]
SELECT "PRODUCT_GROUP", "BASE_SALES_PRICE" FROM "ARTICLE" WHERE "BASE_SALES_PRICE" IS NOT NULL LIMIT 100;
-- Q0075 [OK_PREP]
SELECT * FROM "MARKETS" WHERE "CITY_ID" = ? LIMIT 50;
-- Q0076 [OK]
DELETE FROM "SALES_POSITIONS" WHERE "SALES_ID" = 6598845;
-- Q0077 [OK_PREP]
MERGE INTO "MARKETS" T
USING (SELECT ? AS MARKET_ID, ? AS POPULATION) S
ON (T."MARKET_ID" = S.MARKET_ID)
WHEN MATCHED THEN UPDATE SET T."POPULATION" = S.POPULATION
WHEN NOT MATCHED THEN INSERT ("MARKET_ID","POPULATION") VALUES (S.MARKET_ID, S.POPULATION);
-- Q0078 [OK]
DELETE FROM "SALES_POSITIONS" WHERE "SALES_ID" = 7384637;
-- Q0079 [OK]
INSERT INTO "MARKETS" ("MARKET_ID","POPULATION") VALUES (8423397, 4739055);
-- Q0080 [FAIL]
INSERT INTO "DIM_DATE" ("SALES_DATE") VALUES (DATE '2020-01-01';
-- Q0081 [OK]
MERGE INTO "MARKETS" T
USING (SELECT 2661919 AS MARKET_ID, 7079953 AS POPULATION) S
ON (T."MARKET_ID" = S.MARKET_ID)
WHEN MATCHED THEN UPDATE SET T."POPULATION" = S.POPULATION
WHEN NOT MATCHED THEN INSERT ("MARKET_ID","POPULATION") VALUES (S.MARKET_ID, S.POPULATION);
-- Q0082 [OK]
SELECT "SALES_DATE" FROM "DIM_DATE" WHERE "SALES_DATE" IS NOT NULL;
-- Q0083 [OK]
DELETE FROM "SALES_POSITIONS" WHERE "SALES_ID" = 7999490;
-- Q0084 [OK]
SELECT SP."SALES_ID", A."PRODUCT_GROUP", SUM(SP."AMOUNT") AS UNITS FROM "SALES_POSITIONS" SP JOIN "ARTICLE" A ON A."ARTICLE_ID" = SP."ARTICLE_ID" GROUP BY SP."SALES_ID", A."PRODUCT_GROUP" ORDER BY UNITS DESC NULLS LAST LIMIT 200;
-- Q0085 [OK]
SELECT M."MARKET_ID", C."COUNTRY_CODE", M."POPULATION" FROM "MARKETS" M LEFT JOIN "CITIES" C ON C."CITY_ID" = M."CITY_ID" LIMIT 200;
-- Q0086 [OK]
DELETE FROM "SALES_POSITIONS" WHERE "SALES_ID" = 3856674;
-- Q0087 [OK]
SELECT "TERMINAL_DAILY_SALES_NR", "SALES_ID" FROM "SALES" WHERE "SALES_ID" IS NOT NULL;
-- Q0088 [OK]
DELETE FROM "SALES_POSITIONS" WHERE "SALES_ID" = 2691065;
-- Q0089 [OK_PREP]
INSERT INTO "MARKETS" ("MARKET_ID","POPULATION") VALUES (?, ?);
-- Q0090 [OK_PREP]
INSERT INTO "MARKETS" ("MARKET_ID","POPULATION") VALUES (?, ?);
-- Q0091 [OK]
UPDATE "MARKETS" SET "POPULATION" = 14425288 WHERE "MARKET_ID" = 657844;
-- Q0092 [OK]
UPDATE "MARKETS" SET "POPULATION" = 8230353 WHERE "MARKET_ID" = 7680619;
-- Q0093 [OK]
SELECT "POPULATION", "LONGITUDE", "CITY", "LATITUDE" FROM "MARKETS";
-- Q0094 [FAIL]
UPDATE "MARKETS" SET "NOT_A_COL" = 1 WHERE "MARKET_ID" = 1;
-- Q0095 [OK]
MERGE INTO "MARKETS" T
USING (SELECT 7573637 AS MARKET_ID, 187008 AS POPULATION) S
ON (T."MARKET_ID" = S.MARKET_ID)
WHEN MATCHED THEN UPDATE SET T."POPULATION" = S.POPULATION
WHEN NOT MATCHED THEN INSERT ("MARKET_ID","POPULATION") VALUES (S.MARKET_ID, S.POPULATION);
-- Q0096 [OK]
MERGE INTO "MARKETS" T
USING (SELECT 6167269 AS MARKET_ID, 3871474 AS POPULATION) S
ON (T."MARKET_ID" = S.MARKET_ID)
WHEN MATCHED THEN UPDATE SET T."POPULATION" = S.POPULATION
WHEN NOT MATCHED THEN INSERT ("MARKET_ID","POPULATION") VALUES (S.MARKET_ID, S.POPULATION);
-- Q0097 [OK]
DELETE FROM "SALES_POSITIONS" WHERE "SALES_ID" = 7915440;
-- Q0098 [OK]
INSERT INTO "DIM_DATE" ("SALES_DATE") VALUES (DATE '2024-09-11');
-- Q0099 [OK]
MERGE INTO "MARKETS" T
USING (SELECT 4957374 AS MARKET_ID, 9985324 AS POPULATION) S
ON (T."MARKET_ID" = S.MARKET_ID)
WHEN MATCHED THEN UPDATE SET T."POPULATION" = S.POPULATION
WHEN NOT MATCHED THEN INSERT ("MARKET_ID","POPULATION") VALUES (S.MARKET_ID, S.POPULATION);
-- Q0100 [OK]
INSERT INTO "DIM_DATE" ("SALES_DATE") VALUES (DATE '2018-06-04');
-- Q0101 [OK]
SELECT
  S."MARKET_ID",
  S."SALES_DATE",
  S."SALES_ID",
  S."PRICE",
  SUM(S."PRICE") OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE") AS DAY_MARKET_REVENUE,
  ROW_NUMBER() OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE" ORDER BY S."PRICE" DESC NULLS LAST) AS RN
FROM "SALES" S
WHERE S."SALES_DATE" IS NOT NULL
QUALIFY RN <= 50
ORDER BY DAY_MARKET_REVENUE DESC NULLS LAST;
-- Q0102 [FAIL]
SELECT * FROM "SALESX" LIMIT 10;
-- Q0103 [OK_PREP]
MERGE INTO "MARKETS" T
USING (SELECT ? AS MARKET_ID, ? AS POPULATION) S
ON (T."MARKET_ID" = S.MARKET_ID)
WHEN MATCHED THEN UPDATE SET T."POPULATION" = S.POPULATION
WHEN NOT MATCHED THEN INSERT ("MARKET_ID","POPULATION") VALUES (S.MARKET_ID, S.POPULATION);
-- Q0104 [OK]
SELECT SP."SALES_ID", A."PRODUCT_GROUP", SUM(SP."AMOUNT") AS UNITS FROM "SALES_POSITIONS" SP JOIN "ARTICLE" A ON A."ARTICLE_ID" = SP."ARTICLE_ID" GROUP BY SP."SALES_ID", A."PRODUCT_GROUP" ORDER BY UNITS DESC NULLS LAST LIMIT 200;
-- Q0105 [OK]
SELECT
  S."MARKET_ID",
  S."SALES_DATE",
  S."SALES_ID",
  S."PRICE",
  SUM(S."PRICE") OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE") AS DAY_MARKET_REVENUE,
  ROW_NUMBER() OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE" ORDER BY S."PRICE" DESC NULLS LAST) AS RN
FROM "SALES" S
WHERE S."SALES_DATE" IS NOT NULL
QUALIFY RN <= 50
ORDER BY DAY_MARKET_REVENUE DESC NULLS LAST;
-- Q0106 [OK]
UPDATE "MARKETS" SET "POPULATION" = 2152583 WHERE "MARKET_ID" = 3362289;
-- Q0107 [OK]
INSERT INTO "DIM_DATE" ("SALES_DATE") VALUES (DATE '2005-02-11');
-- Q0108 [OK]
INSERT INTO "MARKETS" ("MARKET_ID","POPULATION") VALUES (9859342, 4177549);
-- Q0109 [FAIL]
INSERT INTO "MARKETS" ("MARKET_ID","NOPE") VALUES (1,2);
-- Q0110 [OK_PREP]
INSERT INTO "MARKETS" ("MARKET_ID","POPULATION") VALUES (?, ?);
-- Q0111 [OK]
UPDATE "MARKETS" SET "POPULATION" = 13143347 WHERE "MARKET_ID" = 359435;
-- Q0112 [OK]
SELECT M."MARKET_ID", C."COUNTRY_CODE", M."POPULATION" FROM "MARKETS" M LEFT JOIN "CITIES" C ON C."CITY_ID" = M."CITY_ID" LIMIT 200;
-- Q0113 [OK]
MERGE INTO "MARKETS" T
USING (SELECT 7386266 AS MARKET_ID, 5293643 AS POPULATION) S
ON (T."MARKET_ID" = S.MARKET_ID)
WHEN MATCHED THEN UPDATE SET T."POPULATION" = S.POPULATION
WHEN NOT MATCHED THEN INSERT ("MARKET_ID","POPULATION") VALUES (S.MARKET_ID, S.POPULATION);
-- Q0114 [OK]
INSERT INTO "DIM_DATE" ("SALES_DATE") VALUES (DATE '2013-02-06');
-- Q0115 [OK]
INSERT INTO "MARKETS" ("MARKET_ID","POPULATION") VALUES (1020603, 8395056);
-- Q0116 [OK]
SELECT
  S."MARKET_ID",
  S."SALES_DATE",
  S."SALES_ID",
  S."PRICE",
  SUM(S."PRICE") OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE") AS DAY_MARKET_REVENUE,
  ROW_NUMBER() OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE" ORDER BY S."PRICE" DESC NULLS LAST) AS RN
FROM "SALES" S
WHERE S."SALES_DATE" IS NOT NULL
QUALIFY RN <= 50
ORDER BY DAY_MARKET_REVENUE DESC NULLS LAST;
-- Q0117 [OK]
SELECT
  S."MARKET_ID",
  S."SALES_DATE",
  S."SALES_ID",
  S."PRICE",
  SUM(S."PRICE") OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE") AS DAY_MARKET_REVENUE,
  ROW_NUMBER() OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE" ORDER BY S."PRICE" DESC NULLS LAST) AS RN
FROM "SALES" S
WHERE S."SALES_DATE" IS NOT NULL
QUALIFY RN <= 50
ORDER BY DAY_MARKET_REVENUE DESC NULLS LAST;
-- Q0118 [OK]
INSERT INTO "DIM_DATE" ("SALES_DATE") VALUES (DATE '2013-04-28');
-- Q0119 [OK]
INSERT INTO "MARKETS" ("MARKET_ID","POPULATION") VALUES (6013785, 791248);
-- Q0120 [OK]
SELECT M."MARKET_ID", C."COUNTRY_CODE", M."POPULATION" FROM "MARKETS" M LEFT JOIN "CITIES" C ON C."CITY_ID" = M."CITY_ID" LIMIT 200;
-- Q0121 [OK]
SELECT
  S."MARKET_ID",
  S."SALES_DATE",
  S."SALES_ID",
  S."PRICE",
  SUM(S."PRICE") OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE") AS DAY_MARKET_REVENUE,
  ROW_NUMBER() OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE" ORDER BY S."PRICE" DESC NULLS LAST) AS RN
FROM "SALES" S
WHERE S."SALES_DATE" IS NOT NULL
QUALIFY RN <= 50
ORDER BY DAY_MARKET_REVENUE DESC NULLS LAST;
-- Q0122 [OK]
INSERT INTO "DIM_DATE" ("SALES_DATE") VALUES (DATE '2006-03-01');
-- Q0123 [FAIL]
SELECT FROM "SALES";
-- Q0124 [OK]
DELETE FROM "SALES_POSITIONS" WHERE "SALES_ID" = 7119821;
-- Q0125 [OK]
DELETE FROM "SALES_POSITIONS" WHERE "SALES_ID" = 413586;
-- Q0126 [OK]
SELECT
  S."MARKET_ID",
  S."SALES_DATE",
  S."SALES_ID",
  S."PRICE",
  SUM(S."PRICE") OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE") AS DAY_MARKET_REVENUE,
  ROW_NUMBER() OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE" ORDER BY S."PRICE" DESC NULLS LAST) AS RN
FROM "SALES" S
WHERE S."SALES_DATE" IS NOT NULL
QUALIFY RN <= 50
ORDER BY DAY_MARKET_REVENUE DESC NULLS LAST;
-- Q0127 [OK]
SELECT
  S."MARKET_ID",
  S."SALES_DATE",
  S."SALES_ID",
  S."PRICE",
  SUM(S."PRICE") OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE") AS DAY_MARKET_REVENUE,
  ROW_NUMBER() OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE" ORDER BY S."PRICE" DESC NULLS LAST) AS RN
FROM "SALES" S
WHERE S."SALES_DATE" IS NOT NULL
QUALIFY RN <= 50
ORDER BY DAY_MARKET_REVENUE DESC NULLS LAST;
-- Q0128 [FAIL]
DELETE FROM "UNKNOWN_TABLE" WHERE 1=1;
-- Q0129 [OK]
SELECT SP."SALES_ID", A."PRODUCT_GROUP", SUM(SP."AMOUNT") AS UNITS FROM "SALES_POSITIONS" SP JOIN "ARTICLE" A ON A."ARTICLE_ID" = SP."ARTICLE_ID" GROUP BY SP."SALES_ID", A."PRODUCT_GROUP" ORDER BY UNITS DESC NULLS LAST LIMIT 200;
-- Q0130 [OK]
SELECT M."MARKET_ID", C."COUNTRY_CODE", M."POPULATION" FROM "MARKETS" M LEFT JOIN "CITIES" C ON C."CITY_ID" = M."CITY_ID" LIMIT 200;
-- Q0131 [OK]
SELECT
  S."MARKET_ID",
  S."SALES_DATE",
  S."SALES_ID",
  S."PRICE",
  SUM(S."PRICE") OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE") AS DAY_MARKET_REVENUE,
  ROW_NUMBER() OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE" ORDER BY S."PRICE" DESC NULLS LAST) AS RN
FROM "SALES" S
WHERE S."SALES_DATE" IS NOT NULL
QUALIFY RN <= 50
ORDER BY DAY_MARKET_REVENUE DESC NULLS LAST;
-- Q0132 [OK]
SELECT "ZIP_CODE", "AREA", "LON" FROM "CITIES" LIMIT 100;
-- Q0133 [FAIL]
insert into article (article_id) select A from (select ? as A);
-- Q0134 [OK]
SELECT SP."SALES_ID", A."PRODUCT_GROUP", SUM(SP."AMOUNT") AS UNITS FROM "SALES_POSITIONS" SP JOIN "ARTICLE" A ON A."ARTICLE_ID" = SP."ARTICLE_ID" GROUP BY SP."SALES_ID", A."PRODUCT_GROUP" ORDER BY UNITS DESC NULLS LAST LIMIT 200;
-- Q0135 [OK]
SELECT
  S."MARKET_ID",
  S."SALES_DATE",
  S."SALES_ID",
  S."PRICE",
  SUM(S."PRICE") OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE") AS DAY_MARKET_REVENUE,
  ROW_NUMBER() OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE" ORDER BY S."PRICE" DESC NULLS LAST) AS RN
FROM "SALES" S
WHERE S."SALES_DATE" IS NOT NULL
QUALIFY RN <= 50
ORDER BY DAY_MARKET_REVENUE DESC NULLS LAST;
-- Q0136 [OK]
INSERT INTO "MARKETS" ("MARKET_ID","POPULATION") VALUES (7927578, 9264302);
-- Q0137 [OK_PREP]
INSERT INTO "DIM_DATE" ("SALES_DATE") VALUES (?);
-- Q0138 [OK_PREP]
DELETE FROM "SALES_POSITIONS" WHERE "SALES_ID" = ?;
-- Q0139 [OK_PREP]
MERGE INTO "MARKETS" T
USING (SELECT ? AS MARKET_ID, ? AS POPULATION) S
ON (T."MARKET_ID" = S.MARKET_ID)
WHEN MATCHED THEN UPDATE SET T."POPULATION" = S.POPULATION
WHEN NOT MATCHED THEN INSERT ("MARKET_ID","POPULATION") VALUES (S.MARKET_ID, S.POPULATION);
-- Q0140 [OK]
SELECT
  S."MARKET_ID",
  S."SALES_DATE",
  S."SALES_ID",
  S."PRICE",
  SUM(S."PRICE") OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE") AS DAY_MARKET_REVENUE,
  ROW_NUMBER() OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE" ORDER BY S."PRICE" DESC NULLS LAST) AS RN
FROM "SALES" S
WHERE S."SALES_DATE" IS NOT NULL
QUALIFY RN <= 50
ORDER BY DAY_MARKET_REVENUE DESC NULLS LAST;
-- Q0141 [OK]
DELETE FROM "SALES_POSITIONS" WHERE "SALES_ID" = 412876;
-- Q0142 [OK]
MERGE INTO "MARKETS" T
USING (SELECT 2461601 AS MARKET_ID, 4297934 AS POPULATION) S
ON (T."MARKET_ID" = S.MARKET_ID)
WHEN MATCHED THEN UPDATE SET T."POPULATION" = S.POPULATION
WHEN NOT MATCHED THEN INSERT ("MARKET_ID","POPULATION") VALUES (S.MARKET_ID, S.POPULATION);
-- Q0143 [OK]
SELECT
  S."MARKET_ID",
  S."SALES_DATE",
  S."SALES_ID",
  S."PRICE",
  SUM(S."PRICE") OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE") AS DAY_MARKET_REVENUE,
  ROW_NUMBER() OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE" ORDER BY S."PRICE" DESC NULLS LAST) AS RN
FROM "SALES" S
WHERE S."SALES_DATE" IS NOT NULL
QUALIFY RN <= 50
ORDER BY DAY_MARKET_REVENUE DESC NULLS LAST;
-- Q0144 [OK]
SELECT
  S."MARKET_ID",
  S."SALES_DATE",
  S."SALES_ID",
  S."PRICE",
  SUM(S."PRICE") OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE") AS DAY_MARKET_REVENUE,
  ROW_NUMBER() OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE" ORDER BY S."PRICE" DESC NULLS LAST) AS RN
FROM "SALES" S
WHERE S."SALES_DATE" IS NOT NULL
QUALIFY RN <= 50
ORDER BY DAY_MARKET_REVENUE DESC NULLS LAST;
-- Q0145 [OK]
INSERT INTO "MARKETS" ("MARKET_ID","POPULATION") VALUES (4289336, 4862250);
-- Q0146 [OK]
SELECT "VOUCHER_ID", "AMOUNT", "PRICE" FROM "SALES_POSITIONS" WHERE "VOUCHER_ID" IS NOT NULL;
-- Q0147 [OK]
SELECT M."MARKET_ID", C."COUNTRY_CODE", M."POPULATION" FROM "MARKETS" M LEFT JOIN "CITIES" C ON C."CITY_ID" = M."CITY_ID" LIMIT 200;
-- Q0148 [OK]
SELECT
  S."MARKET_ID",
  S."SALES_DATE",
  S."SALES_ID",
  S."PRICE",
  SUM(S."PRICE") OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE") AS DAY_MARKET_REVENUE,
  ROW_NUMBER() OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE" ORDER BY S."PRICE" DESC NULLS LAST) AS RN
FROM "SALES" S
WHERE S."SALES_DATE" IS NOT NULL
QUALIFY RN <= 50
ORDER BY DAY_MARKET_REVENUE DESC NULLS LAST;
-- Q0149 [OK]
MERGE INTO "MARKETS" T
USING (SELECT 8419006 AS MARKET_ID, 3099180 AS POPULATION) S
ON (T."MARKET_ID" = S.MARKET_ID)
WHEN MATCHED THEN UPDATE SET T."POPULATION" = S.POPULATION
WHEN NOT MATCHED THEN INSERT ("MARKET_ID","POPULATION") VALUES (S.MARKET_ID, S.POPULATION);
-- Q0150 [OK]
SELECT M."MARKET_ID", C."COUNTRY_CODE", M."POPULATION" FROM "MARKETS" M LEFT JOIN "CITIES" C ON C."CITY_ID" = M."CITY_ID" LIMIT 200;
-- Q0151 [OK]
SELECT S."SALES_ID", S."SALES_DATE", SP."ARTICLE_ID", SP."AMOUNT" FROM "SALES" S JOIN "SALES_POSITIONS" SP ON SP."SALES_ID" = S."SALES_ID" LIMIT 200;
-- Q0152 [FAIL]
SELECT 1/0;
-- Q0153 [OK]
SELECT "LOYALTY_ID" FROM "SALES" WHERE "LOYALTY_ID" IS NOT NULL LIMIT 100;
-- Q0154 [OK]
INSERT INTO "DIM_DATE" ("SALES_DATE") VALUES (DATE '2010-11-04');
-- Q0155 [OK]
DELETE FROM "SALES_POSITIONS" WHERE "SALES_ID" = 2471143;
-- Q0156 [OK]
INSERT INTO "MARKETS" ("MARKET_ID","POPULATION") VALUES (4092342, 2008753);
-- Q0157 [OK]
UPDATE "MARKETS" SET "POPULATION" = 13291143 WHERE "MARKET_ID" = 9365307;
-- Q0158 [OK]
INSERT INTO "MARKETS" ("MARKET_ID","POPULATION") VALUES (3581883, 6266967);
-- Q0159 [OK]
DELETE FROM "SALES_POSITIONS" WHERE "SALES_ID" = 5196552;
-- Q0160 [OK]
SELECT "POPULATION", "POSTAL_CODE", "CITY_ID", "MARKET_ID" FROM "MARKETS" WHERE "POSTAL_CODE" IS NOT NULL LIMIT 100;
-- Q0161 [OK]
UPDATE "MARKETS" SET "POPULATION" = 5859963 WHERE "MARKET_ID" = 8509952;
-- Q0162 [OK]
INSERT INTO "DIM_DATE" ("SALES_DATE") VALUES (DATE '2012-02-26');
-- Q0163 [OK]
INSERT INTO "DIM_DATE" ("SALES_DATE") VALUES (DATE '2010-03-06');
-- Q0164 [OK]
SELECT "CITY_ID", "LON" FROM "CITIES" WHERE "LON" IS NOT NULL;
-- Q0165 [OK]
SELECT "RETURNED_CHANGE", "SALES_DATE" FROM "SALES" WHERE "SALES_DATE" IS NOT NULL LIMIT 100;
-- Q0166 [FAIL]
SELECT 1/0;
-- Q0167 [OK_PREP]
SELECT * FROM "CITIES" WHERE "COUNTRY_CODE" = ? LIMIT 100;
-- Q0168 [FAIL]
DELETE FROM "UNKNOWN_TABLE" WHERE 1=1;
-- Q0169 [FAIL]
SELECT M."MARKET_ID" FROM "MARKETS" M WHERE M."CITY_NAME" IS NOT NULL;
-- Q0170 [OK]
SELECT
  S."MARKET_ID",
  S."SALES_DATE",
  S."SALES_ID",
  S."PRICE",
  SUM(S."PRICE") OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE") AS DAY_MARKET_REVENUE,
  ROW_NUMBER() OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE" ORDER BY S."PRICE" DESC NULLS LAST) AS RN
FROM "SALES" S
WHERE S."SALES_DATE" IS NOT NULL
QUALIFY RN <= 50
ORDER BY DAY_MARKET_REVENUE DESC NULLS LAST;
-- Q0171 [FAIL]
SELECT 1/0;
-- Q0172 [OK]
DELETE FROM "SALES_POSITIONS" WHERE "SALES_ID" = 2418434;
-- Q0173 [OK_PREP]
UPDATE "MARKETS" SET "POPULATION" = ? WHERE "MARKET_ID" = ?;
-- Q0174 [OK]
UPDATE "MARKETS" SET "POPULATION" = 7557788 WHERE "MARKET_ID" = 6546285;
-- Q0175 [OK]
SELECT "SALES_DATE", "MARKET_ID", "RETURNED_CHANGE" FROM "SALES" WHERE "MARKET_ID" IS NOT NULL LIMIT 100;
-- Q0176 [OK]
INSERT INTO "DIM_DATE" ("SALES_DATE") VALUES (DATE '2005-02-13');
-- Q0177 [OK]
UPDATE "MARKETS" SET "POPULATION" = 18716855 WHERE "MARKET_ID" = 8295703;
-- Q0178 [OK]
SELECT
  S."MARKET_ID",
  S."SALES_DATE",
  S."SALES_ID",
  S."PRICE",
  SUM(S."PRICE") OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE") AS DAY_MARKET_REVENUE,
  ROW_NUMBER() OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE" ORDER BY S."PRICE" DESC NULLS LAST) AS RN
FROM "SALES" S
WHERE S."SALES_DATE" IS NOT NULL
QUALIFY RN <= 50
ORDER BY DAY_MARKET_REVENUE DESC NULLS LAST;
-- Q0179 [FAIL]
INSERT INTO "NO_SUCH_TABLE" ("A") VALUES (1);
-- Q0180 [OK]
DELETE FROM "SALES_POSITIONS" WHERE "SALES_ID" = 412443;
-- Q0181 [OK_PREP]
INSERT INTO "DIM_DATE" ("SALES_DATE") VALUES (?);
-- Q0182 [OK]
SELECT S."SALES_ID", S."SALES_DATE", SP."ARTICLE_ID", SP."AMOUNT" FROM "SALES" S JOIN "SALES_POSITIONS" SP ON SP."SALES_ID" = S."SALES_ID" LIMIT 200;
-- Q0183 [OK]
DELETE FROM "SALES_POSITIONS" WHERE "SALES_ID" = 3918069;
-- Q0184 [FAIL]
SELECT FROM "SALES";
-- Q0185 [OK]
DELETE FROM "SALES_POSITIONS" WHERE "SALES_ID" = 215129;
-- Q0186 [OK]
INSERT INTO "DIM_DATE" ("SALES_DATE") VALUES (DATE '2023-08-14');
-- Q0187 [FAIL]
SELECT M."MARKET_ID" FROM "MARKETS" M WHERE M."CITY_NAME" IS NOT NULL;
-- Q0188 [OK]
DELETE FROM "SALES_POSITIONS" WHERE "SALES_ID" = 4575634;
-- Q0189 [OK_PREP]
UPDATE "MARKETS" SET "POPULATION" = ? WHERE "MARKET_ID" = ?;
-- Q0190 [OK_PREP]
SELECT * FROM "MARKETS" WHERE "CITY_ID" = ? LIMIT 50;
-- Q0191 [FAIL]
UPDATE "MARKETS" SET WHERE "MARKET_ID" = 1;
-- Q0192 [FAIL]
SELECT 1/0;
-- Q0193 [OK_PREP]
INSERT INTO "MARKETS" ("MARKET_ID","POPULATION") VALUES (?, ?);
-- Q0194 [OK]
SELECT "TERMINAL_ID" FROM "SALES" WHERE "TERMINAL_ID" IS NOT NULL;
-- Q0195 [FAIL]
SELECT FROM "SALES";
-- Q0196 [OK]
SELECT
  S."MARKET_ID",
  S."SALES_DATE",
  S."SALES_ID",
  S."PRICE",
  SUM(S."PRICE") OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE") AS DAY_MARKET_REVENUE,
  ROW_NUMBER() OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE" ORDER BY S."PRICE" DESC NULLS LAST) AS RN
FROM "SALES" S
WHERE S."SALES_DATE" IS NOT NULL
QUALIFY RN <= 50
ORDER BY DAY_MARKET_REVENUE DESC NULLS LAST;
-- Q0197 [OK]
MERGE INTO "MARKETS" T
USING (SELECT 9510198 AS MARKET_ID, 7354460 AS POPULATION) S
ON (T."MARKET_ID" = S.MARKET_ID)
WHEN MATCHED THEN UPDATE SET T."POPULATION" = S.POPULATION
WHEN NOT MATCHED THEN INSERT ("MARKET_ID","POPULATION") VALUES (S.MARKET_ID, S.POPULATION);
-- Q0198 [OK]
SELECT "AREA", "CITY_ID", "LATITUDE", "POSTAL_CODE" FROM "MARKETS" LIMIT 100;
-- Q0199 [FAIL]
SELECT M."MARKET_ID" FROM "MARKETS" M WHERE M."CITY_NAME" IS NOT NULL;
-- Q0200 [OK]
SELECT S."SALES_ID", S."SALES_DATE", SP."ARTICLE_ID", SP."AMOUNT" FROM "SALES" S JOIN "SALES_POSITIONS" SP ON SP."SALES_ID" = S."SALES_ID" LIMIT 200;
-- Q0201 [OK]
INSERT INTO "DIM_DATE" ("SALES_DATE") VALUES (DATE '2020-08-24');
-- Q0202 [OK]
SELECT SP."SALES_ID", A."PRODUCT_GROUP", SUM(SP."AMOUNT") AS UNITS FROM "SALES_POSITIONS" SP JOIN "ARTICLE" A ON A."ARTICLE_ID" = SP."ARTICLE_ID" GROUP BY SP."SALES_ID", A."PRODUCT_GROUP" ORDER BY UNITS DESC NULLS LAST LIMIT 200;
-- Q0203 [OK]
INSERT INTO "MARKETS" ("MARKET_ID","POPULATION") VALUES (9123994, 5371518);
-- Q0204 [OK]
MERGE INTO "MARKETS" T
USING (SELECT 5813051 AS MARKET_ID, 9248770 AS POPULATION) S
ON (T."MARKET_ID" = S.MARKET_ID)
WHEN MATCHED THEN UPDATE SET T."POPULATION" = S.POPULATION
WHEN NOT MATCHED THEN INSERT ("MARKET_ID","POPULATION") VALUES (S.MARKET_ID, S.POPULATION);
-- Q0205 [OK]
INSERT INTO "MARKETS" ("MARKET_ID","POPULATION") VALUES (8918642, 5923779);
-- Q0206 [OK]
SELECT
  S."MARKET_ID",
  S."SALES_DATE",
  S."SALES_ID",
  S."PRICE",
  SUM(S."PRICE") OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE") AS DAY_MARKET_REVENUE,
  ROW_NUMBER() OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE" ORDER BY S."PRICE" DESC NULLS LAST) AS RN
FROM "SALES" S
WHERE S."SALES_DATE" IS NOT NULL
QUALIFY RN <= 50
ORDER BY DAY_MARKET_REVENUE DESC NULLS LAST;
-- Q0207 [OK_PREP]
INSERT INTO "MARKETS" ("MARKET_ID","POPULATION") VALUES (?, ?);
-- Q0208 [OK]
SELECT S."SALES_ID", S."SALES_DATE", SP."ARTICLE_ID", SP."AMOUNT" FROM "SALES" S JOIN "SALES_POSITIONS" SP ON SP."SALES_ID" = S."SALES_ID" LIMIT 200;
-- Q0209 [OK_PREP]
UPDATE "MARKETS" SET "POPULATION" = ? WHERE "MARKET_ID" = ?;
-- Q0210 [OK_PREP]
UPDATE "MARKETS" SET "POPULATION" = ? WHERE "MARKET_ID" = ?;
-- Q0211 [FAIL]
SELECT CAST('abc' AS DECIMAL(18,0));
-- Q0212 [OK]
INSERT INTO "DIM_DATE" ("SALES_DATE") VALUES (DATE '2018-04-22');
-- Q0213 [OK]
INSERT INTO "DIM_DATE" ("SALES_DATE") VALUES (DATE '2016-08-11');
-- Q0214 [OK_PREP]
UPDATE "MARKETS" SET "POPULATION" = ? WHERE "MARKET_ID" = ?;
-- Q0215 [OK]
DELETE FROM "SALES_POSITIONS" WHERE "SALES_ID" = 8811370;
-- Q0216 [OK_PREP]
SELECT COUNT(*) FROM "SALES" WHERE "MARKET_ID" = ?;
-- Q0217 [OK_PREP]
MERGE INTO "MARKETS" T
USING (SELECT ? AS MARKET_ID, ? AS POPULATION) S
ON (T."MARKET_ID" = S.MARKET_ID)
WHEN MATCHED THEN UPDATE SET T."POPULATION" = S.POPULATION
WHEN NOT MATCHED THEN INSERT ("MARKET_ID","POPULATION") VALUES (S.MARKET_ID, S.POPULATION);
-- Q0218 [OK]
UPDATE "MARKETS" SET "POPULATION" = 14688411 WHERE "MARKET_ID" = 377283;
-- Q0219 [OK]
INSERT INTO "DIM_DATE" ("SALES_DATE") VALUES (DATE '2006-03-12');
-- Q0220 [OK]
SELECT "PURCHASE_PRICE" FROM "ARTICLE";
-- Q0221 [OK]
SELECT
  S."MARKET_ID",
  S."SALES_DATE",
  S."SALES_ID",
  S."PRICE",
  SUM(S."PRICE") OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE") AS DAY_MARKET_REVENUE,
  ROW_NUMBER() OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE" ORDER BY S."PRICE" DESC NULLS LAST) AS RN
FROM "SALES" S
WHERE S."SALES_DATE" IS NOT NULL
QUALIFY RN <= 50
ORDER BY DAY_MARKET_REVENUE DESC NULLS LAST;
-- Q0222 [FAIL]
INSERT INTO "NO_SUCH_TABLE" ("A") VALUES (1);
-- Q0223 [OK]
UPDATE "MARKETS" SET "POPULATION" = 11452589 WHERE "MARKET_ID" = 7084642;
-- Q0224 [OK]
INSERT INTO "DIM_DATE" ("SALES_DATE") VALUES (DATE '2011-08-27');
-- Q0225 [OK]
SELECT "PRODUCT_GROUP_DESC", "BASE_SALES_PRICE" FROM "ARTICLE" LIMIT 100;
-- Q0226 [OK]
SELECT
  S."MARKET_ID",
  S."SALES_DATE",
  S."SALES_ID",
  S."PRICE",
  SUM(S."PRICE") OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE") AS DAY_MARKET_REVENUE,
  ROW_NUMBER() OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE" ORDER BY S."PRICE" DESC NULLS LAST) AS RN
FROM "SALES" S
WHERE S."SALES_DATE" IS NOT NULL
QUALIFY RN <= 50
ORDER BY DAY_MARKET_REVENUE DESC NULLS LAST;
-- Q0227 [OK]
SELECT "SALES_DATE" FROM "DIM_DATE" WHERE "SALES_DATE" IS NOT NULL LIMIT 100;
-- Q0228 [OK]
UPDATE "MARKETS" SET "POPULATION" = 993131 WHERE "MARKET_ID" = 1652705;
-- Q0229 [OK]
SELECT
  S."MARKET_ID",
  S."SALES_DATE",
  S."SALES_ID",
  S."PRICE",
  SUM(S."PRICE") OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE") AS DAY_MARKET_REVENUE,
  ROW_NUMBER() OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE" ORDER BY S."PRICE" DESC NULLS LAST) AS RN
FROM "SALES" S
WHERE S."SALES_DATE" IS NOT NULL
QUALIFY RN <= 50
ORDER BY DAY_MARKET_REVENUE DESC NULLS LAST;
-- Q0230 [OK]
SELECT
  S."MARKET_ID",
  S."SALES_DATE",
  S."SALES_ID",
  S."PRICE",
  SUM(S."PRICE") OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE") AS DAY_MARKET_REVENUE,
  ROW_NUMBER() OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE" ORDER BY S."PRICE" DESC NULLS LAST) AS RN
FROM "SALES" S
WHERE S."SALES_DATE" IS NOT NULL
QUALIFY RN <= 50
ORDER BY DAY_MARKET_REVENUE DESC NULLS LAST;
-- Q0231 [OK]
SELECT M."MARKET_ID", C."COUNTRY_CODE", M."POPULATION" FROM "MARKETS" M LEFT JOIN "CITIES" C ON C."CITY_ID" = M."CITY_ID" LIMIT 200;
-- Q0232 [OK]
SELECT SP."SALES_ID", A."PRODUCT_GROUP", SUM(SP."AMOUNT") AS UNITS FROM "SALES_POSITIONS" SP JOIN "ARTICLE" A ON A."ARTICLE_ID" = SP."ARTICLE_ID" GROUP BY SP."SALES_ID", A."PRODUCT_GROUP" ORDER BY UNITS DESC NULLS LAST LIMIT 200;
-- Q0233 [OK]
DELETE FROM "SALES_POSITIONS" WHERE "SALES_ID" = 9707523;
-- Q0234 [OK]
UPDATE "MARKETS" SET "POPULATION" = 17052456 WHERE "MARKET_ID" = 5856209;
-- Q0235 [OK_PREP]
INSERT INTO "DIM_DATE" ("SALES_DATE") VALUES (?);
-- Q0236 [OK]
DELETE FROM "SALES_POSITIONS" WHERE "SALES_ID" = 1442325;
-- Q0237 [OK_PREP]
UPDATE "MARKETS" SET "POPULATION" = ? WHERE "MARKET_ID" = ?;
-- Q0238 [FAIL]
DELETE FROM "UNKNOWN_TABLE" WHERE 1=1;
-- Q0239 [FAIL]
SELECT * FROM "SALESX" LIMIT 10;
-- Q0240 [OK]
SELECT
  S."MARKET_ID",
  S."SALES_DATE",
  S."SALES_ID",
  S."PRICE",
  SUM(S."PRICE") OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE") AS DAY_MARKET_REVENUE,
  ROW_NUMBER() OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE" ORDER BY S."PRICE" DESC NULLS LAST) AS RN
FROM "SALES" S
WHERE S."SALES_DATE" IS NOT NULL
QUALIFY RN <= 50
ORDER BY DAY_MARKET_REVENUE DESC NULLS LAST;
-- Q0241 [OK]
SELECT
  S."MARKET_ID",
  S."SALES_DATE",
  S."SALES_ID",
  S."PRICE",
  SUM(S."PRICE") OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE") AS DAY_MARKET_REVENUE,
  ROW_NUMBER() OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE" ORDER BY S."PRICE" DESC NULLS LAST) AS RN
FROM "SALES" S
WHERE S."SALES_DATE" IS NOT NULL
QUALIFY RN <= 50
ORDER BY DAY_MARKET_REVENUE DESC NULLS LAST;
-- Q0242 [OK]
UPDATE "MARKETS" SET "POPULATION" = 3746240 WHERE "MARKET_ID" = 2085731;
-- Q0243 [OK]
INSERT INTO "MARKETS" ("MARKET_ID","POPULATION") VALUES (2392408, 5714981);
-- Q0244 [OK]
INSERT INTO "DIM_DATE" ("SALES_DATE") VALUES (DATE '2021-10-25');
-- Q0245 [OK]
MERGE INTO "MARKETS" T
USING (SELECT 493319 AS MARKET_ID, 4452200 AS POPULATION) S
ON (T."MARKET_ID" = S.MARKET_ID)
WHEN MATCHED THEN UPDATE SET T."POPULATION" = S.POPULATION
WHEN NOT MATCHED THEN INSERT ("MARKET_ID","POPULATION") VALUES (S.MARKET_ID, S.POPULATION);
-- Q0246 [OK]
INSERT INTO "MARKETS" ("MARKET_ID","POPULATION") VALUES (8172700, 5580023);
-- Q0247 [OK]
SELECT "AREA" FROM "MARKETS";
-- Q0248 [OK]
SELECT "CITY_NAME", "AREA" FROM "CITIES" LIMIT 100;
-- Q0249 [OK]
SELECT "COUNTRY_CODE" FROM "CITIES" LIMIT 100;
-- Q0250 [OK]
DELETE FROM "SALES_POSITIONS" WHERE "SALES_ID" = 5445139;
-- Q0251 [OK_PREP]
DELETE FROM "SALES_POSITIONS" WHERE "SALES_ID" = ?;
-- Q0252 [OK]
SELECT "PRICE" FROM "SALES_POSITIONS" LIMIT 100;
-- Q0253 [OK]
INSERT INTO "MARKETS" ("MARKET_ID","POPULATION") VALUES (2298146, 2241762);
-- Q0254 [OK]
DELETE FROM "SALES_POSITIONS" WHERE "SALES_ID" = 9824644;
-- Q0255 [OK]
INSERT INTO "DIM_DATE" ("SALES_DATE") VALUES (DATE '2019-06-06');
-- Q0256 [OK]
DELETE FROM "SALES_POSITIONS" WHERE "SALES_ID" = 6205904;
-- Q0257 [OK]
SELECT
  S."MARKET_ID",
  S."SALES_DATE",
  S."SALES_ID",
  S."PRICE",
  SUM(S."PRICE") OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE") AS DAY_MARKET_REVENUE,
  ROW_NUMBER() OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE" ORDER BY S."PRICE" DESC NULLS LAST) AS RN
FROM "SALES" S
WHERE S."SALES_DATE" IS NOT NULL
QUALIFY RN <= 50
ORDER BY DAY_MARKET_REVENUE DESC NULLS LAST;
-- Q0258 [OK]
UPDATE "MARKETS" SET "POPULATION" = 7546912 WHERE "MARKET_ID" = 7499060;
-- Q0259 [OK]
DELETE FROM "SALES_POSITIONS" WHERE "SALES_ID" = 8303197;
-- Q0260 [OK]
INSERT INTO "MARKETS" ("MARKET_ID","POPULATION") VALUES (4188704, 7209836);
-- Q0261 [OK]
SELECT S."SALES_ID", S."SALES_DATE", SP."ARTICLE_ID", SP."AMOUNT" FROM "SALES" S JOIN "SALES_POSITIONS" SP ON SP."SALES_ID" = S."SALES_ID" LIMIT 200;
-- Q0262 [OK]
DELETE FROM "SALES_POSITIONS" WHERE "SALES_ID" = 3082336;
-- Q0263 [OK]
SELECT "VOUCHER_ID", "ARTICLE_ID", "AMOUNT" FROM "SALES_POSITIONS" WHERE "ARTICLE_ID" IS NOT NULL LIMIT 100;
-- Q0264 [FAIL]
SELECT 1/0;
-- Q0265 [OK]
INSERT INTO "MARKETS" ("MARKET_ID","POPULATION") VALUES (5660247, 3615894);
-- Q0266 [OK_PREP]
DELETE FROM "SALES_POSITIONS" WHERE "SALES_ID" = ?;
-- Q0267 [OK]
SELECT "ZIP_CODE", "LON", "COUNTRY_CODE" FROM "CITIES" LIMIT 100;
-- Q0268 [FAIL]
INSERT INTO "DIM_DATE" ("SALES_DATE") VALUES (DATE '2020-01-01';
-- Q0269 [OK_PREP]
DELETE FROM "SALES_POSITIONS" WHERE "SALES_ID" = ?;
-- Q0270 [OK]
SELECT SP."SALES_ID", A."PRODUCT_GROUP", SUM(SP."AMOUNT") AS UNITS FROM "SALES_POSITIONS" SP JOIN "ARTICLE" A ON A."ARTICLE_ID" = SP."ARTICLE_ID" GROUP BY SP."SALES_ID", A."PRODUCT_GROUP" ORDER BY UNITS DESC NULLS LAST LIMIT 200;
-- Q0271 [OK]
DELETE FROM "SALES_POSITIONS" WHERE "SALES_ID" = 1841230;
-- Q0272 [OK]
DELETE FROM "SALES_POSITIONS" WHERE "SALES_ID" = 1268295;
-- Q0273 [OK]
SELECT M."MARKET_ID", C."COUNTRY_CODE", M."POPULATION" FROM "MARKETS" M LEFT JOIN "CITIES" C ON C."CITY_ID" = M."CITY_ID" LIMIT 200;
-- Q0274 [OK]
SELECT
  S."MARKET_ID",
  S."SALES_DATE",
  S."SALES_ID",
  S."PRICE",
  SUM(S."PRICE") OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE") AS DAY_MARKET_REVENUE,
  ROW_NUMBER() OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE" ORDER BY S."PRICE" DESC NULLS LAST) AS RN
FROM "SALES" S
WHERE S."SALES_DATE" IS NOT NULL
QUALIFY RN <= 50
ORDER BY DAY_MARKET_REVENUE DESC NULLS LAST;
-- Q0275 [OK]
SELECT "SALES_DATE" FROM "DIM_DATE" WHERE "SALES_DATE" IS NOT NULL LIMIT 100;
-- Q0276 [OK]
INSERT INTO "DIM_DATE" ("SALES_DATE") VALUES (DATE '2025-11-20');
-- Q0277 [FAIL]
INSERT INTO "DIM_DATE" ("SALES_DATE") VALUES (DATE '2020-01-01';
-- Q0278 [OK]
SELECT
  S."MARKET_ID",
  S."SALES_DATE",
  S."SALES_ID",
  S."PRICE",
  SUM(S."PRICE") OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE") AS DAY_MARKET_REVENUE,
  ROW_NUMBER() OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE" ORDER BY S."PRICE" DESC NULLS LAST) AS RN
FROM "SALES" S
WHERE S."SALES_DATE" IS NOT NULL
QUALIFY RN <= 50
ORDER BY DAY_MARKET_REVENUE DESC NULLS LAST;
-- Q0279 [OK]
UPDATE "MARKETS" SET "POPULATION" = 12721967 WHERE "MARKET_ID" = 4758462;
-- Q0280 [OK]
SELECT S."SALES_ID", S."SALES_DATE", SP."ARTICLE_ID", SP."AMOUNT" FROM "SALES" S JOIN "SALES_POSITIONS" SP ON SP."SALES_ID" = S."SALES_ID" LIMIT 200;
-- Q0281 [OK]
UPDATE "MARKETS" SET "POPULATION" = 10657676 WHERE "MARKET_ID" = 7643879;
-- Q0282 [OK]
SELECT SP."SALES_ID", A."PRODUCT_GROUP", SUM(SP."AMOUNT") AS UNITS FROM "SALES_POSITIONS" SP JOIN "ARTICLE" A ON A."ARTICLE_ID" = SP."ARTICLE_ID" GROUP BY SP."SALES_ID", A."PRODUCT_GROUP" ORDER BY UNITS DESC NULLS LAST LIMIT 200;
-- Q0283 [OK_PREP]
SELECT * FROM "MARKETS" WHERE "CITY_ID" = ? LIMIT 50;
-- Q0284 [OK]
INSERT INTO "MARKETS" ("MARKET_ID","POPULATION") VALUES (6285973, 500122);
-- Q0285 [OK]
INSERT INTO "MARKETS" ("MARKET_ID","POPULATION") VALUES (6075262, 106166);
-- Q0286 [OK]
MERGE INTO "MARKETS" T
USING (SELECT 7079262 AS MARKET_ID, 8616209 AS POPULATION) S
ON (T."MARKET_ID" = S.MARKET_ID)
WHEN MATCHED THEN UPDATE SET T."POPULATION" = S.POPULATION
WHEN NOT MATCHED THEN INSERT ("MARKET_ID","POPULATION") VALUES (S.MARKET_ID, S.POPULATION);
-- Q0287 [OK]
MERGE INTO "MARKETS" T
USING (SELECT 200204 AS MARKET_ID, 8588521 AS POPULATION) S
ON (T."MARKET_ID" = S.MARKET_ID)
WHEN MATCHED THEN UPDATE SET T."POPULATION" = S.POPULATION
WHEN NOT MATCHED THEN INSERT ("MARKET_ID","POPULATION") VALUES (S.MARKET_ID, S.POPULATION);
-- Q0288 [OK_PREP]
SELECT COUNT(*) FROM "SALES" WHERE "MARKET_ID" = ?;
-- Q0289 [OK]
SELECT SP."SALES_ID", A."PRODUCT_GROUP", SUM(SP."AMOUNT") AS UNITS FROM "SALES_POSITIONS" SP JOIN "ARTICLE" A ON A."ARTICLE_ID" = SP."ARTICLE_ID" GROUP BY SP."SALES_ID", A."PRODUCT_GROUP" ORDER BY UNITS DESC NULLS LAST LIMIT 200;
-- Q0290 [OK]
INSERT INTO "MARKETS" ("MARKET_ID","POPULATION") VALUES (1719291, 6286334);
-- Q0291 [OK]
DELETE FROM "SALES_POSITIONS" WHERE "SALES_ID" = 1558763;
-- Q0292 [OK]
UPDATE "MARKETS" SET "POPULATION" = 13979383 WHERE "MARKET_ID" = 1155920;
-- Q0293 [OK]
UPDATE "MARKETS" SET "POPULATION" = 18064255 WHERE "MARKET_ID" = 60020;
-- Q0294 [FAIL]
SELECT "NOPE" FROM "SALES" LIMIT 10;
-- Q0295 [OK]
INSERT INTO "DIM_DATE" ("SALES_DATE") VALUES (DATE '2018-09-22');
-- Q0296 [OK]
SELECT SP."SALES_ID", A."PRODUCT_GROUP", SUM(SP."AMOUNT") AS UNITS FROM "SALES_POSITIONS" SP JOIN "ARTICLE" A ON A."ARTICLE_ID" = SP."ARTICLE_ID" GROUP BY SP."SALES_ID", A."PRODUCT_GROUP" ORDER BY UNITS DESC NULLS LAST LIMIT 200;
-- Q0297 [OK]
INSERT INTO "MARKETS" ("MARKET_ID","POPULATION") VALUES (5576971, 5030303);
-- Q0298 [OK]
SELECT "SALES_ID", "LOYALTY_ID" FROM "SALES";
-- Q0299 [OK]
SELECT
  S."MARKET_ID",
  S."SALES_DATE",
  S."SALES_ID",
  S."PRICE",
  SUM(S."PRICE") OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE") AS DAY_MARKET_REVENUE,
  ROW_NUMBER() OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE" ORDER BY S."PRICE" DESC NULLS LAST) AS RN
FROM "SALES" S
WHERE S."SALES_DATE" IS NOT NULL
QUALIFY RN <= 50
ORDER BY DAY_MARKET_REVENUE DESC NULLS LAST;
-- Q0300 [OK]
SELECT S."SALES_ID", S."SALES_DATE", SP."ARTICLE_ID", SP."AMOUNT" FROM "SALES" S JOIN "SALES_POSITIONS" SP ON SP."SALES_ID" = S."SALES_ID" LIMIT 200;
-- Q0301 [OK]
INSERT INTO "DIM_DATE" ("SALES_DATE") VALUES (DATE '2021-05-28');
-- Q0302 [OK]
DELETE FROM "SALES_POSITIONS" WHERE "SALES_ID" = 182732;
-- Q0303 [OK]
DELETE FROM "SALES_POSITIONS" WHERE "SALES_ID" = 8421914;
-- Q0304 [OK]
DELETE FROM "SALES_POSITIONS" WHERE "SALES_ID" = 4752293;
-- Q0305 [OK_PREP]
SELECT COUNT(*) FROM "SALES" WHERE "MARKET_ID" = ?;
-- Q0306 [FAIL]
SELEC COUNT(*) FROM "SALES";
-- Q0307 [OK]
SELECT S."SALES_ID", S."SALES_DATE", SP."ARTICLE_ID", SP."AMOUNT" FROM "SALES" S JOIN "SALES_POSITIONS" SP ON SP."SALES_ID" = S."SALES_ID" LIMIT 200;
-- Q0308 [OK]
SELECT
  S."MARKET_ID",
  S."SALES_DATE",
  S."SALES_ID",
  S."PRICE",
  SUM(S."PRICE") OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE") AS DAY_MARKET_REVENUE,
  ROW_NUMBER() OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE" ORDER BY S."PRICE" DESC NULLS LAST) AS RN
FROM "SALES" S
WHERE S."SALES_DATE" IS NOT NULL
QUALIFY RN <= 50
ORDER BY DAY_MARKET_REVENUE DESC NULLS LAST;
-- Q0309 [FAIL]
SELECT FROM "SALES";
-- Q0310 [OK]
INSERT INTO "DIM_DATE" ("SALES_DATE") VALUES (DATE '2025-03-25');
-- Q0311 [OK]
UPDATE "MARKETS" SET "POPULATION" = 10714807 WHERE "MARKET_ID" = 1241445;
-- Q0312 [OK]
INSERT INTO "DIM_DATE" ("SALES_DATE") VALUES (DATE '2005-07-12');
-- Q0313 [OK]
SELECT SP."SALES_ID", A."PRODUCT_GROUP", SUM(SP."AMOUNT") AS UNITS FROM "SALES_POSITIONS" SP JOIN "ARTICLE" A ON A."ARTICLE_ID" = SP."ARTICLE_ID" GROUP BY SP."SALES_ID", A."PRODUCT_GROUP" ORDER BY UNITS DESC NULLS LAST LIMIT 200;
-- Q0314 [OK]
INSERT INTO "DIM_DATE" ("SALES_DATE") VALUES (DATE '2013-09-16');
-- Q0315 [OK]
INSERT INTO "DIM_DATE" ("SALES_DATE") VALUES (DATE '2018-02-07');
-- Q0316 [OK]
DELETE FROM "SALES_POSITIONS" WHERE "SALES_ID" = 7445667;
-- Q0317 [OK]
INSERT INTO "MARKETS" ("MARKET_ID","POPULATION") VALUES (7784951, 4101409);
-- Q0318 [OK]
DELETE FROM "SALES_POSITIONS" WHERE "SALES_ID" = 6145243;
-- Q0319 [OK]
INSERT INTO "MARKETS" ("MARKET_ID","POPULATION") VALUES (6596621, 7008450);
-- Q0320 [OK]
SELECT S."SALES_ID", S."SALES_DATE", SP."ARTICLE_ID", SP."AMOUNT" FROM "SALES" S JOIN "SALES_POSITIONS" SP ON SP."SALES_ID" = S."SALES_ID" LIMIT 200;
-- Q0321 [OK]
UPDATE "MARKETS" SET "POPULATION" = 3860294 WHERE "MARKET_ID" = 4232079;
-- Q0322 [OK]
INSERT INTO "MARKETS" ("MARKET_ID","POPULATION") VALUES (8624008, 4562854);
-- Q0323 [OK]
SELECT
  S."MARKET_ID",
  S."SALES_DATE",
  S."SALES_ID",
  S."PRICE",
  SUM(S."PRICE") OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE") AS DAY_MARKET_REVENUE,
  ROW_NUMBER() OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE" ORDER BY S."PRICE" DESC NULLS LAST) AS RN
FROM "SALES" S
WHERE S."SALES_DATE" IS NOT NULL
QUALIFY RN <= 50
ORDER BY DAY_MARKET_REVENUE DESC NULLS LAST;
-- Q0324 [OK]
DELETE FROM "SALES_POSITIONS" WHERE "SALES_ID" = 7616420;
-- Q0325 [OK]
INSERT INTO "MARKETS" ("MARKET_ID","POPULATION") VALUES (1462045, 6499939);
-- Q0326 [OK]
INSERT INTO "MARKETS" ("MARKET_ID","POPULATION") VALUES (4309264, 6835372);
-- Q0327 [OK]
SELECT "AMOUNT", "ARTICLE_ID", "POSITION_ID" FROM "SALES_POSITIONS" WHERE "POSITION_ID" IS NOT NULL;
-- Q0328 [OK]
INSERT INTO "DIM_DATE" ("SALES_DATE") VALUES (DATE '2010-06-25');
-- Q0329 [OK]
SELECT SP."SALES_ID", A."PRODUCT_GROUP", SUM(SP."AMOUNT") AS UNITS FROM "SALES_POSITIONS" SP JOIN "ARTICLE" A ON A."ARTICLE_ID" = SP."ARTICLE_ID" GROUP BY SP."SALES_ID", A."PRODUCT_GROUP" ORDER BY UNITS DESC NULLS LAST LIMIT 200;
-- Q0330 [FAIL]
UPDATE "UNKNOWN_TABLE" SET "X" = 1;
-- Q0331 [OK]
DELETE FROM "SALES_POSITIONS" WHERE "SALES_ID" = 9807315;
-- Q0332 [OK]
SELECT
  S."MARKET_ID",
  S."SALES_DATE",
  S."SALES_ID",
  S."PRICE",
  SUM(S."PRICE") OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE") AS DAY_MARKET_REVENUE,
  ROW_NUMBER() OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE" ORDER BY S."PRICE" DESC NULLS LAST) AS RN
FROM "SALES" S
WHERE S."SALES_DATE" IS NOT NULL
QUALIFY RN <= 50
ORDER BY DAY_MARKET_REVENUE DESC NULLS LAST;
-- Q0333 [OK_PREP]
INSERT INTO "MARKETS" ("MARKET_ID","POPULATION") VALUES (?, ?);
-- Q0334 [OK]
SELECT "SALES_DATE", "TERMINAL_ID", "SALES_ID" FROM "SALES" WHERE "SALES_ID" IS NOT NULL;
-- Q0335 [OK]
MERGE INTO "MARKETS" T
USING (SELECT 1423670 AS MARKET_ID, 2685102 AS POPULATION) S
ON (T."MARKET_ID" = S.MARKET_ID)
WHEN MATCHED THEN UPDATE SET T."POPULATION" = S.POPULATION
WHEN NOT MATCHED THEN INSERT ("MARKET_ID","POPULATION") VALUES (S.MARKET_ID, S.POPULATION);
-- Q0336 [OK]
INSERT INTO "MARKETS" ("MARKET_ID","POPULATION") VALUES (3227755, 8989919);
-- Q0337 [OK]
INSERT INTO "MARKETS" ("MARKET_ID","POPULATION") VALUES (3704196, 5075929);
-- Q0338 [FAIL]
DELETE FROM "UNKNOWN_TABLE" WHERE 1=1;
-- Q0339 [OK]
SELECT
  S."MARKET_ID",
  S."SALES_DATE",
  S."SALES_ID",
  S."PRICE",
  SUM(S."PRICE") OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE") AS DAY_MARKET_REVENUE,
  ROW_NUMBER() OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE" ORDER BY S."PRICE" DESC NULLS LAST) AS RN
FROM "SALES" S
WHERE S."SALES_DATE" IS NOT NULL
QUALIFY RN <= 50
ORDER BY DAY_MARKET_REVENUE DESC NULLS LAST;
-- Q0340 [OK]
SELECT SP."SALES_ID", A."PRODUCT_GROUP", SUM(SP."AMOUNT") AS UNITS FROM "SALES_POSITIONS" SP JOIN "ARTICLE" A ON A."ARTICLE_ID" = SP."ARTICLE_ID" GROUP BY SP."SALES_ID", A."PRODUCT_GROUP" ORDER BY UNITS DESC NULLS LAST LIMIT 200;
-- Q0341 [OK]
SELECT S."SALES_ID", S."SALES_DATE", SP."ARTICLE_ID", SP."AMOUNT" FROM "SALES" S JOIN "SALES_POSITIONS" SP ON SP."SALES_ID" = S."SALES_ID" LIMIT 200;
-- Q0342 [OK]
SELECT
  S."MARKET_ID",
  S."SALES_DATE",
  S."SALES_ID",
  S."PRICE",
  SUM(S."PRICE") OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE") AS DAY_MARKET_REVENUE,
  ROW_NUMBER() OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE" ORDER BY S."PRICE" DESC NULLS LAST) AS RN
FROM "SALES" S
WHERE S."SALES_DATE" IS NOT NULL
QUALIFY RN <= 50
ORDER BY DAY_MARKET_REVENUE DESC NULLS LAST;
-- Q0343 [OK]
SELECT
  S."MARKET_ID",
  S."SALES_DATE",
  S."SALES_ID",
  S."PRICE",
  SUM(S."PRICE") OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE") AS DAY_MARKET_REVENUE,
  ROW_NUMBER() OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE" ORDER BY S."PRICE" DESC NULLS LAST) AS RN
FROM "SALES" S
WHERE S."SALES_DATE" IS NOT NULL
QUALIFY RN <= 50
ORDER BY DAY_MARKET_REVENUE DESC NULLS LAST;
-- Q0344 [OK]
SELECT "AREA", "LON" FROM "CITIES";
-- Q0345 [OK]
SELECT M."MARKET_ID", C."COUNTRY_CODE", M."POPULATION" FROM "MARKETS" M LEFT JOIN "CITIES" C ON C."CITY_ID" = M."CITY_ID" LIMIT 200;
-- Q0346 [OK]
INSERT INTO "MARKETS" ("MARKET_ID","POPULATION") VALUES (6414380, 2218135);
-- Q0347 [OK]
MERGE INTO "MARKETS" T
USING (SELECT 5150905 AS MARKET_ID, 7751978 AS POPULATION) S
ON (T."MARKET_ID" = S.MARKET_ID)
WHEN MATCHED THEN UPDATE SET T."POPULATION" = S.POPULATION
WHEN NOT MATCHED THEN INSERT ("MARKET_ID","POPULATION") VALUES (S.MARKET_ID, S.POPULATION);
-- Q0348 [FAIL]
SELECT CAST('abc' AS DECIMAL(18,0));
-- Q0349 [OK]
MERGE INTO "MARKETS" T
USING (SELECT 2640607 AS MARKET_ID, 2160372 AS POPULATION) S
ON (T."MARKET_ID" = S.MARKET_ID)
WHEN MATCHED THEN UPDATE SET T."POPULATION" = S.POPULATION
WHEN NOT MATCHED THEN INSERT ("MARKET_ID","POPULATION") VALUES (S.MARKET_ID, S.POPULATION);
-- Q0350 [FAIL]
INSERT INTO "DIM_DATE" ("SALES_DATE") VALUES (DATE '2020-01-01';
-- Q0351 [OK]
DELETE FROM "SALES_POSITIONS" WHERE "SALES_ID" = 5746266;
-- Q0352 [OK]
DELETE FROM "SALES_POSITIONS" WHERE "SALES_ID" = 6495093;
-- Q0353 [OK]
SELECT "DISTRICT", "LON", "CITY_ID" FROM "CITIES" WHERE "LON" IS NOT NULL;
-- Q0354 [OK]
SELECT
  S."MARKET_ID",
  S."SALES_DATE",
  S."SALES_ID",
  S."PRICE",
  SUM(S."PRICE") OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE") AS DAY_MARKET_REVENUE,
  ROW_NUMBER() OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE" ORDER BY S."PRICE" DESC NULLS LAST) AS RN
FROM "SALES" S
WHERE S."SALES_DATE" IS NOT NULL
QUALIFY RN <= 50
ORDER BY DAY_MARKET_REVENUE DESC NULLS LAST;
-- Q0355 [OK]
SELECT "LON", "AREA_SHORT", "CITY_NAME" FROM "CITIES" LIMIT 100;
-- Q0356 [OK]
INSERT INTO "MARKETS" ("MARKET_ID","POPULATION") VALUES (6472694, 9130174);
-- Q0357 [OK]
INSERT INTO "MARKETS" ("MARKET_ID","POPULATION") VALUES (1601638, 6855230);
-- Q0358 [OK]
SELECT SP."SALES_ID", A."PRODUCT_GROUP", SUM(SP."AMOUNT") AS UNITS FROM "SALES_POSITIONS" SP JOIN "ARTICLE" A ON A."ARTICLE_ID" = SP."ARTICLE_ID" GROUP BY SP."SALES_ID", A."PRODUCT_GROUP" ORDER BY UNITS DESC NULLS LAST LIMIT 200;
-- Q0359 [OK]
SELECT M."MARKET_ID", C."COUNTRY_CODE", M."POPULATION" FROM "MARKETS" M LEFT JOIN "CITIES" C ON C."CITY_ID" = M."CITY_ID" LIMIT 200;
-- Q0360 [OK]
SELECT
  S."MARKET_ID",
  S."SALES_DATE",
  S."SALES_ID",
  S."PRICE",
  SUM(S."PRICE") OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE") AS DAY_MARKET_REVENUE,
  ROW_NUMBER() OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE" ORDER BY S."PRICE" DESC NULLS LAST) AS RN
FROM "SALES" S
WHERE S."SALES_DATE" IS NOT NULL
QUALIFY RN <= 50
ORDER BY DAY_MARKET_REVENUE DESC NULLS LAST;
-- Q0361 [OK]
DELETE FROM "SALES_POSITIONS" WHERE "SALES_ID" = 1052869;
-- Q0362 [OK]
INSERT INTO "MARKETS" ("MARKET_ID","POPULATION") VALUES (2175597, 5786151);
-- Q0363 [OK]
SELECT
  S."MARKET_ID",
  S."SALES_DATE",
  S."SALES_ID",
  S."PRICE",
  SUM(S."PRICE") OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE") AS DAY_MARKET_REVENUE,
  ROW_NUMBER() OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE" ORDER BY S."PRICE" DESC NULLS LAST) AS RN
FROM "SALES" S
WHERE S."SALES_DATE" IS NOT NULL
QUALIFY RN <= 50
ORDER BY DAY_MARKET_REVENUE DESC NULLS LAST;
-- Q0364 [FAIL]
DELETEE FROM "SALES";
-- Q0365 [OK]
SELECT SP."SALES_ID", A."PRODUCT_GROUP", SUM(SP."AMOUNT") AS UNITS FROM "SALES_POSITIONS" SP JOIN "ARTICLE" A ON A."ARTICLE_ID" = SP."ARTICLE_ID" GROUP BY SP."SALES_ID", A."PRODUCT_GROUP" ORDER BY UNITS DESC NULLS LAST LIMIT 200;
-- Q0366 [OK]
INSERT INTO "MARKETS" ("MARKET_ID","POPULATION") VALUES (3523357, 7088023);
-- Q0367 [OK]
SELECT "LATITUDE", "AREA", "LONGITUDE" FROM "MARKETS" LIMIT 100;
-- Q0368 [OK]
SELECT
  S."MARKET_ID",
  S."SALES_DATE",
  S."SALES_ID",
  S."PRICE",
  SUM(S."PRICE") OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE") AS DAY_MARKET_REVENUE,
  ROW_NUMBER() OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE" ORDER BY S."PRICE" DESC NULLS LAST) AS RN
FROM "SALES" S
WHERE S."SALES_DATE" IS NOT NULL
QUALIFY RN <= 50
ORDER BY DAY_MARKET_REVENUE DESC NULLS LAST;
-- Q0369 [OK]
UPDATE "MARKETS" SET "POPULATION" = 17171029 WHERE "MARKET_ID" = 9310098;
-- Q0370 [OK]
UPDATE "MARKETS" SET "POPULATION" = 6410866 WHERE "MARKET_ID" = 9254698;
-- Q0371 [OK]
SELECT "SALES_ID" FROM "SALES" LIMIT 100;
-- Q0372 [OK]
INSERT INTO "MARKETS" ("MARKET_ID","POPULATION") VALUES (6748559, 4246111);
-- Q0373 [OK_PREP]
INSERT INTO "MARKETS" ("MARKET_ID","POPULATION") VALUES (?, ?);
-- Q0374 [OK_PREP]
INSERT INTO "MARKETS" ("MARKET_ID","POPULATION") VALUES (?, ?);
-- Q0375 [OK_PREP]
SELECT * FROM "CITIES" WHERE "COUNTRY_CODE" = ? LIMIT 100;
-- Q0376 [OK]
DELETE FROM "SALES_POSITIONS" WHERE "SALES_ID" = 3509699;
-- Q0377 [OK]
INSERT INTO "DIM_DATE" ("SALES_DATE") VALUES (DATE '2010-05-02');
-- Q0378 [FAIL]
INSERT INTO "NO_SUCH_TABLE" ("A") VALUES (1);
-- Q0379 [OK]
MERGE INTO "MARKETS" T
USING (SELECT 7149053 AS MARKET_ID, 8914239 AS POPULATION) S
ON (T."MARKET_ID" = S.MARKET_ID)
WHEN MATCHED THEN UPDATE SET T."POPULATION" = S.POPULATION
WHEN NOT MATCHED THEN INSERT ("MARKET_ID","POPULATION") VALUES (S.MARKET_ID, S.POPULATION);
-- Q0380 [OK]
SELECT "SALES_DATE" FROM "DIM_DATE" WHERE "SALES_DATE" IS NOT NULL LIMIT 100;
-- Q0381 [OK_PREP]
SELECT * FROM "MARKETS" WHERE "CITY_ID" = ? LIMIT 50;
-- Q0382 [OK]
MERGE INTO "MARKETS" T
USING (SELECT 800421 AS MARKET_ID, 1374206 AS POPULATION) S
ON (T."MARKET_ID" = S.MARKET_ID)
WHEN MATCHED THEN UPDATE SET T."POPULATION" = S.POPULATION
WHEN NOT MATCHED THEN INSERT ("MARKET_ID","POPULATION") VALUES (S.MARKET_ID, S.POPULATION);
-- Q0383 [FAIL]
SELECT FROM "SALES";
-- Q0384 [OK]
SELECT "TERMINAL_DAILY_SALES_NR" FROM "SALES" LIMIT 100;
-- Q0385 [FAIL]
SELECT "NOPE" FROM "SALES" LIMIT 10;
-- Q0386 [OK]
INSERT INTO "DIM_DATE" ("SALES_DATE") VALUES (DATE '2006-02-28');
-- Q0387 [OK]
DELETE FROM "SALES_POSITIONS" WHERE "SALES_ID" = 7000345;
-- Q0388 [OK_PREP]
MERGE INTO "MARKETS" T
USING (SELECT ? AS MARKET_ID, ? AS POPULATION) S
ON (T."MARKET_ID" = S.MARKET_ID)
WHEN MATCHED THEN UPDATE SET T."POPULATION" = S.POPULATION
WHEN NOT MATCHED THEN INSERT ("MARKET_ID","POPULATION") VALUES (S.MARKET_ID, S.POPULATION);
-- Q0389 [OK]
SELECT
  S."MARKET_ID",
  S."SALES_DATE",
  S."SALES_ID",
  S."PRICE",
  SUM(S."PRICE") OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE") AS DAY_MARKET_REVENUE,
  ROW_NUMBER() OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE" ORDER BY S."PRICE" DESC NULLS LAST) AS RN
FROM "SALES" S
WHERE S."SALES_DATE" IS NOT NULL
QUALIFY RN <= 50
ORDER BY DAY_MARKET_REVENUE DESC NULLS LAST;
-- Q0390 [OK]
SELECT "PRICE" FROM "SALES_POSITIONS" LIMIT 100;
-- Q0391 [OK]
MERGE INTO "MARKETS" T
USING (SELECT 5272371 AS MARKET_ID, 5250359 AS POPULATION) S
ON (T."MARKET_ID" = S.MARKET_ID)
WHEN MATCHED THEN UPDATE SET T."POPULATION" = S.POPULATION
WHEN NOT MATCHED THEN INSERT ("MARKET_ID","POPULATION") VALUES (S.MARKET_ID, S.POPULATION);
-- Q0392 [OK]
SELECT
  S."MARKET_ID",
  S."SALES_DATE",
  S."SALES_ID",
  S."PRICE",
  SUM(S."PRICE") OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE") AS DAY_MARKET_REVENUE,
  ROW_NUMBER() OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE" ORDER BY S."PRICE" DESC NULLS LAST) AS RN
FROM "SALES" S
WHERE S."SALES_DATE" IS NOT NULL
QUALIFY RN <= 50
ORDER BY DAY_MARKET_REVENUE DESC NULLS LAST;
-- Q0393 [OK]
SELECT "LOYALTY_ID", "SALES_ID", "MARKET_ID" FROM "SALES" LIMIT 100;
-- Q0394 [OK]
INSERT INTO "MARKETS" ("MARKET_ID","POPULATION") VALUES (3689830, 6114450);
-- Q0395 [OK_PREP]
SELECT * FROM "MARKETS" WHERE "CITY_ID" = ? LIMIT 50;
-- Q0396 [OK]
DELETE FROM "SALES_POSITIONS" WHERE "SALES_ID" = 2314322;
-- Q0397 [OK]
SELECT M."MARKET_ID", C."COUNTRY_CODE", M."POPULATION" FROM "MARKETS" M LEFT JOIN "CITIES" C ON C."CITY_ID" = M."CITY_ID" LIMIT 200;
-- Q0398 [OK]
MERGE INTO "MARKETS" T
USING (SELECT 5962004 AS MARKET_ID, 5809232 AS POPULATION) S
ON (T."MARKET_ID" = S.MARKET_ID)
WHEN MATCHED THEN UPDATE SET T."POPULATION" = S.POPULATION
WHEN NOT MATCHED THEN INSERT ("MARKET_ID","POPULATION") VALUES (S.MARKET_ID, S.POPULATION);
-- Q0399 [OK]
MERGE INTO "MARKETS" T
USING (SELECT 7993646 AS MARKET_ID, 4925944 AS POPULATION) S
ON (T."MARKET_ID" = S.MARKET_ID)
WHEN MATCHED THEN UPDATE SET T."POPULATION" = S.POPULATION
WHEN NOT MATCHED THEN INSERT ("MARKET_ID","POPULATION") VALUES (S.MARKET_ID, S.POPULATION);
-- Q0400 [OK]
UPDATE "MARKETS" SET "POPULATION" = 5012505 WHERE "MARKET_ID" = 1375804;
-- Q0401 [OK]
INSERT INTO "DIM_DATE" ("SALES_DATE") VALUES (DATE '2010-12-28');
-- Q0402 [OK]
INSERT INTO "MARKETS" ("MARKET_ID","POPULATION") VALUES (5887722, 896647);
-- Q0403 [OK_PREP]
INSERT INTO "DIM_DATE" ("SALES_DATE") VALUES (?);
-- Q0404 [OK]
INSERT INTO "DIM_DATE" ("SALES_DATE") VALUES (DATE '2013-09-23');
-- Q0405 [OK]
DELETE FROM "SALES_POSITIONS" WHERE "SALES_ID" = 2317173;
-- Q0406 [OK]
MERGE INTO "MARKETS" T
USING (SELECT 6244934 AS MARKET_ID, 1060046 AS POPULATION) S
ON (T."MARKET_ID" = S.MARKET_ID)
WHEN MATCHED THEN UPDATE SET T."POPULATION" = S.POPULATION
WHEN NOT MATCHED THEN INSERT ("MARKET_ID","POPULATION") VALUES (S.MARKET_ID, S.POPULATION);
-- Q0407 [OK]
SELECT "AREA_SHORT" FROM "CITIES" WHERE "AREA_SHORT" IS NOT NULL LIMIT 100;
-- Q0408 [OK]
INSERT INTO "MARKETS" ("MARKET_ID","POPULATION") VALUES (675984, 9513412);
-- Q0409 [OK]
SELECT
  S."MARKET_ID",
  S."SALES_DATE",
  S."SALES_ID",
  S."PRICE",
  SUM(S."PRICE") OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE") AS DAY_MARKET_REVENUE,
  ROW_NUMBER() OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE" ORDER BY S."PRICE" DESC NULLS LAST) AS RN
FROM "SALES" S
WHERE S."SALES_DATE" IS NOT NULL
QUALIFY RN <= 50
ORDER BY DAY_MARKET_REVENUE DESC NULLS LAST;
-- Q0410 [OK]
SELECT M."MARKET_ID", C."COUNTRY_CODE", M."POPULATION" FROM "MARKETS" M LEFT JOIN "CITIES" C ON C."CITY_ID" = M."CITY_ID" LIMIT 200;
-- Q0411 [OK]
DELETE FROM "SALES_POSITIONS" WHERE "SALES_ID" = 8781568;
-- Q0412 [OK]
UPDATE "MARKETS" SET "POPULATION" = 2517679 WHERE "MARKET_ID" = 194442;
-- Q0413 [OK]
INSERT INTO "MARKETS" ("MARKET_ID","POPULATION") VALUES (778639, 3547741);
-- Q0414 [OK]
INSERT INTO "DIM_DATE" ("SALES_DATE") VALUES (DATE '2014-11-08');
-- Q0415 [OK]
MERGE INTO "MARKETS" T
USING (SELECT 87791 AS MARKET_ID, 9145703 AS POPULATION) S
ON (T."MARKET_ID" = S.MARKET_ID)
WHEN MATCHED THEN UPDATE SET T."POPULATION" = S.POPULATION
WHEN NOT MATCHED THEN INSERT ("MARKET_ID","POPULATION") VALUES (S.MARKET_ID, S.POPULATION);
-- Q0416 [OK]
DELETE FROM "SALES_POSITIONS" WHERE "SALES_ID" = 2557923;
-- Q0417 [OK]
SELECT
  S."MARKET_ID",
  S."SALES_DATE",
  S."SALES_ID",
  S."PRICE",
  SUM(S."PRICE") OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE") AS DAY_MARKET_REVENUE,
  ROW_NUMBER() OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE" ORDER BY S."PRICE" DESC NULLS LAST) AS RN
FROM "SALES" S
WHERE S."SALES_DATE" IS NOT NULL
QUALIFY RN <= 50
ORDER BY DAY_MARKET_REVENUE DESC NULLS LAST;
-- Q0418 [OK_PREP]
INSERT INTO "MARKETS" ("MARKET_ID","POPULATION") VALUES (?, ?);
-- Q0419 [OK]
SELECT "EAN", "BASE_SALES_PRICE", "PRODUCT_GROUP_DESC", "TMP_OLD_NR" FROM "ARTICLE" LIMIT 100;
-- Q0420 [OK]
SELECT "LOYALTY_ID", "SALES_TIMESTAMP" FROM "SALES" LIMIT 100;
-- Q0421 [OK_PREP]
UPDATE "MARKETS" SET "POPULATION" = ? WHERE "MARKET_ID" = ?;
-- Q0422 [OK]
INSERT INTO "MARKETS" ("MARKET_ID","POPULATION") VALUES (6010086, 3054933);
-- Q0423 [FAIL]
UPDATE "UNKNOWN_TABLE" SET "X" = 1;
-- Q0424 [OK]
MERGE INTO "MARKETS" T
USING (SELECT 7715031 AS MARKET_ID, 5188957 AS POPULATION) S
ON (T."MARKET_ID" = S.MARKET_ID)
WHEN MATCHED THEN UPDATE SET T."POPULATION" = S.POPULATION
WHEN NOT MATCHED THEN INSERT ("MARKET_ID","POPULATION") VALUES (S.MARKET_ID, S.POPULATION);
-- Q0425 [FAIL]
SELECT CAST('abc' AS DECIMAL(18,0));
-- Q0426 [FAIL]
SELECT 1/0;
-- Q0427 [FAIL]
INSERT INTO "MARKETS" ("MARKET_ID","NOPE") VALUES (1,2);
-- Q0428 [OK]
SELECT
  S."MARKET_ID",
  S."SALES_DATE",
  S."SALES_ID",
  S."PRICE",
  SUM(S."PRICE") OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE") AS DAY_MARKET_REVENUE,
  ROW_NUMBER() OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE" ORDER BY S."PRICE" DESC NULLS LAST) AS RN
FROM "SALES" S
WHERE S."SALES_DATE" IS NOT NULL
QUALIFY RN <= 50
ORDER BY DAY_MARKET_REVENUE DESC NULLS LAST;
-- Q0429 [OK]
INSERT INTO "MARKETS" ("MARKET_ID","POPULATION") VALUES (3781736, 6106536);
-- Q0430 [OK_PREP]
UPDATE "MARKETS" SET "POPULATION" = ? WHERE "MARKET_ID" = ?;
-- Q0431 [OK]
INSERT INTO "DIM_DATE" ("SALES_DATE") VALUES (DATE '2019-02-05');
-- Q0432 [OK]
UPDATE "MARKETS" SET "POPULATION" = 5512551 WHERE "MARKET_ID" = 3816041;
-- Q0433 [OK]
INSERT INTO "DIM_DATE" ("SALES_DATE") VALUES (DATE '2018-01-10');
-- Q0434 [OK]
SELECT "EAN", "PRODUCT_CLASS", "PURCHASE_PRICE" FROM "ARTICLE" WHERE "PRODUCT_CLASS" IS NOT NULL;
-- Q0435 [OK]
DELETE FROM "SALES_POSITIONS" WHERE "SALES_ID" = 8470196;
-- Q0436 [OK]
DELETE FROM "SALES_POSITIONS" WHERE "SALES_ID" = 3354470;
-- Q0437 [OK]
MERGE INTO "MARKETS" T
USING (SELECT 8769045 AS MARKET_ID, 4256238 AS POPULATION) S
ON (T."MARKET_ID" = S.MARKET_ID)
WHEN MATCHED THEN UPDATE SET T."POPULATION" = S.POPULATION
WHEN NOT MATCHED THEN INSERT ("MARKET_ID","POPULATION") VALUES (S.MARKET_ID, S.POPULATION);
-- Q0438 [OK]
MERGE INTO "MARKETS" T
USING (SELECT 117265 AS MARKET_ID, 9466324 AS POPULATION) S
ON (T."MARKET_ID" = S.MARKET_ID)
WHEN MATCHED THEN UPDATE SET T."POPULATION" = S.POPULATION
WHEN NOT MATCHED THEN INSERT ("MARKET_ID","POPULATION") VALUES (S.MARKET_ID, S.POPULATION);
-- Q0439 [OK]
SELECT "SALES_DATE" FROM "DIM_DATE" LIMIT 100;
-- Q0440 [OK]
SELECT SP."SALES_ID", A."PRODUCT_GROUP", SUM(SP."AMOUNT") AS UNITS FROM "SALES_POSITIONS" SP JOIN "ARTICLE" A ON A."ARTICLE_ID" = SP."ARTICLE_ID" GROUP BY SP."SALES_ID", A."PRODUCT_GROUP" ORDER BY UNITS DESC NULLS LAST LIMIT 200;
-- Q0441 [OK]
SELECT SP."SALES_ID", A."PRODUCT_GROUP", SUM(SP."AMOUNT") AS UNITS FROM "SALES_POSITIONS" SP JOIN "ARTICLE" A ON A."ARTICLE_ID" = SP."ARTICLE_ID" GROUP BY SP."SALES_ID", A."PRODUCT_GROUP" ORDER BY UNITS DESC NULLS LAST LIMIT 200;
-- Q0442 [OK]
SELECT
  S."MARKET_ID",
  S."SALES_DATE",
  S."SALES_ID",
  S."PRICE",
  SUM(S."PRICE") OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE") AS DAY_MARKET_REVENUE,
  ROW_NUMBER() OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE" ORDER BY S."PRICE" DESC NULLS LAST) AS RN
FROM "SALES" S
WHERE S."SALES_DATE" IS NOT NULL
QUALIFY RN <= 50
ORDER BY DAY_MARKET_REVENUE DESC NULLS LAST;
-- Q0443 [OK]
SELECT "SALES_DATE" FROM "DIM_DATE";
-- Q0444 [FAIL]
SELECT TO_DATE('not-a-date', 'YYYY-MM-DD');
-- Q0445 [FAIL]
UPDATE "UNKNOWN_TABLE" SET "X" = 1;
-- Q0446 [OK_PREP]
INSERT INTO "MARKETS" ("MARKET_ID","POPULATION") VALUES (?, ?);
-- Q0447 [FAIL]
UPDATE "MARKETS" SET "NOT_A_COL" = 1 WHERE "MARKET_ID" = 1;
-- Q0448 [OK]
SELECT "LON", "CITY_NAME", "AREA" FROM "CITIES" WHERE "CITY_NAME" IS NOT NULL LIMIT 100;
-- Q0449 [OK_PREP]
MERGE INTO "MARKETS" T
USING (SELECT ? AS MARKET_ID, ? AS POPULATION) S
ON (T."MARKET_ID" = S.MARKET_ID)
WHEN MATCHED THEN UPDATE SET T."POPULATION" = S.POPULATION
WHEN NOT MATCHED THEN INSERT ("MARKET_ID","POPULATION") VALUES (S.MARKET_ID, S.POPULATION);
-- Q0450 [OK]
INSERT INTO "DIM_DATE" ("SALES_DATE") VALUES (DATE '2024-01-15');
-- Q0451 [OK]
UPDATE "MARKETS" SET "POPULATION" = 19953917 WHERE "MARKET_ID" = 9734623;
-- Q0452 [OK]
SELECT
  S."MARKET_ID",
  S."SALES_DATE",
  S."SALES_ID",
  S."PRICE",
  SUM(S."PRICE") OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE") AS DAY_MARKET_REVENUE,
  ROW_NUMBER() OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE" ORDER BY S."PRICE" DESC NULLS LAST) AS RN
FROM "SALES" S
WHERE S."SALES_DATE" IS NOT NULL
QUALIFY RN <= 50
ORDER BY DAY_MARKET_REVENUE DESC NULLS LAST;
-- Q0453 [OK]
MERGE INTO "MARKETS" T
USING (SELECT 6517526 AS MARKET_ID, 4939948 AS POPULATION) S
ON (T."MARKET_ID" = S.MARKET_ID)
WHEN MATCHED THEN UPDATE SET T."POPULATION" = S.POPULATION
WHEN NOT MATCHED THEN INSERT ("MARKET_ID","POPULATION") VALUES (S.MARKET_ID, S.POPULATION);
-- Q0454 [OK]
SELECT
  S."MARKET_ID",
  S."SALES_DATE",
  S."SALES_ID",
  S."PRICE",
  SUM(S."PRICE") OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE") AS DAY_MARKET_REVENUE,
  ROW_NUMBER() OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE" ORDER BY S."PRICE" DESC NULLS LAST) AS RN
FROM "SALES" S
WHERE S."SALES_DATE" IS NOT NULL
QUALIFY RN <= 50
ORDER BY DAY_MARKET_REVENUE DESC NULLS LAST;
-- Q0455 [OK]
SELECT
  S."MARKET_ID",
  S."SALES_DATE",
  S."SALES_ID",
  S."PRICE",
  SUM(S."PRICE") OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE") AS DAY_MARKET_REVENUE,
  ROW_NUMBER() OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE" ORDER BY S."PRICE" DESC NULLS LAST) AS RN
FROM "SALES" S
WHERE S."SALES_DATE" IS NOT NULL
QUALIFY RN <= 50
ORDER BY DAY_MARKET_REVENUE DESC NULLS LAST;
-- Q0456 [OK_PREP]
UPDATE "MARKETS" SET "POPULATION" = ? WHERE "MARKET_ID" = ?;
-- Q0457 [OK]
UPDATE "MARKETS" SET "POPULATION" = 16762490 WHERE "MARKET_ID" = 4410527;
-- Q0458 [OK]
SELECT SP."SALES_ID", A."PRODUCT_GROUP", SUM(SP."AMOUNT") AS UNITS FROM "SALES_POSITIONS" SP JOIN "ARTICLE" A ON A."ARTICLE_ID" = SP."ARTICLE_ID" GROUP BY SP."SALES_ID", A."PRODUCT_GROUP" ORDER BY UNITS DESC NULLS LAST LIMIT 200;
-- Q0459 [OK]
INSERT INTO "DIM_DATE" ("SALES_DATE") VALUES (DATE '2015-01-01');
-- Q0460 [OK]
SELECT SP."SALES_ID", A."PRODUCT_GROUP", SUM(SP."AMOUNT") AS UNITS FROM "SALES_POSITIONS" SP JOIN "ARTICLE" A ON A."ARTICLE_ID" = SP."ARTICLE_ID" GROUP BY SP."SALES_ID", A."PRODUCT_GROUP" ORDER BY UNITS DESC NULLS LAST LIMIT 200;
-- Q0461 [OK]
UPDATE "MARKETS" SET "POPULATION" = 6841994 WHERE "MARKET_ID" = 990509;
-- Q0462 [OK]
SELECT S."SALES_ID", S."SALES_DATE", SP."ARTICLE_ID", SP."AMOUNT" FROM "SALES" S JOIN "SALES_POSITIONS" SP ON SP."SALES_ID" = S."SALES_ID" LIMIT 200;
-- Q0463 [OK]
MERGE INTO "MARKETS" T
USING (SELECT 9285930 AS MARKET_ID, 9750194 AS POPULATION) S
ON (T."MARKET_ID" = S.MARKET_ID)
WHEN MATCHED THEN UPDATE SET T."POPULATION" = S.POPULATION
WHEN NOT MATCHED THEN INSERT ("MARKET_ID","POPULATION") VALUES (S.MARKET_ID, S.POPULATION);
-- Q0464 [OK]
DELETE FROM "SALES_POSITIONS" WHERE "SALES_ID" = 8058469;
-- Q0465 [OK]
SELECT SP."SALES_ID", A."PRODUCT_GROUP", SUM(SP."AMOUNT") AS UNITS FROM "SALES_POSITIONS" SP JOIN "ARTICLE" A ON A."ARTICLE_ID" = SP."ARTICLE_ID" GROUP BY SP."SALES_ID", A."PRODUCT_GROUP" ORDER BY UNITS DESC NULLS LAST LIMIT 200;
-- Q0466 [OK]
SELECT S."SALES_ID", S."SALES_DATE", SP."ARTICLE_ID", SP."AMOUNT" FROM "SALES" S JOIN "SALES_POSITIONS" SP ON SP."SALES_ID" = S."SALES_ID" LIMIT 200;
-- Q0467 [OK_PREP]
INSERT INTO "MARKETS" ("MARKET_ID","POPULATION") VALUES (?, ?);
-- Q0468 [OK]
INSERT INTO "DIM_DATE" ("SALES_DATE") VALUES (DATE '2019-08-05');
-- Q0469 [OK]
UPDATE "MARKETS" SET "POPULATION" = 9393546 WHERE "MARKET_ID" = 9403173;
-- Q0470 [FAIL]
SELECT 1/0;
-- Q0471 [OK]
INSERT INTO "MARKETS" ("MARKET_ID","POPULATION") VALUES (9812804, 1935988);
-- Q0472 [OK]
INSERT INTO "MARKETS" ("MARKET_ID","POPULATION") VALUES (1586125, 7438295);
-- Q0473 [OK]
MERGE INTO "MARKETS" T
USING (SELECT 4147378 AS MARKET_ID, 8785144 AS POPULATION) S
ON (T."MARKET_ID" = S.MARKET_ID)
WHEN MATCHED THEN UPDATE SET T."POPULATION" = S.POPULATION
WHEN NOT MATCHED THEN INSERT ("MARKET_ID","POPULATION") VALUES (S.MARKET_ID, S.POPULATION);
-- Q0474 [OK]
INSERT INTO "DIM_DATE" ("SALES_DATE") VALUES (DATE '2013-02-09');
-- Q0475 [OK]
SELECT SP."SALES_ID", A."PRODUCT_GROUP", SUM(SP."AMOUNT") AS UNITS FROM "SALES_POSITIONS" SP JOIN "ARTICLE" A ON A."ARTICLE_ID" = SP."ARTICLE_ID" GROUP BY SP."SALES_ID", A."PRODUCT_GROUP" ORDER BY UNITS DESC NULLS LAST LIMIT 200;
-- Q0476 [OK_PREP]
INSERT INTO "DIM_DATE" ("SALES_DATE") VALUES (?);
-- Q0477 [OK]
UPDATE "MARKETS" SET "POPULATION" = 1295394 WHERE "MARKET_ID" = 5211958;
-- Q0478 [OK]
SELECT SP."SALES_ID", A."PRODUCT_GROUP", SUM(SP."AMOUNT") AS UNITS FROM "SALES_POSITIONS" SP JOIN "ARTICLE" A ON A."ARTICLE_ID" = SP."ARTICLE_ID" GROUP BY SP."SALES_ID", A."PRODUCT_GROUP" ORDER BY UNITS DESC NULLS LAST LIMIT 200;
-- Q0479 [OK_PREP]
INSERT INTO "MARKETS" ("MARKET_ID","POPULATION") VALUES (?, ?);
-- Q0480 [OK_PREP]
MERGE INTO "MARKETS" T
USING (SELECT ? AS MARKET_ID, ? AS POPULATION) S
ON (T."MARKET_ID" = S.MARKET_ID)
WHEN MATCHED THEN UPDATE SET T."POPULATION" = S.POPULATION
WHEN NOT MATCHED THEN INSERT ("MARKET_ID","POPULATION") VALUES (S.MARKET_ID, S.POPULATION);
-- Q0481 [OK]
MERGE INTO "MARKETS" T
USING (SELECT 5371278 AS MARKET_ID, 253704 AS POPULATION) S
ON (T."MARKET_ID" = S.MARKET_ID)
WHEN MATCHED THEN UPDATE SET T."POPULATION" = S.POPULATION
WHEN NOT MATCHED THEN INSERT ("MARKET_ID","POPULATION") VALUES (S.MARKET_ID, S.POPULATION);
-- Q0482 [OK]
MERGE INTO "MARKETS" T
USING (SELECT 8535038 AS MARKET_ID, 1410051 AS POPULATION) S
ON (T."MARKET_ID" = S.MARKET_ID)
WHEN MATCHED THEN UPDATE SET T."POPULATION" = S.POPULATION
WHEN NOT MATCHED THEN INSERT ("MARKET_ID","POPULATION") VALUES (S.MARKET_ID, S.POPULATION);
-- Q0483 [OK_PREP]
SELECT * FROM "ARTICLE" WHERE "ARTICLE_ID" = ?;
-- Q0484 [OK]
MERGE INTO "MARKETS" T
USING (SELECT 44851 AS MARKET_ID, 8919842 AS POPULATION) S
ON (T."MARKET_ID" = S.MARKET_ID)
WHEN MATCHED THEN UPDATE SET T."POPULATION" = S.POPULATION
WHEN NOT MATCHED THEN INSERT ("MARKET_ID","POPULATION") VALUES (S.MARKET_ID, S.POPULATION);
-- Q0485 [OK]
SELECT "AREA_SHORT", "AREA", "LAT", "COUNTRY_CODE" FROM "CITIES" WHERE "COUNTRY_CODE" IS NOT NULL;
-- Q0486 [OK]
INSERT INTO "DIM_DATE" ("SALES_DATE") VALUES (DATE '2020-09-09');
-- Q0487 [OK]
SELECT M."MARKET_ID", C."COUNTRY_CODE", M."POPULATION" FROM "MARKETS" M LEFT JOIN "CITIES" C ON C."CITY_ID" = M."CITY_ID" LIMIT 200;
-- Q0488 [OK]
MERGE INTO "MARKETS" T
USING (SELECT 1254539 AS MARKET_ID, 383776 AS POPULATION) S
ON (T."MARKET_ID" = S.MARKET_ID)
WHEN MATCHED THEN UPDATE SET T."POPULATION" = S.POPULATION
WHEN NOT MATCHED THEN INSERT ("MARKET_ID","POPULATION") VALUES (S.MARKET_ID, S.POPULATION);
-- Q0489 [OK]
UPDATE "MARKETS" SET "POPULATION" = 14240478 WHERE "MARKET_ID" = 2136921;
-- Q0490 [OK]
SELECT M."MARKET_ID", C."COUNTRY_CODE", M."POPULATION" FROM "MARKETS" M LEFT JOIN "CITIES" C ON C."CITY_ID" = M."CITY_ID" LIMIT 200;
-- Q0491 [OK]
SELECT SP."SALES_ID", A."PRODUCT_GROUP", SUM(SP."AMOUNT") AS UNITS FROM "SALES_POSITIONS" SP JOIN "ARTICLE" A ON A."ARTICLE_ID" = SP."ARTICLE_ID" GROUP BY SP."SALES_ID", A."PRODUCT_GROUP" ORDER BY UNITS DESC NULLS LAST LIMIT 200;
-- Q0492 [OK]
SELECT
  S."MARKET_ID",
  S."SALES_DATE",
  S."SALES_ID",
  S."PRICE",
  SUM(S."PRICE") OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE") AS DAY_MARKET_REVENUE,
  ROW_NUMBER() OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE" ORDER BY S."PRICE" DESC NULLS LAST) AS RN
FROM "SALES" S
WHERE S."SALES_DATE" IS NOT NULL
QUALIFY RN <= 50
ORDER BY DAY_MARKET_REVENUE DESC NULLS LAST;
-- Q0493 [OK]
SELECT SP."SALES_ID", A."PRODUCT_GROUP", SUM(SP."AMOUNT") AS UNITS FROM "SALES_POSITIONS" SP JOIN "ARTICLE" A ON A."ARTICLE_ID" = SP."ARTICLE_ID" GROUP BY SP."SALES_ID", A."PRODUCT_GROUP" ORDER BY UNITS DESC NULLS LAST LIMIT 200;
-- Q0494 [OK]
MERGE INTO "MARKETS" T
USING (SELECT 1106418 AS MARKET_ID, 9148729 AS POPULATION) S
ON (T."MARKET_ID" = S.MARKET_ID)
WHEN MATCHED THEN UPDATE SET T."POPULATION" = S.POPULATION
WHEN NOT MATCHED THEN INSERT ("MARKET_ID","POPULATION") VALUES (S.MARKET_ID, S.POPULATION);
-- Q0495 [OK]
MERGE INTO "MARKETS" T
USING (SELECT 6672647 AS MARKET_ID, 7755372 AS POPULATION) S
ON (T."MARKET_ID" = S.MARKET_ID)
WHEN MATCHED THEN UPDATE SET T."POPULATION" = S.POPULATION
WHEN NOT MATCHED THEN INSERT ("MARKET_ID","POPULATION") VALUES (S.MARKET_ID, S.POPULATION);
-- Q0496 [OK]
MERGE INTO "MARKETS" T
USING (SELECT 9450963 AS MARKET_ID, 8681383 AS POPULATION) S
ON (T."MARKET_ID" = S.MARKET_ID)
WHEN MATCHED THEN UPDATE SET T."POPULATION" = S.POPULATION
WHEN NOT MATCHED THEN INSERT ("MARKET_ID","POPULATION") VALUES (S.MARKET_ID, S.POPULATION);
-- Q0497 [OK]
SELECT "SALES_DATE", "EMPLOYEE_ID" FROM "SALES" LIMIT 100;
-- Q0498 [OK]
SELECT S."SALES_ID", S."SALES_DATE", SP."ARTICLE_ID", SP."AMOUNT" FROM "SALES" S JOIN "SALES_POSITIONS" SP ON SP."SALES_ID" = S."SALES_ID" LIMIT 200;
-- Q0499 [OK]
UPDATE "MARKETS" SET "POPULATION" = 14445365 WHERE "MARKET_ID" = 7436945;
-- Q0500 [OK]
SELECT SP."SALES_ID", A."PRODUCT_GROUP", SUM(SP."AMOUNT") AS UNITS FROM "SALES_POSITIONS" SP JOIN "ARTICLE" A ON A."ARTICLE_ID" = SP."ARTICLE_ID" GROUP BY SP."SALES_ID", A."PRODUCT_GROUP" ORDER BY UNITS DESC NULLS LAST LIMIT 200;
-- Q0501 [OK]
MERGE INTO "MARKETS" T
USING (SELECT 1947798 AS MARKET_ID, 9389212 AS POPULATION) S
ON (T."MARKET_ID" = S.MARKET_ID)
WHEN MATCHED THEN UPDATE SET T."POPULATION" = S.POPULATION
WHEN NOT MATCHED THEN INSERT ("MARKET_ID","POPULATION") VALUES (S.MARKET_ID, S.POPULATION);
-- Q0502 [OK]
DELETE FROM "SALES_POSITIONS" WHERE "SALES_ID" = 2008670;
-- Q0503 [OK]
DELETE FROM "SALES_POSITIONS" WHERE "SALES_ID" = 4077393;
-- Q0504 [OK]
SELECT "EMPLOYEE_ID", "TERMINAL_DAILY_SALES_NR" FROM "SALES" LIMIT 100;
-- Q0505 [OK]
INSERT INTO "DIM_DATE" ("SALES_DATE") VALUES (DATE '2020-02-11');
-- Q0506 [OK]
MERGE INTO "MARKETS" T
USING (SELECT 1313283 AS MARKET_ID, 28704 AS POPULATION) S
ON (T."MARKET_ID" = S.MARKET_ID)
WHEN MATCHED THEN UPDATE SET T."POPULATION" = S.POPULATION
WHEN NOT MATCHED THEN INSERT ("MARKET_ID","POPULATION") VALUES (S.MARKET_ID, S.POPULATION);
-- Q0507 [OK]
SELECT "MONEY_GIVEN", "TERMINAL_ID", "SALES_ID" FROM "SALES" WHERE "MONEY_GIVEN" IS NOT NULL;
-- Q0508 [OK_PREP]
INSERT INTO "MARKETS" ("MARKET_ID","POPULATION") VALUES (?, ?);
-- Q0509 [OK]
INSERT INTO "MARKETS" ("MARKET_ID","POPULATION") VALUES (2538084, 2596103);
-- Q0510 [OK]
SELECT "AMOUNT", "VOUCHER_ID", "CANCELED" FROM "SALES_POSITIONS" WHERE "AMOUNT" IS NOT NULL;
-- Q0511 [OK]
MERGE INTO "MARKETS" T
USING (SELECT 4028166 AS MARKET_ID, 4475745 AS POPULATION) S
ON (T."MARKET_ID" = S.MARKET_ID)
WHEN MATCHED THEN UPDATE SET T."POPULATION" = S.POPULATION
WHEN NOT MATCHED THEN INSERT ("MARKET_ID","POPULATION") VALUES (S.MARKET_ID, S.POPULATION);
-- Q0512 [FAIL]
SELECT * FROM "SALESX" LIMIT 10;
-- Q0513 [OK]
UPDATE "MARKETS" SET "POPULATION" = 2088644 WHERE "MARKET_ID" = 9087734;
-- Q0514 [OK]
MERGE INTO "MARKETS" T
USING (SELECT 492293 AS MARKET_ID, 8728640 AS POPULATION) S
ON (T."MARKET_ID" = S.MARKET_ID)
WHEN MATCHED THEN UPDATE SET T."POPULATION" = S.POPULATION
WHEN NOT MATCHED THEN INSERT ("MARKET_ID","POPULATION") VALUES (S.MARKET_ID, S.POPULATION);
-- Q0515 [OK]
UPDATE "MARKETS" SET "POPULATION" = 7486369 WHERE "MARKET_ID" = 662704;
-- Q0516 [OK]
INSERT INTO "MARKETS" ("MARKET_ID","POPULATION") VALUES (370965, 9765108);
-- Q0517 [FAIL]
DELETEE FROM "SALES";
-- Q0518 [OK]
SELECT
  S."MARKET_ID",
  S."SALES_DATE",
  S."SALES_ID",
  S."PRICE",
  SUM(S."PRICE") OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE") AS DAY_MARKET_REVENUE,
  ROW_NUMBER() OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE" ORDER BY S."PRICE" DESC NULLS LAST) AS RN
FROM "SALES" S
WHERE S."SALES_DATE" IS NOT NULL
QUALIFY RN <= 50
ORDER BY DAY_MARKET_REVENUE DESC NULLS LAST;
-- Q0519 [OK]
SELECT SP."SALES_ID", A."PRODUCT_GROUP", SUM(SP."AMOUNT") AS UNITS FROM "SALES_POSITIONS" SP JOIN "ARTICLE" A ON A."ARTICLE_ID" = SP."ARTICLE_ID" GROUP BY SP."SALES_ID", A."PRODUCT_GROUP" ORDER BY UNITS DESC NULLS LAST LIMIT 200;
-- Q0520 [OK]
SELECT "LAT", "LON" FROM "CITIES" LIMIT 100;
-- Q0521 [OK]
SELECT "TERMINAL_ID" FROM "SALES" WHERE "TERMINAL_ID" IS NOT NULL;
-- Q0522 [OK]
INSERT INTO "MARKETS" ("MARKET_ID","POPULATION") VALUES (6897978, 5562196);
-- Q0523 [FAIL]
DELETE FROM "UNKNOWN_TABLE" WHERE 1=1;
-- Q0524 [OK]
UPDATE "MARKETS" SET "POPULATION" = 19264074 WHERE "MARKET_ID" = 8551038;
-- Q0525 [OK]
INSERT INTO "DIM_DATE" ("SALES_DATE") VALUES (DATE '2013-08-07');
-- Q0526 [OK]
UPDATE "MARKETS" SET "POPULATION" = 19389699 WHERE "MARKET_ID" = 3841368;
-- Q0527 [OK_PREP]
MERGE INTO "MARKETS" T
USING (SELECT ? AS MARKET_ID, ? AS POPULATION) S
ON (T."MARKET_ID" = S.MARKET_ID)
WHEN MATCHED THEN UPDATE SET T."POPULATION" = S.POPULATION
WHEN NOT MATCHED THEN INSERT ("MARKET_ID","POPULATION") VALUES (S.MARKET_ID, S.POPULATION);
-- Q0528 [OK]
UPDATE "MARKETS" SET "POPULATION" = 228176 WHERE "MARKET_ID" = 3977002;
-- Q0529 [OK]
INSERT INTO "MARKETS" ("MARKET_ID","POPULATION") VALUES (9138253, 4621686);
-- Q0530 [OK]
UPDATE "MARKETS" SET "POPULATION" = 9954306 WHERE "MARKET_ID" = 9310850;
-- Q0531 [FAIL]
SELECT M."MARKET_ID" FROM "MARKETS" M WHERE M."CITY_NAME" IS NOT NULL;
-- Q0532 [OK]
INSERT INTO "MARKETS" ("MARKET_ID","POPULATION") VALUES (6464761, 5685221);
-- Q0533 [OK]
SELECT "AREA", "LAT", "AREA_SHORT", "ZIP_CODE" FROM "CITIES";
-- Q0534 [OK]
INSERT INTO "DIM_DATE" ("SALES_DATE") VALUES (DATE '2012-11-18');
-- Q0535 [OK]
INSERT INTO "MARKETS" ("MARKET_ID","POPULATION") VALUES (8029214, 1627359);
-- Q0536 [OK]
SELECT
  S."MARKET_ID",
  S."SALES_DATE",
  S."SALES_ID",
  S."PRICE",
  SUM(S."PRICE") OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE") AS DAY_MARKET_REVENUE,
  ROW_NUMBER() OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE" ORDER BY S."PRICE" DESC NULLS LAST) AS RN
FROM "SALES" S
WHERE S."SALES_DATE" IS NOT NULL
QUALIFY RN <= 50
ORDER BY DAY_MARKET_REVENUE DESC NULLS LAST;
-- Q0537 [FAIL]
SELECT CAST('abc' AS DECIMAL(18,0));
-- Q0538 [OK]
INSERT INTO "DIM_DATE" ("SALES_DATE") VALUES (DATE '2010-09-21');
-- Q0539 [OK]
MERGE INTO "MARKETS" T
USING (SELECT 2859381 AS MARKET_ID, 7020505 AS POPULATION) S
ON (T."MARKET_ID" = S.MARKET_ID)
WHEN MATCHED THEN UPDATE SET T."POPULATION" = S.POPULATION
WHEN NOT MATCHED THEN INSERT ("MARKET_ID","POPULATION") VALUES (S.MARKET_ID, S.POPULATION);
-- Q0540 [OK]
INSERT INTO "MARKETS" ("MARKET_ID","POPULATION") VALUES (8574540, 760412);
-- Q0541 [OK]
INSERT INTO "DIM_DATE" ("SALES_DATE") VALUES (DATE '2008-01-27');
-- Q0542 [OK]
MERGE INTO "MARKETS" T
USING (SELECT 5351907 AS MARKET_ID, 5261868 AS POPULATION) S
ON (T."MARKET_ID" = S.MARKET_ID)
WHEN MATCHED THEN UPDATE SET T."POPULATION" = S.POPULATION
WHEN NOT MATCHED THEN INSERT ("MARKET_ID","POPULATION") VALUES (S.MARKET_ID, S.POPULATION);
-- Q0543 [OK]
DELETE FROM "SALES_POSITIONS" WHERE "SALES_ID" = 767747;
-- Q0544 [FAIL]
SELECT M."MARKET_ID" FROM "MARKETS" M WHERE M."CITY_NAME" IS NOT NULL;
-- Q0545 [OK]
DELETE FROM "SALES_POSITIONS" WHERE "SALES_ID" = 2281753;
-- Q0546 [OK]
UPDATE "MARKETS" SET "POPULATION" = 3015407 WHERE "MARKET_ID" = 3519704;
-- Q0547 [OK]
INSERT INTO "MARKETS" ("MARKET_ID","POPULATION") VALUES (7121718, 6166673);
-- Q0548 [OK]
SELECT
  S."MARKET_ID",
  S."SALES_DATE",
  S."SALES_ID",
  S."PRICE",
  SUM(S."PRICE") OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE") AS DAY_MARKET_REVENUE,
  ROW_NUMBER() OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE" ORDER BY S."PRICE" DESC NULLS LAST) AS RN
FROM "SALES" S
WHERE S."SALES_DATE" IS NOT NULL
QUALIFY RN <= 50
ORDER BY DAY_MARKET_REVENUE DESC NULLS LAST;
-- Q0549 [OK]
INSERT INTO "DIM_DATE" ("SALES_DATE") VALUES (DATE '2011-08-09');
-- Q0550 [OK]
SELECT "POPULATION" FROM "MARKETS" WHERE "POPULATION" IS NOT NULL;
-- Q0551 [OK_PREP]
INSERT INTO "MARKETS" ("MARKET_ID","POPULATION") VALUES (?, ?);
-- Q0552 [OK]
SELECT S."SALES_ID", S."SALES_DATE", SP."ARTICLE_ID", SP."AMOUNT" FROM "SALES" S JOIN "SALES_POSITIONS" SP ON SP."SALES_ID" = S."SALES_ID" LIMIT 200;
-- Q0553 [OK]
MERGE INTO "MARKETS" T
USING (SELECT 1701510 AS MARKET_ID, 6368551 AS POPULATION) S
ON (T."MARKET_ID" = S.MARKET_ID)
WHEN MATCHED THEN UPDATE SET T."POPULATION" = S.POPULATION
WHEN NOT MATCHED THEN INSERT ("MARKET_ID","POPULATION") VALUES (S.MARKET_ID, S.POPULATION);
-- Q0554 [OK]
SELECT M."MARKET_ID", C."COUNTRY_CODE", M."POPULATION" FROM "MARKETS" M LEFT JOIN "CITIES" C ON C."CITY_ID" = M."CITY_ID" LIMIT 200;
-- Q0555 [OK]
SELECT "POPULATION", "AREA", "POSTAL_CODE", "LONGITUDE" FROM "MARKETS" LIMIT 100;
-- Q0556 [OK]
SELECT
  S."MARKET_ID",
  S."SALES_DATE",
  S."SALES_ID",
  S."PRICE",
  SUM(S."PRICE") OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE") AS DAY_MARKET_REVENUE,
  ROW_NUMBER() OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE" ORDER BY S."PRICE" DESC NULLS LAST) AS RN
FROM "SALES" S
WHERE S."SALES_DATE" IS NOT NULL
QUALIFY RN <= 50
ORDER BY DAY_MARKET_REVENUE DESC NULLS LAST;
-- Q0557 [OK]
UPDATE "MARKETS" SET "POPULATION" = 15971280 WHERE "MARKET_ID" = 5167888;
-- Q0558 [OK]
INSERT INTO "DIM_DATE" ("SALES_DATE") VALUES (DATE '2023-01-03');
-- Q0559 [OK]
SELECT
  S."MARKET_ID",
  S."SALES_DATE",
  S."SALES_ID",
  S."PRICE",
  SUM(S."PRICE") OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE") AS DAY_MARKET_REVENUE,
  ROW_NUMBER() OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE" ORDER BY S."PRICE" DESC NULLS LAST) AS RN
FROM "SALES" S
WHERE S."SALES_DATE" IS NOT NULL
QUALIFY RN <= 50
ORDER BY DAY_MARKET_REVENUE DESC NULLS LAST;
-- Q0560 [OK]
MERGE INTO "MARKETS" T
USING (SELECT 647816 AS MARKET_ID, 47735 AS POPULATION) S
ON (T."MARKET_ID" = S.MARKET_ID)
WHEN MATCHED THEN UPDATE SET T."POPULATION" = S.POPULATION
WHEN NOT MATCHED THEN INSERT ("MARKET_ID","POPULATION") VALUES (S.MARKET_ID, S.POPULATION);
-- Q0561 [OK]
SELECT
  S."MARKET_ID",
  S."SALES_DATE",
  S."SALES_ID",
  S."PRICE",
  SUM(S."PRICE") OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE") AS DAY_MARKET_REVENUE,
  ROW_NUMBER() OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE" ORDER BY S."PRICE" DESC NULLS LAST) AS RN
FROM "SALES" S
WHERE S."SALES_DATE" IS NOT NULL
QUALIFY RN <= 50
ORDER BY DAY_MARKET_REVENUE DESC NULLS LAST;
-- Q0562 [OK_PREP]
INSERT INTO "MARKETS" ("MARKET_ID","POPULATION") VALUES (?, ?);
-- Q0563 [OK]
UPDATE "MARKETS" SET "POPULATION" = 17898261 WHERE "MARKET_ID" = 1227693;
-- Q0564 [OK]
SELECT "PURCHASE_PRICE", "PRODUCT_GROUP_DESC" FROM "ARTICLE" WHERE "PURCHASE_PRICE" IS NOT NULL;
-- Q0565 [OK_PREP]
SELECT * FROM "ARTICLE" WHERE "ARTICLE_ID" = ?;
-- Q0566 [OK_PREP]
MERGE INTO "MARKETS" T
USING (SELECT ? AS MARKET_ID, ? AS POPULATION) S
ON (T."MARKET_ID" = S.MARKET_ID)
WHEN MATCHED THEN UPDATE SET T."POPULATION" = S.POPULATION
WHEN NOT MATCHED THEN INSERT ("MARKET_ID","POPULATION") VALUES (S.MARKET_ID, S.POPULATION);
-- Q0567 [FAIL]
SELEC COUNT(*) FROM "SALES";
-- Q0568 [OK]
SELECT SP."SALES_ID", A."PRODUCT_GROUP", SUM(SP."AMOUNT") AS UNITS FROM "SALES_POSITIONS" SP JOIN "ARTICLE" A ON A."ARTICLE_ID" = SP."ARTICLE_ID" GROUP BY SP."SALES_ID", A."PRODUCT_GROUP" ORDER BY UNITS DESC NULLS LAST LIMIT 200;
-- Q0569 [FAIL]
SELECT TO_DATE('not-a-date', 'YYYY-MM-DD');
-- Q0570 [OK]
DELETE FROM "SALES_POSITIONS" WHERE "SALES_ID" = 500135;
-- Q0571 [OK]
SELECT S."SALES_ID", S."SALES_DATE", SP."ARTICLE_ID", SP."AMOUNT" FROM "SALES" S JOIN "SALES_POSITIONS" SP ON SP."SALES_ID" = S."SALES_ID" LIMIT 200;
-- Q0572 [OK]
SELECT "SALES_DATE" FROM "DIM_DATE" WHERE "SALES_DATE" IS NOT NULL LIMIT 100;
-- Q0573 [OK]
INSERT INTO "MARKETS" ("MARKET_ID","POPULATION") VALUES (9258436, 9916592);
-- Q0574 [OK]
MERGE INTO "MARKETS" T
USING (SELECT 4713689 AS MARKET_ID, 3154956 AS POPULATION) S
ON (T."MARKET_ID" = S.MARKET_ID)
WHEN MATCHED THEN UPDATE SET T."POPULATION" = S.POPULATION
WHEN NOT MATCHED THEN INSERT ("MARKET_ID","POPULATION") VALUES (S.MARKET_ID, S.POPULATION);
-- Q0575 [OK]
SELECT "POSTAL_CODE", "CITY", "MARKET_ID" FROM "MARKETS" LIMIT 100;
-- Q0576 [FAIL]
SELECT M."MARKET_ID" FROM "MARKETS" M WHERE M."CITY_NAME" IS NOT NULL;
-- Q0577 [OK]
SELECT "RETURNED_CHANGE", "TERMINAL_DAILY_SALES_NR", "SALES_TIMESTAMP", "EMPLOYEE_ID" FROM "SALES" LIMIT 100;
-- Q0578 [OK]
SELECT "SALES_DATE" FROM "DIM_DATE" WHERE "SALES_DATE" IS NOT NULL LIMIT 100;
-- Q0579 [OK_PREP]
INSERT INTO "DIM_DATE" ("SALES_DATE") VALUES (?);
-- Q0580 [FAIL]
UPDATE "MARKETS" SET "NOT_A_COL" = 1 WHERE "MARKET_ID" = 1;
-- Q0581 [OK]
DELETE FROM "SALES_POSITIONS" WHERE "SALES_ID" = 1642486;
-- Q0582 [OK]
DELETE FROM "SALES_POSITIONS" WHERE "SALES_ID" = 9790226;
-- Q0583 [OK]
SELECT M."MARKET_ID", C."COUNTRY_CODE", M."POPULATION" FROM "MARKETS" M LEFT JOIN "CITIES" C ON C."CITY_ID" = M."CITY_ID" LIMIT 200;
-- Q0584 [OK]
SELECT
  S."MARKET_ID",
  S."SALES_DATE",
  S."SALES_ID",
  S."PRICE",
  SUM(S."PRICE") OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE") AS DAY_MARKET_REVENUE,
  ROW_NUMBER() OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE" ORDER BY S."PRICE" DESC NULLS LAST) AS RN
FROM "SALES" S
WHERE S."SALES_DATE" IS NOT NULL
QUALIFY RN <= 50
ORDER BY DAY_MARKET_REVENUE DESC NULLS LAST;
-- Q0585 [OK]
MERGE INTO "MARKETS" T
USING (SELECT 4649436 AS MARKET_ID, 6156497 AS POPULATION) S
ON (T."MARKET_ID" = S.MARKET_ID)
WHEN MATCHED THEN UPDATE SET T."POPULATION" = S.POPULATION
WHEN NOT MATCHED THEN INSERT ("MARKET_ID","POPULATION") VALUES (S.MARKET_ID, S.POPULATION);
-- Q0586 [OK]
SELECT SP."SALES_ID", A."PRODUCT_GROUP", SUM(SP."AMOUNT") AS UNITS FROM "SALES_POSITIONS" SP JOIN "ARTICLE" A ON A."ARTICLE_ID" = SP."ARTICLE_ID" GROUP BY SP."SALES_ID", A."PRODUCT_GROUP" ORDER BY UNITS DESC NULLS LAST LIMIT 200;
-- Q0587 [OK_PREP]
UPDATE "MARKETS" SET "POPULATION" = ? WHERE "MARKET_ID" = ?;
-- Q0588 [OK_PREP]
MERGE INTO "MARKETS" T
USING (SELECT ? AS MARKET_ID, ? AS POPULATION) S
ON (T."MARKET_ID" = S.MARKET_ID)
WHEN MATCHED THEN UPDATE SET T."POPULATION" = S.POPULATION
WHEN NOT MATCHED THEN INSERT ("MARKET_ID","POPULATION") VALUES (S.MARKET_ID, S.POPULATION);
-- Q0589 [OK]
INSERT INTO "DIM_DATE" ("SALES_DATE") VALUES (DATE '2005-09-13');
-- Q0590 [OK]
SELECT S."SALES_ID", S."SALES_DATE", SP."ARTICLE_ID", SP."AMOUNT" FROM "SALES" S JOIN "SALES_POSITIONS" SP ON SP."SALES_ID" = S."SALES_ID" LIMIT 200;
-- Q0591 [OK]
SELECT M."MARKET_ID", C."COUNTRY_CODE", M."POPULATION" FROM "MARKETS" M LEFT JOIN "CITIES" C ON C."CITY_ID" = M."CITY_ID" LIMIT 200;
-- Q0592 [FAIL]
SELECT CAST('abc' AS DECIMAL(18,0));
-- Q0593 [OK]
MERGE INTO "MARKETS" T
USING (SELECT 1830637 AS MARKET_ID, 3131457 AS POPULATION) S
ON (T."MARKET_ID" = S.MARKET_ID)
WHEN MATCHED THEN UPDATE SET T."POPULATION" = S.POPULATION
WHEN NOT MATCHED THEN INSERT ("MARKET_ID","POPULATION") VALUES (S.MARKET_ID, S.POPULATION);
-- Q0594 [OK_PREP]
INSERT INTO "MARKETS" ("MARKET_ID","POPULATION") VALUES (?, ?);
-- Q0595 [FAIL]
SELECT CAST('abc' AS DECIMAL(18,0));
-- Q0596 [OK]
MERGE INTO "MARKETS" T
USING (SELECT 7506990 AS MARKET_ID, 7776995 AS POPULATION) S
ON (T."MARKET_ID" = S.MARKET_ID)
WHEN MATCHED THEN UPDATE SET T."POPULATION" = S.POPULATION
WHEN NOT MATCHED THEN INSERT ("MARKET_ID","POPULATION") VALUES (S.MARKET_ID, S.POPULATION);
-- Q0597 [OK_PREP]
SELECT * FROM "MARKETS" WHERE "CITY_ID" = ? LIMIT 50;
-- Q0598 [OK]
UPDATE "MARKETS" SET "POPULATION" = 4700744 WHERE "MARKET_ID" = 568265;
-- Q0599 [OK]
SELECT S."SALES_ID", S."SALES_DATE", SP."ARTICLE_ID", SP."AMOUNT" FROM "SALES" S JOIN "SALES_POSITIONS" SP ON SP."SALES_ID" = S."SALES_ID" LIMIT 200;
-- Q0600 [FAIL]
SELECT * FROM "SALESX" LIMIT 10;
-- Q0601 [OK]
INSERT INTO "MARKETS" ("MARKET_ID","POPULATION") VALUES (3737443, 296194);
-- Q0602 [OK]
INSERT INTO "DIM_DATE" ("SALES_DATE") VALUES (DATE '2007-04-08');
-- Q0603 [FAIL]
DELETE FROM "UNKNOWN_TABLE" WHERE 1=1;
-- Q0604 [OK]
SELECT M."MARKET_ID", C."COUNTRY_CODE", M."POPULATION" FROM "MARKETS" M LEFT JOIN "CITIES" C ON C."CITY_ID" = M."CITY_ID" LIMIT 200;
-- Q0605 [OK]
SELECT M."MARKET_ID", C."COUNTRY_CODE", M."POPULATION" FROM "MARKETS" M LEFT JOIN "CITIES" C ON C."CITY_ID" = M."CITY_ID" LIMIT 200;
-- Q0606 [OK]
MERGE INTO "MARKETS" T
USING (SELECT 7982063 AS MARKET_ID, 4845082 AS POPULATION) S
ON (T."MARKET_ID" = S.MARKET_ID)
WHEN MATCHED THEN UPDATE SET T."POPULATION" = S.POPULATION
WHEN NOT MATCHED THEN INSERT ("MARKET_ID","POPULATION") VALUES (S.MARKET_ID, S.POPULATION);
-- Q0607 [OK]
DELETE FROM "SALES_POSITIONS" WHERE "SALES_ID" = 534694;
-- Q0608 [OK]
SELECT
  S."MARKET_ID",
  S."SALES_DATE",
  S."SALES_ID",
  S."PRICE",
  SUM(S."PRICE") OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE") AS DAY_MARKET_REVENUE,
  ROW_NUMBER() OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE" ORDER BY S."PRICE" DESC NULLS LAST) AS RN
FROM "SALES" S
WHERE S."SALES_DATE" IS NOT NULL
QUALIFY RN <= 50
ORDER BY DAY_MARKET_REVENUE DESC NULLS LAST;
-- Q0609 [OK]
INSERT INTO "DIM_DATE" ("SALES_DATE") VALUES (DATE '2024-08-28');
-- Q0610 [OK]
SELECT
  S."MARKET_ID",
  S."SALES_DATE",
  S."SALES_ID",
  S."PRICE",
  SUM(S."PRICE") OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE") AS DAY_MARKET_REVENUE,
  ROW_NUMBER() OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE" ORDER BY S."PRICE" DESC NULLS LAST) AS RN
FROM "SALES" S
WHERE S."SALES_DATE" IS NOT NULL
QUALIFY RN <= 50
ORDER BY DAY_MARKET_REVENUE DESC NULLS LAST;
-- Q0611 [FAIL]
SELECT CAST('abc' AS DECIMAL(18,0));
-- Q0612 [OK]
SELECT
  S."MARKET_ID",
  S."SALES_DATE",
  S."SALES_ID",
  S."PRICE",
  SUM(S."PRICE") OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE") AS DAY_MARKET_REVENUE,
  ROW_NUMBER() OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE" ORDER BY S."PRICE" DESC NULLS LAST) AS RN
FROM "SALES" S
WHERE S."SALES_DATE" IS NOT NULL
QUALIFY RN <= 50
ORDER BY DAY_MARKET_REVENUE DESC NULLS LAST;
-- Q0613 [OK]
SELECT
  S."MARKET_ID",
  S."SALES_DATE",
  S."SALES_ID",
  S."PRICE",
  SUM(S."PRICE") OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE") AS DAY_MARKET_REVENUE,
  ROW_NUMBER() OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE" ORDER BY S."PRICE" DESC NULLS LAST) AS RN
FROM "SALES" S
WHERE S."SALES_DATE" IS NOT NULL
QUALIFY RN <= 50
ORDER BY DAY_MARKET_REVENUE DESC NULLS LAST;
-- Q0614 [OK]
INSERT INTO "DIM_DATE" ("SALES_DATE") VALUES (DATE '2014-05-04');
-- Q0615 [OK]
UPDATE "MARKETS" SET "POPULATION" = 3668553 WHERE "MARKET_ID" = 585419;
-- Q0616 [OK]
UPDATE "MARKETS" SET "POPULATION" = 14682221 WHERE "MARKET_ID" = 4915826;
-- Q0617 [OK]
SELECT "LONGITUDE", "CITY_ID", "AREA" FROM "MARKETS" LIMIT 100;
-- Q0618 [OK_PREP]
MERGE INTO "MARKETS" T
USING (SELECT ? AS MARKET_ID, ? AS POPULATION) S
ON (T."MARKET_ID" = S.MARKET_ID)
WHEN MATCHED THEN UPDATE SET T."POPULATION" = S.POPULATION
WHEN NOT MATCHED THEN INSERT ("MARKET_ID","POPULATION") VALUES (S.MARKET_ID, S.POPULATION);
-- Q0619 [OK]
UPDATE "MARKETS" SET "POPULATION" = 5878877 WHERE "MARKET_ID" = 591443;
-- Q0620 [OK_PREP]
UPDATE "MARKETS" SET "POPULATION" = ? WHERE "MARKET_ID" = ?;
-- Q0621 [OK]
UPDATE "MARKETS" SET "POPULATION" = 17764026 WHERE "MARKET_ID" = 3510487;
-- Q0622 [OK]
DELETE FROM "SALES_POSITIONS" WHERE "SALES_ID" = 8708381;
-- Q0623 [OK]
INSERT INTO "DIM_DATE" ("SALES_DATE") VALUES (DATE '2017-08-02');
-- Q0624 [OK]
SELECT M."MARKET_ID", C."COUNTRY_CODE", M."POPULATION" FROM "MARKETS" M LEFT JOIN "CITIES" C ON C."CITY_ID" = M."CITY_ID" LIMIT 200;
-- Q0625 [OK]
INSERT INTO "MARKETS" ("MARKET_ID","POPULATION") VALUES (6136214, 3563909);
-- Q0626 [OK]
SELECT "POPULATION" FROM "MARKETS" LIMIT 100;
-- Q0627 [FAIL]
DELETEE FROM "SALES";
-- Q0628 [OK]
INSERT INTO "DIM_DATE" ("SALES_DATE") VALUES (DATE '2016-12-08');
-- Q0629 [OK]
DELETE FROM "SALES_POSITIONS" WHERE "SALES_ID" = 9511345;
-- Q0630 [OK]
SELECT
  S."MARKET_ID",
  S."SALES_DATE",
  S."SALES_ID",
  S."PRICE",
  SUM(S."PRICE") OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE") AS DAY_MARKET_REVENUE,
  ROW_NUMBER() OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE" ORDER BY S."PRICE" DESC NULLS LAST) AS RN
FROM "SALES" S
WHERE S."SALES_DATE" IS NOT NULL
QUALIFY RN <= 50
ORDER BY DAY_MARKET_REVENUE DESC NULLS LAST;
-- Q0631 [OK]
SELECT
  S."MARKET_ID",
  S."SALES_DATE",
  S."SALES_ID",
  S."PRICE",
  SUM(S."PRICE") OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE") AS DAY_MARKET_REVENUE,
  ROW_NUMBER() OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE" ORDER BY S."PRICE" DESC NULLS LAST) AS RN
FROM "SALES" S
WHERE S."SALES_DATE" IS NOT NULL
QUALIFY RN <= 50
ORDER BY DAY_MARKET_REVENUE DESC NULLS LAST;
-- Q0632 [OK_PREP]
INSERT INTO "DIM_DATE" ("SALES_DATE") VALUES (?);
-- Q0633 [OK]
SELECT
  S."MARKET_ID",
  S."SALES_DATE",
  S."SALES_ID",
  S."PRICE",
  SUM(S."PRICE") OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE") AS DAY_MARKET_REVENUE,
  ROW_NUMBER() OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE" ORDER BY S."PRICE" DESC NULLS LAST) AS RN
FROM "SALES" S
WHERE S."SALES_DATE" IS NOT NULL
QUALIFY RN <= 50
ORDER BY DAY_MARKET_REVENUE DESC NULLS LAST;
-- Q0634 [OK]
SELECT S."SALES_ID", S."SALES_DATE", SP."ARTICLE_ID", SP."AMOUNT" FROM "SALES" S JOIN "SALES_POSITIONS" SP ON SP."SALES_ID" = S."SALES_ID" LIMIT 200;
-- Q0635 [OK]
SELECT "SALES_DATE" FROM "SALES" WHERE "SALES_DATE" IS NOT NULL LIMIT 100;
-- Q0636 [OK]
SELECT "MARKET_ID", "SALES_DATE" FROM "SALES" WHERE "MARKET_ID" IS NOT NULL;
-- Q0637 [OK]
MERGE INTO "MARKETS" T
USING (SELECT 2923682 AS MARKET_ID, 7984787 AS POPULATION) S
ON (T."MARKET_ID" = S.MARKET_ID)
WHEN MATCHED THEN UPDATE SET T."POPULATION" = S.POPULATION
WHEN NOT MATCHED THEN INSERT ("MARKET_ID","POPULATION") VALUES (S.MARKET_ID, S.POPULATION);
-- Q0638 [OK_PREP]
UPDATE "MARKETS" SET "POPULATION" = ? WHERE "MARKET_ID" = ?;
-- Q0639 [OK]
INSERT INTO "MARKETS" ("MARKET_ID","POPULATION") VALUES (5421753, 5572898);
-- Q0640 [OK]
INSERT INTO "MARKETS" ("MARKET_ID","POPULATION") VALUES (3121963, 4354881);
-- Q0641 [OK]
DELETE FROM "SALES_POSITIONS" WHERE "SALES_ID" = 2910770;
-- Q0642 [OK]
SELECT S."SALES_ID", S."SALES_DATE", SP."ARTICLE_ID", SP."AMOUNT" FROM "SALES" S JOIN "SALES_POSITIONS" SP ON SP."SALES_ID" = S."SALES_ID" LIMIT 200;
-- Q0643 [FAIL]
SELECT CAST('abc' AS DECIMAL(18,0));
-- Q0644 [OK]
INSERT INTO "DIM_DATE" ("SALES_DATE") VALUES (DATE '2020-09-15');
-- Q0645 [OK]
DELETE FROM "SALES_POSITIONS" WHERE "SALES_ID" = 5441725;
-- Q0646 [OK]
DELETE FROM "SALES_POSITIONS" WHERE "SALES_ID" = 8496610;
-- Q0647 [OK]
SELECT "LON", "CITY_ID", "COUNTRY_CODE", "ZIP_CODE" FROM "CITIES" LIMIT 100;
-- Q0648 [OK]
SELECT "SALES_DATE" FROM "DIM_DATE" LIMIT 100;
-- Q0649 [OK]
SELECT
  S."MARKET_ID",
  S."SALES_DATE",
  S."SALES_ID",
  S."PRICE",
  SUM(S."PRICE") OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE") AS DAY_MARKET_REVENUE,
  ROW_NUMBER() OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE" ORDER BY S."PRICE" DESC NULLS LAST) AS RN
FROM "SALES" S
WHERE S."SALES_DATE" IS NOT NULL
QUALIFY RN <= 50
ORDER BY DAY_MARKET_REVENUE DESC NULLS LAST;
-- Q0650 [OK]
SELECT S."SALES_ID", S."SALES_DATE", SP."ARTICLE_ID", SP."AMOUNT" FROM "SALES" S JOIN "SALES_POSITIONS" SP ON SP."SALES_ID" = S."SALES_ID" LIMIT 200;
-- Q0651 [OK]
DELETE FROM "SALES_POSITIONS" WHERE "SALES_ID" = 4667743;
-- Q0652 [OK]
SELECT
  S."MARKET_ID",
  S."SALES_DATE",
  S."SALES_ID",
  S."PRICE",
  SUM(S."PRICE") OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE") AS DAY_MARKET_REVENUE,
  ROW_NUMBER() OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE" ORDER BY S."PRICE" DESC NULLS LAST) AS RN
FROM "SALES" S
WHERE S."SALES_DATE" IS NOT NULL
QUALIFY RN <= 50
ORDER BY DAY_MARKET_REVENUE DESC NULLS LAST;
-- Q0653 [OK]
SELECT "EMPLOYEE_ID", "TERMINAL_DAILY_SALES_NR", "LOYALTY_ID", "RETURNED_CHANGE" FROM "SALES" WHERE "RETURNED_CHANGE" IS NOT NULL;
-- Q0654 [OK]
INSERT INTO "DIM_DATE" ("SALES_DATE") VALUES (DATE '2022-09-26');
-- Q0655 [OK_PREP]
INSERT INTO "DIM_DATE" ("SALES_DATE") VALUES (?);
-- Q0656 [OK]
INSERT INTO "DIM_DATE" ("SALES_DATE") VALUES (DATE '2018-11-12');
-- Q0657 [OK]
INSERT INTO "DIM_DATE" ("SALES_DATE") VALUES (DATE '2023-02-23');
-- Q0658 [OK]
SELECT S."SALES_ID", S."SALES_DATE", SP."ARTICLE_ID", SP."AMOUNT" FROM "SALES" S JOIN "SALES_POSITIONS" SP ON SP."SALES_ID" = S."SALES_ID" LIMIT 200;
-- Q0659 [OK]
SELECT S."SALES_ID", S."SALES_DATE", SP."ARTICLE_ID", SP."AMOUNT" FROM "SALES" S JOIN "SALES_POSITIONS" SP ON SP."SALES_ID" = S."SALES_ID" LIMIT 200;
-- Q0660 [OK]
SELECT "AREA", "LONGITUDE", "CITY_ID", "POPULATION" FROM "MARKETS";
-- Q0661 [OK]
MERGE INTO "MARKETS" T
USING (SELECT 2336645 AS MARKET_ID, 855092 AS POPULATION) S
ON (T."MARKET_ID" = S.MARKET_ID)
WHEN MATCHED THEN UPDATE SET T."POPULATION" = S.POPULATION
WHEN NOT MATCHED THEN INSERT ("MARKET_ID","POPULATION") VALUES (S.MARKET_ID, S.POPULATION);
-- Q0662 [OK]
SELECT S."SALES_ID", S."SALES_DATE", SP."ARTICLE_ID", SP."AMOUNT" FROM "SALES" S JOIN "SALES_POSITIONS" SP ON SP."SALES_ID" = S."SALES_ID" LIMIT 200;
-- Q0663 [OK]
INSERT INTO "MARKETS" ("MARKET_ID","POPULATION") VALUES (5034983, 1720454);
-- Q0664 [OK]
DELETE FROM "SALES_POSITIONS" WHERE "SALES_ID" = 1117635;
-- Q0665 [OK]
INSERT INTO "DIM_DATE" ("SALES_DATE") VALUES (DATE '2022-02-01');
-- Q0666 [OK]
UPDATE "MARKETS" SET "POPULATION" = 541129 WHERE "MARKET_ID" = 4018320;
-- Q0667 [OK]
SELECT
  S."MARKET_ID",
  S."SALES_DATE",
  S."SALES_ID",
  S."PRICE",
  SUM(S."PRICE") OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE") AS DAY_MARKET_REVENUE,
  ROW_NUMBER() OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE" ORDER BY S."PRICE" DESC NULLS LAST) AS RN
FROM "SALES" S
WHERE S."SALES_DATE" IS NOT NULL
QUALIFY RN <= 50
ORDER BY DAY_MARKET_REVENUE DESC NULLS LAST;
-- Q0668 [OK]
DELETE FROM "SALES_POSITIONS" WHERE "SALES_ID" = 8278092;
-- Q0669 [FAIL]
DELETEE FROM "SALES";
-- Q0670 [OK]
UPDATE "MARKETS" SET "POPULATION" = 19610195 WHERE "MARKET_ID" = 6310571;
-- Q0671 [OK]
MERGE INTO "MARKETS" T
USING (SELECT 9834887 AS MARKET_ID, 7441303 AS POPULATION) S
ON (T."MARKET_ID" = S.MARKET_ID)
WHEN MATCHED THEN UPDATE SET T."POPULATION" = S.POPULATION
WHEN NOT MATCHED THEN INSERT ("MARKET_ID","POPULATION") VALUES (S.MARKET_ID, S.POPULATION);
-- Q0672 [OK]
INSERT INTO "MARKETS" ("MARKET_ID","POPULATION") VALUES (1678830, 8023616);
-- Q0673 [OK]
INSERT INTO "DIM_DATE" ("SALES_DATE") VALUES (DATE '2020-12-17');
-- Q0674 [OK]
UPDATE "MARKETS" SET "POPULATION" = 267411 WHERE "MARKET_ID" = 1007097;
-- Q0675 [OK]
SELECT M."MARKET_ID", C."COUNTRY_CODE", M."POPULATION" FROM "MARKETS" M LEFT JOIN "CITIES" C ON C."CITY_ID" = M."CITY_ID" LIMIT 200;
-- Q0676 [OK]
SELECT "CITY_ID", "CITY_NAME", "LAT", "AREA_SHORT" FROM "CITIES" WHERE "CITY_ID" IS NOT NULL LIMIT 100;
-- Q0677 [OK]
SELECT
  S."MARKET_ID",
  S."SALES_DATE",
  S."SALES_ID",
  S."PRICE",
  SUM(S."PRICE") OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE") AS DAY_MARKET_REVENUE,
  ROW_NUMBER() OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE" ORDER BY S."PRICE" DESC NULLS LAST) AS RN
FROM "SALES" S
WHERE S."SALES_DATE" IS NOT NULL
QUALIFY RN <= 50
ORDER BY DAY_MARKET_REVENUE DESC NULLS LAST;
-- Q0678 [OK]
DELETE FROM "SALES_POSITIONS" WHERE "SALES_ID" = 3576108;
-- Q0679 [OK]
SELECT SP."SALES_ID", A."PRODUCT_GROUP", SUM(SP."AMOUNT") AS UNITS FROM "SALES_POSITIONS" SP JOIN "ARTICLE" A ON A."ARTICLE_ID" = SP."ARTICLE_ID" GROUP BY SP."SALES_ID", A."PRODUCT_GROUP" ORDER BY UNITS DESC NULLS LAST LIMIT 200;
-- Q0680 [FAIL]
SELECT * FROM "SALESX" LIMIT 10;
-- Q0681 [OK]
MERGE INTO "MARKETS" T
USING (SELECT 9715884 AS MARKET_ID, 6289721 AS POPULATION) S
ON (T."MARKET_ID" = S.MARKET_ID)
WHEN MATCHED THEN UPDATE SET T."POPULATION" = S.POPULATION
WHEN NOT MATCHED THEN INSERT ("MARKET_ID","POPULATION") VALUES (S.MARKET_ID, S.POPULATION);
-- Q0682 [OK]
SELECT SP."SALES_ID", A."PRODUCT_GROUP", SUM(SP."AMOUNT") AS UNITS FROM "SALES_POSITIONS" SP JOIN "ARTICLE" A ON A."ARTICLE_ID" = SP."ARTICLE_ID" GROUP BY SP."SALES_ID", A."PRODUCT_GROUP" ORDER BY UNITS DESC NULLS LAST LIMIT 200;
-- Q0683 [OK]
MERGE INTO "MARKETS" T
USING (SELECT 8377386 AS MARKET_ID, 9765654 AS POPULATION) S
ON (T."MARKET_ID" = S.MARKET_ID)
WHEN MATCHED THEN UPDATE SET T."POPULATION" = S.POPULATION
WHEN NOT MATCHED THEN INSERT ("MARKET_ID","POPULATION") VALUES (S.MARKET_ID, S.POPULATION);
-- Q0684 [OK]
SELECT
  S."MARKET_ID",
  S."SALES_DATE",
  S."SALES_ID",
  S."PRICE",
  SUM(S."PRICE") OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE") AS DAY_MARKET_REVENUE,
  ROW_NUMBER() OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE" ORDER BY S."PRICE" DESC NULLS LAST) AS RN
FROM "SALES" S
WHERE S."SALES_DATE" IS NOT NULL
QUALIFY RN <= 50
ORDER BY DAY_MARKET_REVENUE DESC NULLS LAST;
-- Q0685 [OK]
INSERT INTO "DIM_DATE" ("SALES_DATE") VALUES (DATE '2023-05-21');
-- Q0686 [FAIL]
SELECT TO_DATE('not-a-date', 'YYYY-MM-DD');
-- Q0687 [OK]
MERGE INTO "MARKETS" T
USING (SELECT 5366288 AS MARKET_ID, 1558176 AS POPULATION) S
ON (T."MARKET_ID" = S.MARKET_ID)
WHEN MATCHED THEN UPDATE SET T."POPULATION" = S.POPULATION
WHEN NOT MATCHED THEN INSERT ("MARKET_ID","POPULATION") VALUES (S.MARKET_ID, S.POPULATION);
-- Q0688 [OK]
DELETE FROM "SALES_POSITIONS" WHERE "SALES_ID" = 865109;
-- Q0689 [OK]
SELECT "LOYALTY_ID", "MONEY_GIVEN", "PRICE" FROM "SALES" WHERE "MONEY_GIVEN" IS NOT NULL LIMIT 100;
-- Q0690 [OK]
INSERT INTO "MARKETS" ("MARKET_ID","POPULATION") VALUES (5154061, 9978522);
-- Q0691 [OK]
INSERT INTO "MARKETS" ("MARKET_ID","POPULATION") VALUES (360726, 2353079);
-- Q0692 [OK]
SELECT SP."SALES_ID", A."PRODUCT_GROUP", SUM(SP."AMOUNT") AS UNITS FROM "SALES_POSITIONS" SP JOIN "ARTICLE" A ON A."ARTICLE_ID" = SP."ARTICLE_ID" GROUP BY SP."SALES_ID", A."PRODUCT_GROUP" ORDER BY UNITS DESC NULLS LAST LIMIT 200;
-- Q0693 [OK]
SELECT
  S."MARKET_ID",
  S."SALES_DATE",
  S."SALES_ID",
  S."PRICE",
  SUM(S."PRICE") OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE") AS DAY_MARKET_REVENUE,
  ROW_NUMBER() OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE" ORDER BY S."PRICE" DESC NULLS LAST) AS RN
FROM "SALES" S
WHERE S."SALES_DATE" IS NOT NULL
QUALIFY RN <= 50
ORDER BY DAY_MARKET_REVENUE DESC NULLS LAST;
-- Q0694 [OK]
MERGE INTO "MARKETS" T
USING (SELECT 4401052 AS MARKET_ID, 9747546 AS POPULATION) S
ON (T."MARKET_ID" = S.MARKET_ID)
WHEN MATCHED THEN UPDATE SET T."POPULATION" = S.POPULATION
WHEN NOT MATCHED THEN INSERT ("MARKET_ID","POPULATION") VALUES (S.MARKET_ID, S.POPULATION);
-- Q0695 [OK_PREP]
DELETE FROM "SALES_POSITIONS" WHERE "SALES_ID" = ?;
-- Q0696 [OK]
SELECT "SALES_DATE" FROM "DIM_DATE" WHERE "SALES_DATE" IS NOT NULL LIMIT 100;
-- Q0697 [OK_PREP]
DELETE FROM "SALES_POSITIONS" WHERE "SALES_ID" = ?;
-- Q0698 [FAIL]
SELECT 1/0;
-- Q0699 [OK]
UPDATE "MARKETS" SET "POPULATION" = 19208667 WHERE "MARKET_ID" = 1412344;
-- Q0700 [OK]
SELECT
  S."MARKET_ID",
  S."SALES_DATE",
  S."SALES_ID",
  S."PRICE",
  SUM(S."PRICE") OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE") AS DAY_MARKET_REVENUE,
  ROW_NUMBER() OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE" ORDER BY S."PRICE" DESC NULLS LAST) AS RN
FROM "SALES" S
WHERE S."SALES_DATE" IS NOT NULL
QUALIFY RN <= 50
ORDER BY DAY_MARKET_REVENUE DESC NULLS LAST;
-- Q0701 [OK]
INSERT INTO "DIM_DATE" ("SALES_DATE") VALUES (DATE '2023-11-10');
-- Q0702 [OK]
SELECT
  S."MARKET_ID",
  S."SALES_DATE",
  S."SALES_ID",
  S."PRICE",
  SUM(S."PRICE") OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE") AS DAY_MARKET_REVENUE,
  ROW_NUMBER() OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE" ORDER BY S."PRICE" DESC NULLS LAST) AS RN
FROM "SALES" S
WHERE S."SALES_DATE" IS NOT NULL
QUALIFY RN <= 50
ORDER BY DAY_MARKET_REVENUE DESC NULLS LAST;
-- Q0703 [OK]
UPDATE "MARKETS" SET "POPULATION" = 3163228 WHERE "MARKET_ID" = 2590415;
-- Q0704 [OK]
MERGE INTO "MARKETS" T
USING (SELECT 6816941 AS MARKET_ID, 8899041 AS POPULATION) S
ON (T."MARKET_ID" = S.MARKET_ID)
WHEN MATCHED THEN UPDATE SET T."POPULATION" = S.POPULATION
WHEN NOT MATCHED THEN INSERT ("MARKET_ID","POPULATION") VALUES (S.MARKET_ID, S.POPULATION);
-- Q0705 [OK]
SELECT
  S."MARKET_ID",
  S."SALES_DATE",
  S."SALES_ID",
  S."PRICE",
  SUM(S."PRICE") OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE") AS DAY_MARKET_REVENUE,
  ROW_NUMBER() OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE" ORDER BY S."PRICE" DESC NULLS LAST) AS RN
FROM "SALES" S
WHERE S."SALES_DATE" IS NOT NULL
QUALIFY RN <= 50
ORDER BY DAY_MARKET_REVENUE DESC NULLS LAST;
-- Q0706 [OK]
SELECT "AREA", "MARKET_ID", "LATITUDE" FROM "MARKETS" WHERE "AREA" IS NOT NULL LIMIT 100;
-- Q0707 [OK]
MERGE INTO "MARKETS" T
USING (SELECT 5083677 AS MARKET_ID, 1145671 AS POPULATION) S
ON (T."MARKET_ID" = S.MARKET_ID)
WHEN MATCHED THEN UPDATE SET T."POPULATION" = S.POPULATION
WHEN NOT MATCHED THEN INSERT ("MARKET_ID","POPULATION") VALUES (S.MARKET_ID, S.POPULATION);
-- Q0708 [FAIL]
UPDATE "MARKETS" SET WHERE "MARKET_ID" = 1;
-- Q0709 [OK]
UPDATE "MARKETS" SET "POPULATION" = 17693931 WHERE "MARKET_ID" = 7481308;
-- Q0710 [OK]
INSERT INTO "DIM_DATE" ("SALES_DATE") VALUES (DATE '2014-04-12');
-- Q0711 [OK_PREP]
UPDATE "MARKETS" SET "POPULATION" = ? WHERE "MARKET_ID" = ?;
-- Q0712 [OK]
UPDATE "MARKETS" SET "POPULATION" = 13815462 WHERE "MARKET_ID" = 7205156;
-- Q0713 [OK]
INSERT INTO "DIM_DATE" ("SALES_DATE") VALUES (DATE '2008-06-21');
-- Q0714 [OK]
MERGE INTO "MARKETS" T
USING (SELECT 1865759 AS MARKET_ID, 7390623 AS POPULATION) S
ON (T."MARKET_ID" = S.MARKET_ID)
WHEN MATCHED THEN UPDATE SET T."POPULATION" = S.POPULATION
WHEN NOT MATCHED THEN INSERT ("MARKET_ID","POPULATION") VALUES (S.MARKET_ID, S.POPULATION);
-- Q0715 [OK]
SELECT S."SALES_ID", S."SALES_DATE", SP."ARTICLE_ID", SP."AMOUNT" FROM "SALES" S JOIN "SALES_POSITIONS" SP ON SP."SALES_ID" = S."SALES_ID" LIMIT 200;
-- Q0716 [OK_PREP]
INSERT INTO "MARKETS" ("MARKET_ID","POPULATION") VALUES (?, ?);
-- Q0717 [OK]
INSERT INTO "MARKETS" ("MARKET_ID","POPULATION") VALUES (2105093, 6835792);
-- Q0718 [OK]
INSERT INTO "MARKETS" ("MARKET_ID","POPULATION") VALUES (2231095, 673062);
-- Q0719 [OK]
INSERT INTO "MARKETS" ("MARKET_ID","POPULATION") VALUES (4749372, 6489161);
-- Q0720 [OK]
DELETE FROM "SALES_POSITIONS" WHERE "SALES_ID" = 1962326;
-- Q0721 [OK]
SELECT "POPULATION" FROM "MARKETS" WHERE "POPULATION" IS NOT NULL LIMIT 100;
-- Q0722 [OK]
INSERT INTO "DIM_DATE" ("SALES_DATE") VALUES (DATE '2008-12-10');
-- Q0723 [OK]
SELECT
  S."MARKET_ID",
  S."SALES_DATE",
  S."SALES_ID",
  S."PRICE",
  SUM(S."PRICE") OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE") AS DAY_MARKET_REVENUE,
  ROW_NUMBER() OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE" ORDER BY S."PRICE" DESC NULLS LAST) AS RN
FROM "SALES" S
WHERE S."SALES_DATE" IS NOT NULL
QUALIFY RN <= 50
ORDER BY DAY_MARKET_REVENUE DESC NULLS LAST;
-- Q0724 [OK]
SELECT "SALES_DATE" FROM "DIM_DATE" WHERE "SALES_DATE" IS NOT NULL;
-- Q0725 [OK]
INSERT INTO "DIM_DATE" ("SALES_DATE") VALUES (DATE '2007-04-03');
-- Q0726 [OK]
SELECT
  S."MARKET_ID",
  S."SALES_DATE",
  S."SALES_ID",
  S."PRICE",
  SUM(S."PRICE") OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE") AS DAY_MARKET_REVENUE,
  ROW_NUMBER() OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE" ORDER BY S."PRICE" DESC NULLS LAST) AS RN
FROM "SALES" S
WHERE S."SALES_DATE" IS NOT NULL
QUALIFY RN <= 50
ORDER BY DAY_MARKET_REVENUE DESC NULLS LAST;
-- Q0727 [FAIL]
SELECT CAST('abc' AS DECIMAL(18,0));
-- Q0728 [OK]
SELECT
  S."MARKET_ID",
  S."SALES_DATE",
  S."SALES_ID",
  S."PRICE",
  SUM(S."PRICE") OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE") AS DAY_MARKET_REVENUE,
  ROW_NUMBER() OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE" ORDER BY S."PRICE" DESC NULLS LAST) AS RN
FROM "SALES" S
WHERE S."SALES_DATE" IS NOT NULL
QUALIFY RN <= 50
ORDER BY DAY_MARKET_REVENUE DESC NULLS LAST;
-- Q0729 [OK]
INSERT INTO "MARKETS" ("MARKET_ID","POPULATION") VALUES (9464140, 7912429);
-- Q0730 [OK]
DELETE FROM "SALES_POSITIONS" WHERE "SALES_ID" = 1686193;
-- Q0731 [OK]
SELECT
  S."MARKET_ID",
  S."SALES_DATE",
  S."SALES_ID",
  S."PRICE",
  SUM(S."PRICE") OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE") AS DAY_MARKET_REVENUE,
  ROW_NUMBER() OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE" ORDER BY S."PRICE" DESC NULLS LAST) AS RN
FROM "SALES" S
WHERE S."SALES_DATE" IS NOT NULL
QUALIFY RN <= 50
ORDER BY DAY_MARKET_REVENUE DESC NULLS LAST;
-- Q0732 [OK]
INSERT INTO "MARKETS" ("MARKET_ID","POPULATION") VALUES (3527329, 1596990);
-- Q0733 [OK]
UPDATE "MARKETS" SET "POPULATION" = 5851782 WHERE "MARKET_ID" = 3758614;
-- Q0734 [OK]
SELECT SP."SALES_ID", A."PRODUCT_GROUP", SUM(SP."AMOUNT") AS UNITS FROM "SALES_POSITIONS" SP JOIN "ARTICLE" A ON A."ARTICLE_ID" = SP."ARTICLE_ID" GROUP BY SP."SALES_ID", A."PRODUCT_GROUP" ORDER BY UNITS DESC NULLS LAST LIMIT 200;
-- Q0735 [OK]
SELECT SP."SALES_ID", A."PRODUCT_GROUP", SUM(SP."AMOUNT") AS UNITS FROM "SALES_POSITIONS" SP JOIN "ARTICLE" A ON A."ARTICLE_ID" = SP."ARTICLE_ID" GROUP BY SP."SALES_ID", A."PRODUCT_GROUP" ORDER BY UNITS DESC NULLS LAST LIMIT 200;
-- Q0736 [OK]
INSERT INTO "MARKETS" ("MARKET_ID","POPULATION") VALUES (999639, 7926925);
-- Q0737 [FAIL]
SELECT M."MARKET_ID" FROM "MARKETS" M WHERE M."CITY_NAME" IS NOT NULL;
-- Q0738 [OK]
SELECT "AREA_SHORT", "CITY_ID", "DISTRICT", "AREA" FROM "CITIES" WHERE "AREA" IS NOT NULL LIMIT 100;
-- Q0739 [OK]
SELECT
  S."MARKET_ID",
  S."SALES_DATE",
  S."SALES_ID",
  S."PRICE",
  SUM(S."PRICE") OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE") AS DAY_MARKET_REVENUE,
  ROW_NUMBER() OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE" ORDER BY S."PRICE" DESC NULLS LAST) AS RN
FROM "SALES" S
WHERE S."SALES_DATE" IS NOT NULL
QUALIFY RN <= 50
ORDER BY DAY_MARKET_REVENUE DESC NULLS LAST;
-- Q0740 [OK]
SELECT SP."SALES_ID", A."PRODUCT_GROUP", SUM(SP."AMOUNT") AS UNITS FROM "SALES_POSITIONS" SP JOIN "ARTICLE" A ON A."ARTICLE_ID" = SP."ARTICLE_ID" GROUP BY SP."SALES_ID", A."PRODUCT_GROUP" ORDER BY UNITS DESC NULLS LAST LIMIT 200;
-- Q0741 [OK]
SELECT "PRICE", "ARTICLE_ID", "POSITION_ID", "SALES_ID" FROM "SALES_POSITIONS" WHERE "ARTICLE_ID" IS NOT NULL;
-- Q0742 [OK]
UPDATE "MARKETS" SET "POPULATION" = 5780954 WHERE "MARKET_ID" = 5325473;
-- Q0743 [OK]
SELECT "COUNTRY_CODE", "CITY_ID", "LAT" FROM "CITIES";
-- Q0744 [OK]
SELECT "TERMINAL_DAILY_SALES_NR", "SALES_TIMESTAMP" FROM "SALES" LIMIT 100;
-- Q0745 [OK]
SELECT
  S."MARKET_ID",
  S."SALES_DATE",
  S."SALES_ID",
  S."PRICE",
  SUM(S."PRICE") OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE") AS DAY_MARKET_REVENUE,
  ROW_NUMBER() OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE" ORDER BY S."PRICE" DESC NULLS LAST) AS RN
FROM "SALES" S
WHERE S."SALES_DATE" IS NOT NULL
QUALIFY RN <= 50
ORDER BY DAY_MARKET_REVENUE DESC NULLS LAST;
-- Q0746 [OK]
UPDATE "MARKETS" SET "POPULATION" = 18213459 WHERE "MARKET_ID" = 8838681;
-- Q0747 [OK]
UPDATE "MARKETS" SET "POPULATION" = 13482884 WHERE "MARKET_ID" = 7714621;
-- Q0748 [OK]
SELECT "TERMINAL_ID" FROM "SALES" LIMIT 100;
-- Q0749 [OK]
DELETE FROM "SALES_POSITIONS" WHERE "SALES_ID" = 1654430;
-- Q0750 [OK_PREP]
MERGE INTO "MARKETS" T
USING (SELECT ? AS MARKET_ID, ? AS POPULATION) S
ON (T."MARKET_ID" = S.MARKET_ID)
WHEN MATCHED THEN UPDATE SET T."POPULATION" = S.POPULATION
WHEN NOT MATCHED THEN INSERT ("MARKET_ID","POPULATION") VALUES (S.MARKET_ID, S.POPULATION);
-- Q0751 [FAIL]
SELECT 1/0;
-- Q0752 [OK]
UPDATE "MARKETS" SET "POPULATION" = 9643934 WHERE "MARKET_ID" = 5038029;
-- Q0753 [OK]
SELECT
  S."MARKET_ID",
  S."SALES_DATE",
  S."SALES_ID",
  S."PRICE",
  SUM(S."PRICE") OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE") AS DAY_MARKET_REVENUE,
  ROW_NUMBER() OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE" ORDER BY S."PRICE" DESC NULLS LAST) AS RN
FROM "SALES" S
WHERE S."SALES_DATE" IS NOT NULL
QUALIFY RN <= 50
ORDER BY DAY_MARKET_REVENUE DESC NULLS LAST;
-- Q0754 [FAIL]
SELECT TO_DATE('not-a-date', 'YYYY-MM-DD');
-- Q0755 [FAIL]
SELEC COUNT(*) FROM "SALES";
-- Q0756 [FAIL]
SELECT * FROM "SALESX" LIMIT 10;
-- Q0757 [OK]
INSERT INTO "DIM_DATE" ("SALES_DATE") VALUES (DATE '2013-11-11');
-- Q0758 [OK]
DELETE FROM "SALES_POSITIONS" WHERE "SALES_ID" = 1673999;
-- Q0759 [OK_PREP]
MERGE INTO "MARKETS" T
USING (SELECT ? AS MARKET_ID, ? AS POPULATION) S
ON (T."MARKET_ID" = S.MARKET_ID)
WHEN MATCHED THEN UPDATE SET T."POPULATION" = S.POPULATION
WHEN NOT MATCHED THEN INSERT ("MARKET_ID","POPULATION") VALUES (S.MARKET_ID, S.POPULATION);
-- Q0760 [OK]
INSERT INTO "DIM_DATE" ("SALES_DATE") VALUES (DATE '2019-01-06');
-- Q0761 [OK]
DELETE FROM "SALES_POSITIONS" WHERE "SALES_ID" = 2811607;
-- Q0762 [OK]
SELECT M."MARKET_ID", C."COUNTRY_CODE", M."POPULATION" FROM "MARKETS" M LEFT JOIN "CITIES" C ON C."CITY_ID" = M."CITY_ID" LIMIT 200;
-- Q0763 [FAIL]
SELECT 1/0;
-- Q0764 [OK]
MERGE INTO "MARKETS" T
USING (SELECT 6113548 AS MARKET_ID, 7167983 AS POPULATION) S
ON (T."MARKET_ID" = S.MARKET_ID)
WHEN MATCHED THEN UPDATE SET T."POPULATION" = S.POPULATION
WHEN NOT MATCHED THEN INSERT ("MARKET_ID","POPULATION") VALUES (S.MARKET_ID, S.POPULATION);
-- Q0765 [OK]
SELECT
  S."MARKET_ID",
  S."SALES_DATE",
  S."SALES_ID",
  S."PRICE",
  SUM(S."PRICE") OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE") AS DAY_MARKET_REVENUE,
  ROW_NUMBER() OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE" ORDER BY S."PRICE" DESC NULLS LAST) AS RN
FROM "SALES" S
WHERE S."SALES_DATE" IS NOT NULL
QUALIFY RN <= 50
ORDER BY DAY_MARKET_REVENUE DESC NULLS LAST;
-- Q0766 [OK]
INSERT INTO "DIM_DATE" ("SALES_DATE") VALUES (DATE '2006-11-14');
-- Q0767 [OK]
INSERT INTO "DIM_DATE" ("SALES_DATE") VALUES (DATE '2010-12-02');
-- Q0768 [OK]
SELECT SP."SALES_ID", A."PRODUCT_GROUP", SUM(SP."AMOUNT") AS UNITS FROM "SALES_POSITIONS" SP JOIN "ARTICLE" A ON A."ARTICLE_ID" = SP."ARTICLE_ID" GROUP BY SP."SALES_ID", A."PRODUCT_GROUP" ORDER BY UNITS DESC NULLS LAST LIMIT 200;
-- Q0769 [OK]
SELECT "SALES_DATE" FROM "DIM_DATE" LIMIT 100;
-- Q0770 [OK]
INSERT INTO "MARKETS" ("MARKET_ID","POPULATION") VALUES (927168, 4925472);
-- Q0771 [OK]
INSERT INTO "MARKETS" ("MARKET_ID","POPULATION") VALUES (2290745, 4482051);
-- Q0772 [OK]
SELECT SP."SALES_ID", A."PRODUCT_GROUP", SUM(SP."AMOUNT") AS UNITS FROM "SALES_POSITIONS" SP JOIN "ARTICLE" A ON A."ARTICLE_ID" = SP."ARTICLE_ID" GROUP BY SP."SALES_ID", A."PRODUCT_GROUP" ORDER BY UNITS DESC NULLS LAST LIMIT 200;
-- Q0773 [OK]
INSERT INTO "MARKETS" ("MARKET_ID","POPULATION") VALUES (9027245, 9153666);
-- Q0774 [OK]
INSERT INTO "DIM_DATE" ("SALES_DATE") VALUES (DATE '2013-11-06');
-- Q0775 [FAIL]
SELECT TO_DATE('not-a-date', 'YYYY-MM-DD');
-- Q0776 [OK]
UPDATE "MARKETS" SET "POPULATION" = 19425498 WHERE "MARKET_ID" = 4086005;
-- Q0777 [OK_PREP]
SELECT * FROM "CITIES" WHERE "COUNTRY_CODE" = ? LIMIT 100;
-- Q0778 [OK]
SELECT
  S."MARKET_ID",
  S."SALES_DATE",
  S."SALES_ID",
  S."PRICE",
  SUM(S."PRICE") OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE") AS DAY_MARKET_REVENUE,
  ROW_NUMBER() OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE" ORDER BY S."PRICE" DESC NULLS LAST) AS RN
FROM "SALES" S
WHERE S."SALES_DATE" IS NOT NULL
QUALIFY RN <= 50
ORDER BY DAY_MARKET_REVENUE DESC NULLS LAST;
-- Q0779 [OK_PREP]
SELECT * FROM "MARKETS" WHERE "CITY_ID" = ? LIMIT 50;
-- Q0780 [OK]
INSERT INTO "DIM_DATE" ("SALES_DATE") VALUES (DATE '2015-03-12');
-- Q0781 [OK]
INSERT INTO "DIM_DATE" ("SALES_DATE") VALUES (DATE '2008-02-17');
-- Q0782 [OK]
SELECT "DISTRIBUTION_COST", "TMP_OLD_NR", "QUANTITY_UNIT", "PRODUCT_CLASS" FROM "ARTICLE" LIMIT 100;
-- Q0783 [OK]
SELECT "SALES_ID", "POSITION_ID" FROM "SALES_POSITIONS" WHERE "SALES_ID" IS NOT NULL;
-- Q0784 [OK]
DELETE FROM "SALES_POSITIONS" WHERE "SALES_ID" = 4860340;
-- Q0785 [OK]
UPDATE "MARKETS" SET "POPULATION" = 15507304 WHERE "MARKET_ID" = 5520471;
-- Q0786 [OK]
INSERT INTO "MARKETS" ("MARKET_ID","POPULATION") VALUES (1540550, 8105818);
-- Q0787 [OK]
INSERT INTO "MARKETS" ("MARKET_ID","POPULATION") VALUES (2756551, 4198066);
-- Q0788 [OK]
MERGE INTO "MARKETS" T
USING (SELECT 8851581 AS MARKET_ID, 9685094 AS POPULATION) S
ON (T."MARKET_ID" = S.MARKET_ID)
WHEN MATCHED THEN UPDATE SET T."POPULATION" = S.POPULATION
WHEN NOT MATCHED THEN INSERT ("MARKET_ID","POPULATION") VALUES (S.MARKET_ID, S.POPULATION);
-- Q0789 [OK]
DELETE FROM "SALES_POSITIONS" WHERE "SALES_ID" = 721660;
-- Q0790 [FAIL]
SELECT M."MARKET_ID" FROM "MARKETS" M WHERE M."CITY_NAME" IS NOT NULL;
-- Q0791 [OK]
SELECT "PRODUCT_CLASS", "DISTRIBUTION_COST", "EAN", "ARTICLE_ID" FROM "ARTICLE" WHERE "EAN" IS NOT NULL;
-- Q0792 [OK_PREP]
MERGE INTO "MARKETS" T
USING (SELECT ? AS MARKET_ID, ? AS POPULATION) S
ON (T."MARKET_ID" = S.MARKET_ID)
WHEN MATCHED THEN UPDATE SET T."POPULATION" = S.POPULATION
WHEN NOT MATCHED THEN INSERT ("MARKET_ID","POPULATION") VALUES (S.MARKET_ID, S.POPULATION);
-- Q0793 [OK]
SELECT M."MARKET_ID", C."COUNTRY_CODE", M."POPULATION" FROM "MARKETS" M LEFT JOIN "CITIES" C ON C."CITY_ID" = M."CITY_ID" LIMIT 200;
-- Q0794 [OK]
INSERT INTO "MARKETS" ("MARKET_ID","POPULATION") VALUES (5885081, 9314166);
-- Q0795 [OK]
UPDATE "MARKETS" SET "POPULATION" = 14828394 WHERE "MARKET_ID" = 8393527;
-- Q0796 [OK_PREP]
INSERT INTO "DIM_DATE" ("SALES_DATE") VALUES (?);
-- Q0797 [OK]
SELECT
  S."MARKET_ID",
  S."SALES_DATE",
  S."SALES_ID",
  S."PRICE",
  SUM(S."PRICE") OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE") AS DAY_MARKET_REVENUE,
  ROW_NUMBER() OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE" ORDER BY S."PRICE" DESC NULLS LAST) AS RN
FROM "SALES" S
WHERE S."SALES_DATE" IS NOT NULL
QUALIFY RN <= 50
ORDER BY DAY_MARKET_REVENUE DESC NULLS LAST;
-- Q0798 [OK]
INSERT INTO "DIM_DATE" ("SALES_DATE") VALUES (DATE '2010-06-24');
-- Q0799 [OK_PREP]
SELECT * FROM "ARTICLE" WHERE "ARTICLE_ID" = ?;
-- Q0800 [OK]
UPDATE "MARKETS" SET "POPULATION" = 2763587 WHERE "MARKET_ID" = 730745;
-- Q0801 [OK]
SELECT "SALES_DATE" FROM "DIM_DATE";
-- Q0802 [OK]
UPDATE "MARKETS" SET "POPULATION" = 9224508 WHERE "MARKET_ID" = 6818035;
-- Q0803 [OK]
SELECT
  S."MARKET_ID",
  S."SALES_DATE",
  S."SALES_ID",
  S."PRICE",
  SUM(S."PRICE") OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE") AS DAY_MARKET_REVENUE,
  ROW_NUMBER() OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE" ORDER BY S."PRICE" DESC NULLS LAST) AS RN
FROM "SALES" S
WHERE S."SALES_DATE" IS NOT NULL
QUALIFY RN <= 50
ORDER BY DAY_MARKET_REVENUE DESC NULLS LAST;
-- Q0804 [OK]
INSERT INTO "MARKETS" ("MARKET_ID","POPULATION") VALUES (886177, 7510188);
-- Q0805 [OK]
INSERT INTO "MARKETS" ("MARKET_ID","POPULATION") VALUES (494435, 1139446);
-- Q0806 [OK]
UPDATE "MARKETS" SET "POPULATION" = 6844073 WHERE "MARKET_ID" = 9995593;
-- Q0807 [OK]
MERGE INTO "MARKETS" T
USING (SELECT 9752785 AS MARKET_ID, 1808644 AS POPULATION) S
ON (T."MARKET_ID" = S.MARKET_ID)
WHEN MATCHED THEN UPDATE SET T."POPULATION" = S.POPULATION
WHEN NOT MATCHED THEN INSERT ("MARKET_ID","POPULATION") VALUES (S.MARKET_ID, S.POPULATION);
-- Q0808 [OK]
SELECT
  S."MARKET_ID",
  S."SALES_DATE",
  S."SALES_ID",
  S."PRICE",
  SUM(S."PRICE") OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE") AS DAY_MARKET_REVENUE,
  ROW_NUMBER() OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE" ORDER BY S."PRICE" DESC NULLS LAST) AS RN
FROM "SALES" S
WHERE S."SALES_DATE" IS NOT NULL
QUALIFY RN <= 50
ORDER BY DAY_MARKET_REVENUE DESC NULLS LAST;
-- Q0809 [OK]
UPDATE "MARKETS" SET "POPULATION" = 12872033 WHERE "MARKET_ID" = 1892744;
-- Q0810 [OK]
SELECT "SALES_DATE" FROM "DIM_DATE" LIMIT 100;
-- Q0811 [OK]
UPDATE "MARKETS" SET "POPULATION" = 8725567 WHERE "MARKET_ID" = 974803;
-- Q0812 [OK_PREP]
DELETE FROM "SALES_POSITIONS" WHERE "SALES_ID" = ?;
-- Q0813 [OK_PREP]
DELETE FROM "SALES_POSITIONS" WHERE "SALES_ID" = ?;
-- Q0814 [OK]
SELECT
  S."MARKET_ID",
  S."SALES_DATE",
  S."SALES_ID",
  S."PRICE",
  SUM(S."PRICE") OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE") AS DAY_MARKET_REVENUE,
  ROW_NUMBER() OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE" ORDER BY S."PRICE" DESC NULLS LAST) AS RN
FROM "SALES" S
WHERE S."SALES_DATE" IS NOT NULL
QUALIFY RN <= 50
ORDER BY DAY_MARKET_REVENUE DESC NULLS LAST;
-- Q0815 [OK]
MERGE INTO "MARKETS" T
USING (SELECT 7789302 AS MARKET_ID, 3141988 AS POPULATION) S
ON (T."MARKET_ID" = S.MARKET_ID)
WHEN MATCHED THEN UPDATE SET T."POPULATION" = S.POPULATION
WHEN NOT MATCHED THEN INSERT ("MARKET_ID","POPULATION") VALUES (S.MARKET_ID, S.POPULATION);
-- Q0816 [OK]
SELECT
  S."MARKET_ID",
  S."SALES_DATE",
  S."SALES_ID",
  S."PRICE",
  SUM(S."PRICE") OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE") AS DAY_MARKET_REVENUE,
  ROW_NUMBER() OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE" ORDER BY S."PRICE" DESC NULLS LAST) AS RN
FROM "SALES" S
WHERE S."SALES_DATE" IS NOT NULL
QUALIFY RN <= 50
ORDER BY DAY_MARKET_REVENUE DESC NULLS LAST;
-- Q0817 [OK]
UPDATE "MARKETS" SET "POPULATION" = 12960725 WHERE "MARKET_ID" = 4941757;
-- Q0818 [OK]
DELETE FROM "SALES_POSITIONS" WHERE "SALES_ID" = 625578;
-- Q0819 [OK]
INSERT INTO "MARKETS" ("MARKET_ID","POPULATION") VALUES (5898603, 2490758);
-- Q0820 [OK]
DELETE FROM "SALES_POSITIONS" WHERE "SALES_ID" = 8603935;
-- Q0821 [OK]
SELECT
  S."MARKET_ID",
  S."SALES_DATE",
  S."SALES_ID",
  S."PRICE",
  SUM(S."PRICE") OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE") AS DAY_MARKET_REVENUE,
  ROW_NUMBER() OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE" ORDER BY S."PRICE" DESC NULLS LAST) AS RN
FROM "SALES" S
WHERE S."SALES_DATE" IS NOT NULL
QUALIFY RN <= 50
ORDER BY DAY_MARKET_REVENUE DESC NULLS LAST;
-- Q0822 [FAIL]
SELECT 1/0;
-- Q0823 [FAIL]
SELEC COUNT(*) FROM "SALES";
-- Q0824 [OK]
SELECT
  S."MARKET_ID",
  S."SALES_DATE",
  S."SALES_ID",
  S."PRICE",
  SUM(S."PRICE") OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE") AS DAY_MARKET_REVENUE,
  ROW_NUMBER() OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE" ORDER BY S."PRICE" DESC NULLS LAST) AS RN
FROM "SALES" S
WHERE S."SALES_DATE" IS NOT NULL
QUALIFY RN <= 50
ORDER BY DAY_MARKET_REVENUE DESC NULLS LAST;
-- Q0825 [OK]
DELETE FROM "SALES_POSITIONS" WHERE "SALES_ID" = 1302735;
-- Q0826 [OK]
UPDATE "MARKETS" SET "POPULATION" = 3407771 WHERE "MARKET_ID" = 3366217;
-- Q0827 [FAIL]
SELEC COUNT(*) FROM "SALES";
-- Q0828 [OK]
UPDATE "MARKETS" SET "POPULATION" = 782726 WHERE "MARKET_ID" = 9564485;
-- Q0829 [OK]
INSERT INTO "DIM_DATE" ("SALES_DATE") VALUES (DATE '2024-01-19');
-- Q0830 [OK]
INSERT INTO "DIM_DATE" ("SALES_DATE") VALUES (DATE '2021-05-03');
-- Q0831 [OK]
UPDATE "MARKETS" SET "POPULATION" = 12771045 WHERE "MARKET_ID" = 1936692;
-- Q0832 [OK]
INSERT INTO "MARKETS" ("MARKET_ID","POPULATION") VALUES (9025990, 7148858);
-- Q0833 [OK]
INSERT INTO "MARKETS" ("MARKET_ID","POPULATION") VALUES (7045295, 5257650);
-- Q0834 [OK]
INSERT INTO "DIM_DATE" ("SALES_DATE") VALUES (DATE '2023-03-12');
-- Q0835 [OK]
DELETE FROM "SALES_POSITIONS" WHERE "SALES_ID" = 4548876;
-- Q0836 [OK]
INSERT INTO "MARKETS" ("MARKET_ID","POPULATION") VALUES (15560, 7797602);
-- Q0837 [OK]
INSERT INTO "DIM_DATE" ("SALES_DATE") VALUES (DATE '2007-03-07');
-- Q0838 [OK]
MERGE INTO "MARKETS" T
USING (SELECT 846927 AS MARKET_ID, 2692488 AS POPULATION) S
ON (T."MARKET_ID" = S.MARKET_ID)
WHEN MATCHED THEN UPDATE SET T."POPULATION" = S.POPULATION
WHEN NOT MATCHED THEN INSERT ("MARKET_ID","POPULATION") VALUES (S.MARKET_ID, S.POPULATION);
-- Q0839 [OK]
DELETE FROM "SALES_POSITIONS" WHERE "SALES_ID" = 2114278;
-- Q0840 [FAIL]
UPDATE "UNKNOWN_TABLE" SET "X" = 1;
-- Q0841 [OK]
SELECT
  S."MARKET_ID",
  S."SALES_DATE",
  S."SALES_ID",
  S."PRICE",
  SUM(S."PRICE") OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE") AS DAY_MARKET_REVENUE,
  ROW_NUMBER() OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE" ORDER BY S."PRICE" DESC NULLS LAST) AS RN
FROM "SALES" S
WHERE S."SALES_DATE" IS NOT NULL
QUALIFY RN <= 50
ORDER BY DAY_MARKET_REVENUE DESC NULLS LAST;
-- Q0842 [OK]
SELECT "AREA", "LAT", "ZIP_CODE", "COUNTRY_CODE" FROM "CITIES" LIMIT 100;
-- Q0843 [OK]
SELECT "SALES_DATE" FROM "DIM_DATE" WHERE "SALES_DATE" IS NOT NULL;
-- Q0844 [OK]
UPDATE "MARKETS" SET "POPULATION" = 4161141 WHERE "MARKET_ID" = 4280270;
-- Q0845 [FAIL]
SELECT FROM "SALES";
-- Q0846 [FAIL]
SELECT * FROM "SALESX" LIMIT 10;
-- Q0847 [OK]
INSERT INTO "DIM_DATE" ("SALES_DATE") VALUES (DATE '2011-11-01');
-- Q0848 [OK]
INSERT INTO "MARKETS" ("MARKET_ID","POPULATION") VALUES (984574, 772970);
-- Q0849 [OK]
UPDATE "MARKETS" SET "POPULATION" = 7321735 WHERE "MARKET_ID" = 2209644;
-- Q0850 [OK]
INSERT INTO "DIM_DATE" ("SALES_DATE") VALUES (DATE '2017-04-28');
-- Q0851 [OK]
MERGE INTO "MARKETS" T
USING (SELECT 7655621 AS MARKET_ID, 3012769 AS POPULATION) S
ON (T."MARKET_ID" = S.MARKET_ID)
WHEN MATCHED THEN UPDATE SET T."POPULATION" = S.POPULATION
WHEN NOT MATCHED THEN INSERT ("MARKET_ID","POPULATION") VALUES (S.MARKET_ID, S.POPULATION);
-- Q0852 [OK]
DELETE FROM "SALES_POSITIONS" WHERE "SALES_ID" = 8029328;
-- Q0853 [FAIL]
INSERT INTO "MARKETS" ("MARKET_ID","NOPE") VALUES (1,2);
-- Q0854 [OK]
SELECT S."SALES_ID", S."SALES_DATE", SP."ARTICLE_ID", SP."AMOUNT" FROM "SALES" S JOIN "SALES_POSITIONS" SP ON SP."SALES_ID" = S."SALES_ID" LIMIT 200;
-- Q0855 [OK]
INSERT INTO "DIM_DATE" ("SALES_DATE") VALUES (DATE '2009-05-15');
-- Q0856 [OK]
UPDATE "MARKETS" SET "POPULATION" = 2017690 WHERE "MARKET_ID" = 4453142;
-- Q0857 [OK]
SELECT S."SALES_ID", S."SALES_DATE", SP."ARTICLE_ID", SP."AMOUNT" FROM "SALES" S JOIN "SALES_POSITIONS" SP ON SP."SALES_ID" = S."SALES_ID" LIMIT 200;
-- Q0858 [FAIL]
INSERT INTO "MARKETS" ("MARKET_ID","NOPE") VALUES (1,2);
-- Q0859 [OK]
UPDATE "MARKETS" SET "POPULATION" = 2410720 WHERE "MARKET_ID" = 8615544;
-- Q0860 [OK_PREP]
MERGE INTO "MARKETS" T
USING (SELECT ? AS MARKET_ID, ? AS POPULATION) S
ON (T."MARKET_ID" = S.MARKET_ID)
WHEN MATCHED THEN UPDATE SET T."POPULATION" = S.POPULATION
WHEN NOT MATCHED THEN INSERT ("MARKET_ID","POPULATION") VALUES (S.MARKET_ID, S.POPULATION);
-- Q0861 [OK_PREP]
UPDATE "MARKETS" SET "POPULATION" = ? WHERE "MARKET_ID" = ?;
-- Q0862 [OK]
SELECT
  S."MARKET_ID",
  S."SALES_DATE",
  S."SALES_ID",
  S."PRICE",
  SUM(S."PRICE") OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE") AS DAY_MARKET_REVENUE,
  ROW_NUMBER() OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE" ORDER BY S."PRICE" DESC NULLS LAST) AS RN
FROM "SALES" S
WHERE S."SALES_DATE" IS NOT NULL
QUALIFY RN <= 50
ORDER BY DAY_MARKET_REVENUE DESC NULLS LAST;
-- Q0863 [OK]
SELECT SP."SALES_ID", A."PRODUCT_GROUP", SUM(SP."AMOUNT") AS UNITS FROM "SALES_POSITIONS" SP JOIN "ARTICLE" A ON A."ARTICLE_ID" = SP."ARTICLE_ID" GROUP BY SP."SALES_ID", A."PRODUCT_GROUP" ORDER BY UNITS DESC NULLS LAST LIMIT 200;
-- Q0864 [OK]
UPDATE "MARKETS" SET "POPULATION" = 7271117 WHERE "MARKET_ID" = 403133;
-- Q0865 [OK]
MERGE INTO "MARKETS" T
USING (SELECT 888307 AS MARKET_ID, 342228 AS POPULATION) S
ON (T."MARKET_ID" = S.MARKET_ID)
WHEN MATCHED THEN UPDATE SET T."POPULATION" = S.POPULATION
WHEN NOT MATCHED THEN INSERT ("MARKET_ID","POPULATION") VALUES (S.MARKET_ID, S.POPULATION);
-- Q0866 [OK]
MERGE INTO "MARKETS" T
USING (SELECT 5928506 AS MARKET_ID, 7363070 AS POPULATION) S
ON (T."MARKET_ID" = S.MARKET_ID)
WHEN MATCHED THEN UPDATE SET T."POPULATION" = S.POPULATION
WHEN NOT MATCHED THEN INSERT ("MARKET_ID","POPULATION") VALUES (S.MARKET_ID, S.POPULATION);
-- Q0867 [OK]
INSERT INTO "MARKETS" ("MARKET_ID","POPULATION") VALUES (9055563, 2300941);
-- Q0868 [OK]
INSERT INTO "MARKETS" ("MARKET_ID","POPULATION") VALUES (5195938, 1200240);
-- Q0869 [OK]
SELECT
  S."MARKET_ID",
  S."SALES_DATE",
  S."SALES_ID",
  S."PRICE",
  SUM(S."PRICE") OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE") AS DAY_MARKET_REVENUE,
  ROW_NUMBER() OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE" ORDER BY S."PRICE" DESC NULLS LAST) AS RN
FROM "SALES" S
WHERE S."SALES_DATE" IS NOT NULL
QUALIFY RN <= 50
ORDER BY DAY_MARKET_REVENUE DESC NULLS LAST;
-- Q0870 [OK]
INSERT INTO "DIM_DATE" ("SALES_DATE") VALUES (DATE '2016-09-20');
-- Q0871 [OK_PREP]
UPDATE "MARKETS" SET "POPULATION" = ? WHERE "MARKET_ID" = ?;
-- Q0872 [OK]
SELECT
  S."MARKET_ID",
  S."SALES_DATE",
  S."SALES_ID",
  S."PRICE",
  SUM(S."PRICE") OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE") AS DAY_MARKET_REVENUE,
  ROW_NUMBER() OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE" ORDER BY S."PRICE" DESC NULLS LAST) AS RN
FROM "SALES" S
WHERE S."SALES_DATE" IS NOT NULL
QUALIFY RN <= 50
ORDER BY DAY_MARKET_REVENUE DESC NULLS LAST;
-- Q0873 [OK]
SELECT "CANCELED", "AMOUNT", "PRICE" FROM "SALES_POSITIONS" LIMIT 100;
-- Q0874 [OK]
INSERT INTO "DIM_DATE" ("SALES_DATE") VALUES (DATE '2023-07-09');
-- Q0875 [OK]
INSERT INTO "DIM_DATE" ("SALES_DATE") VALUES (DATE '2005-04-23');
-- Q0876 [FAIL]
SELECT M."MARKET_ID" FROM "MARKETS" M WHERE M."CITY_NAME" IS NOT NULL;
-- Q0877 [OK]
INSERT INTO "MARKETS" ("MARKET_ID","POPULATION") VALUES (6427990, 7322152);
-- Q0878 [OK]
DELETE FROM "SALES_POSITIONS" WHERE "SALES_ID" = 4140226;
-- Q0879 [OK]
INSERT INTO "MARKETS" ("MARKET_ID","POPULATION") VALUES (9372946, 6341181);
-- Q0880 [OK_PREP]
DELETE FROM "SALES_POSITIONS" WHERE "SALES_ID" = ?;
-- Q0881 [OK]
DELETE FROM "SALES_POSITIONS" WHERE "SALES_ID" = 2725241;
-- Q0882 [OK]
INSERT INTO "MARKETS" ("MARKET_ID","POPULATION") VALUES (3514648, 1266558);
-- Q0883 [OK_PREP]
MERGE INTO "MARKETS" T
USING (SELECT ? AS MARKET_ID, ? AS POPULATION) S
ON (T."MARKET_ID" = S.MARKET_ID)
WHEN MATCHED THEN UPDATE SET T."POPULATION" = S.POPULATION
WHEN NOT MATCHED THEN INSERT ("MARKET_ID","POPULATION") VALUES (S.MARKET_ID, S.POPULATION);
-- Q0884 [OK]
INSERT INTO "MARKETS" ("MARKET_ID","POPULATION") VALUES (8664867, 2392249);
-- Q0885 [OK]
INSERT INTO "DIM_DATE" ("SALES_DATE") VALUES (DATE '2020-03-11');
-- Q0886 [FAIL]
SELECT "NOPE" FROM "SALES" LIMIT 10;
-- Q0887 [OK]
INSERT INTO "MARKETS" ("MARKET_ID","POPULATION") VALUES (9772926, 3884263);
-- Q0888 [OK]
DELETE FROM "SALES_POSITIONS" WHERE "SALES_ID" = 4552023;
-- Q0889 [OK]
DELETE FROM "SALES_POSITIONS" WHERE "SALES_ID" = 1394052;
-- Q0890 [OK]
SELECT "PRODUCT_CLASS" FROM "ARTICLE" LIMIT 100;
-- Q0891 [OK]
SELECT M."MARKET_ID", C."COUNTRY_CODE", M."POPULATION" FROM "MARKETS" M LEFT JOIN "CITIES" C ON C."CITY_ID" = M."CITY_ID" LIMIT 200;
-- Q0892 [FAIL]
SELEC COUNT(*) FROM "SALES";
-- Q0893 [OK]
SELECT
  S."MARKET_ID",
  S."SALES_DATE",
  S."SALES_ID",
  S."PRICE",
  SUM(S."PRICE") OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE") AS DAY_MARKET_REVENUE,
  ROW_NUMBER() OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE" ORDER BY S."PRICE" DESC NULLS LAST) AS RN
FROM "SALES" S
WHERE S."SALES_DATE" IS NOT NULL
QUALIFY RN <= 50
ORDER BY DAY_MARKET_REVENUE DESC NULLS LAST;
-- Q0894 [OK]
INSERT INTO "MARKETS" ("MARKET_ID","POPULATION") VALUES (2962584, 7890031);
-- Q0895 [FAIL]
INSERT INTO "MARKETS" ("MARKET_ID","NOPE") VALUES (1,2);
-- Q0896 [FAIL]
INSERT INTO "NO_SUCH_TABLE" ("A") VALUES (1);
-- Q0897 [OK]
MERGE INTO "MARKETS" T
USING (SELECT 1241323 AS MARKET_ID, 9959181 AS POPULATION) S
ON (T."MARKET_ID" = S.MARKET_ID)
WHEN MATCHED THEN UPDATE SET T."POPULATION" = S.POPULATION
WHEN NOT MATCHED THEN INSERT ("MARKET_ID","POPULATION") VALUES (S.MARKET_ID, S.POPULATION);
-- Q0898 [OK]
SELECT "LONGITUDE" FROM "MARKETS" WHERE "LONGITUDE" IS NOT NULL LIMIT 100;
-- Q0899 [OK]
SELECT M."MARKET_ID", C."COUNTRY_CODE", M."POPULATION" FROM "MARKETS" M LEFT JOIN "CITIES" C ON C."CITY_ID" = M."CITY_ID" LIMIT 200;
-- Q0900 [OK]
MERGE INTO "MARKETS" T
USING (SELECT 2804522 AS MARKET_ID, 5296987 AS POPULATION) S
ON (T."MARKET_ID" = S.MARKET_ID)
WHEN MATCHED THEN UPDATE SET T."POPULATION" = S.POPULATION
WHEN NOT MATCHED THEN INSERT ("MARKET_ID","POPULATION") VALUES (S.MARKET_ID, S.POPULATION);
-- Q0901 [OK]
SELECT "PURCHASE_PRICE", "DISTRIBUTION_COST", "TMP_OLD_NR" FROM "ARTICLE" WHERE "TMP_OLD_NR" IS NOT NULL LIMIT 100;
-- Q0902 [OK]
UPDATE "MARKETS" SET "POPULATION" = 16613722 WHERE "MARKET_ID" = 4089211;
-- Q0903 [OK]
SELECT
  S."MARKET_ID",
  S."SALES_DATE",
  S."SALES_ID",
  S."PRICE",
  SUM(S."PRICE") OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE") AS DAY_MARKET_REVENUE,
  ROW_NUMBER() OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE" ORDER BY S."PRICE" DESC NULLS LAST) AS RN
FROM "SALES" S
WHERE S."SALES_DATE" IS NOT NULL
QUALIFY RN <= 50
ORDER BY DAY_MARKET_REVENUE DESC NULLS LAST;
-- Q0904 [OK_PREP]
MERGE INTO "MARKETS" T
USING (SELECT ? AS MARKET_ID, ? AS POPULATION) S
ON (T."MARKET_ID" = S.MARKET_ID)
WHEN MATCHED THEN UPDATE SET T."POPULATION" = S.POPULATION
WHEN NOT MATCHED THEN INSERT ("MARKET_ID","POPULATION") VALUES (S.MARKET_ID, S.POPULATION);
-- Q0905 [OK]
MERGE INTO "MARKETS" T
USING (SELECT 592892 AS MARKET_ID, 587942 AS POPULATION) S
ON (T."MARKET_ID" = S.MARKET_ID)
WHEN MATCHED THEN UPDATE SET T."POPULATION" = S.POPULATION
WHEN NOT MATCHED THEN INSERT ("MARKET_ID","POPULATION") VALUES (S.MARKET_ID, S.POPULATION);
-- Q0906 [OK_PREP]
DELETE FROM "SALES_POSITIONS" WHERE "SALES_ID" = ?;
-- Q0907 [FAIL]
DELETE FROM "UNKNOWN_TABLE" WHERE 1=1;
-- Q0908 [OK]
DELETE FROM "SALES_POSITIONS" WHERE "SALES_ID" = 6859039;
-- Q0909 [OK]
MERGE INTO "MARKETS" T
USING (SELECT 2539297 AS MARKET_ID, 6842956 AS POPULATION) S
ON (T."MARKET_ID" = S.MARKET_ID)
WHEN MATCHED THEN UPDATE SET T."POPULATION" = S.POPULATION
WHEN NOT MATCHED THEN INSERT ("MARKET_ID","POPULATION") VALUES (S.MARKET_ID, S.POPULATION);
-- Q0910 [OK_PREP]
UPDATE "MARKETS" SET "POPULATION" = ? WHERE "MARKET_ID" = ?;
-- Q0911 [OK]
SELECT
  S."MARKET_ID",
  S."SALES_DATE",
  S."SALES_ID",
  S."PRICE",
  SUM(S."PRICE") OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE") AS DAY_MARKET_REVENUE,
  ROW_NUMBER() OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE" ORDER BY S."PRICE" DESC NULLS LAST) AS RN
FROM "SALES" S
WHERE S."SALES_DATE" IS NOT NULL
QUALIFY RN <= 50
ORDER BY DAY_MARKET_REVENUE DESC NULLS LAST;
-- Q0912 [OK]
UPDATE "MARKETS" SET "POPULATION" = 9806459 WHERE "MARKET_ID" = 8427666;
-- Q0913 [OK]
SELECT "PURCHASE_PRICE", "BASE_SALES_PRICE", "PRODUCT_GROUP", "PRODUCT_GROUP_DESC" FROM "ARTICLE";
-- Q0914 [OK]
UPDATE "MARKETS" SET "POPULATION" = 5420125 WHERE "MARKET_ID" = 2460254;
-- Q0915 [OK_PREP]
INSERT INTO "DIM_DATE" ("SALES_DATE") VALUES (?);
-- Q0916 [OK_PREP]
INSERT INTO "MARKETS" ("MARKET_ID","POPULATION") VALUES (?, ?);
-- Q0917 [OK]
SELECT
  S."MARKET_ID",
  S."SALES_DATE",
  S."SALES_ID",
  S."PRICE",
  SUM(S."PRICE") OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE") AS DAY_MARKET_REVENUE,
  ROW_NUMBER() OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE" ORDER BY S."PRICE" DESC NULLS LAST) AS RN
FROM "SALES" S
WHERE S."SALES_DATE" IS NOT NULL
QUALIFY RN <= 50
ORDER BY DAY_MARKET_REVENUE DESC NULLS LAST;
-- Q0918 [OK]
INSERT INTO "DIM_DATE" ("SALES_DATE") VALUES (DATE '2011-11-18');
-- Q0919 [OK]
INSERT INTO "MARKETS" ("MARKET_ID","POPULATION") VALUES (222891, 9487324);
-- Q0920 [OK]
SELECT
  S."MARKET_ID",
  S."SALES_DATE",
  S."SALES_ID",
  S."PRICE",
  SUM(S."PRICE") OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE") AS DAY_MARKET_REVENUE,
  ROW_NUMBER() OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE" ORDER BY S."PRICE" DESC NULLS LAST) AS RN
FROM "SALES" S
WHERE S."SALES_DATE" IS NOT NULL
QUALIFY RN <= 50
ORDER BY DAY_MARKET_REVENUE DESC NULLS LAST;
-- Q0921 [OK]
INSERT INTO "MARKETS" ("MARKET_ID","POPULATION") VALUES (1750488, 1727591);
-- Q0922 [OK]
INSERT INTO "MARKETS" ("MARKET_ID","POPULATION") VALUES (9337643, 8085283);
-- Q0923 [OK]
INSERT INTO "MARKETS" ("MARKET_ID","POPULATION") VALUES (6690247, 2239585);
-- Q0924 [OK]
INSERT INTO "MARKETS" ("MARKET_ID","POPULATION") VALUES (7806087, 2893396);
-- Q0925 [OK]
INSERT INTO "DIM_DATE" ("SALES_DATE") VALUES (DATE '2020-11-14');
-- Q0926 [OK]
MERGE INTO "MARKETS" T
USING (SELECT 733239 AS MARKET_ID, 9389976 AS POPULATION) S
ON (T."MARKET_ID" = S.MARKET_ID)
WHEN MATCHED THEN UPDATE SET T."POPULATION" = S.POPULATION
WHEN NOT MATCHED THEN INSERT ("MARKET_ID","POPULATION") VALUES (S.MARKET_ID, S.POPULATION);
-- Q0927 [OK]
SELECT M."MARKET_ID", C."COUNTRY_CODE", M."POPULATION" FROM "MARKETS" M LEFT JOIN "CITIES" C ON C."CITY_ID" = M."CITY_ID" LIMIT 200;
-- Q0928 [OK]
SELECT "CITY_ID", "LATITUDE", "AREA", "CITY" FROM "MARKETS" WHERE "AREA" IS NOT NULL LIMIT 100;
-- Q0929 [OK]
DELETE FROM "SALES_POSITIONS" WHERE "SALES_ID" = 1193134;
-- Q0930 [OK]
SELECT
  S."MARKET_ID",
  S."SALES_DATE",
  S."SALES_ID",
  S."PRICE",
  SUM(S."PRICE") OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE") AS DAY_MARKET_REVENUE,
  ROW_NUMBER() OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE" ORDER BY S."PRICE" DESC NULLS LAST) AS RN
FROM "SALES" S
WHERE S."SALES_DATE" IS NOT NULL
QUALIFY RN <= 50
ORDER BY DAY_MARKET_REVENUE DESC NULLS LAST;
-- Q0931 [FAIL]
SELECT M."MARKET_ID" FROM "MARKETS" M WHERE M."CITY_NAME" IS NOT NULL;
-- Q0932 [OK]
SELECT "DISTRICT", "COUNTRY_CODE" FROM "CITIES" WHERE "DISTRICT" IS NOT NULL LIMIT 100;
-- Q0933 [OK]
INSERT INTO "DIM_DATE" ("SALES_DATE") VALUES (DATE '2007-11-11');
-- Q0934 [OK]
DELETE FROM "SALES_POSITIONS" WHERE "SALES_ID" = 8367619;
-- Q0935 [OK]
INSERT INTO "DIM_DATE" ("SALES_DATE") VALUES (DATE '2008-01-05');
-- Q0936 [OK]
MERGE INTO "MARKETS" T
USING (SELECT 8720513 AS MARKET_ID, 1943211 AS POPULATION) S
ON (T."MARKET_ID" = S.MARKET_ID)
WHEN MATCHED THEN UPDATE SET T."POPULATION" = S.POPULATION
WHEN NOT MATCHED THEN INSERT ("MARKET_ID","POPULATION") VALUES (S.MARKET_ID, S.POPULATION);
-- Q0937 [OK_PREP]
INSERT INTO "DIM_DATE" ("SALES_DATE") VALUES (?);
-- Q0938 [OK]
SELECT
  S."MARKET_ID",
  S."SALES_DATE",
  S."SALES_ID",
  S."PRICE",
  SUM(S."PRICE") OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE") AS DAY_MARKET_REVENUE,
  ROW_NUMBER() OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE" ORDER BY S."PRICE" DESC NULLS LAST) AS RN
FROM "SALES" S
WHERE S."SALES_DATE" IS NOT NULL
QUALIFY RN <= 50
ORDER BY DAY_MARKET_REVENUE DESC NULLS LAST;
-- Q0939 [OK]
DELETE FROM "SALES_POSITIONS" WHERE "SALES_ID" = 376358;
-- Q0940 [OK]
SELECT
  S."MARKET_ID",
  S."SALES_DATE",
  S."SALES_ID",
  S."PRICE",
  SUM(S."PRICE") OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE") AS DAY_MARKET_REVENUE,
  ROW_NUMBER() OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE" ORDER BY S."PRICE" DESC NULLS LAST) AS RN
FROM "SALES" S
WHERE S."SALES_DATE" IS NOT NULL
QUALIFY RN <= 50
ORDER BY DAY_MARKET_REVENUE DESC NULLS LAST;
-- Q0941 [OK]
SELECT M."MARKET_ID", C."COUNTRY_CODE", M."POPULATION" FROM "MARKETS" M LEFT JOIN "CITIES" C ON C."CITY_ID" = M."CITY_ID" LIMIT 200;
-- Q0942 [OK]
MERGE INTO "MARKETS" T
USING (SELECT 7845545 AS MARKET_ID, 7479695 AS POPULATION) S
ON (T."MARKET_ID" = S.MARKET_ID)
WHEN MATCHED THEN UPDATE SET T."POPULATION" = S.POPULATION
WHEN NOT MATCHED THEN INSERT ("MARKET_ID","POPULATION") VALUES (S.MARKET_ID, S.POPULATION);
-- Q0943 [OK]
MERGE INTO "MARKETS" T
USING (SELECT 6082282 AS MARKET_ID, 1734710 AS POPULATION) S
ON (T."MARKET_ID" = S.MARKET_ID)
WHEN MATCHED THEN UPDATE SET T."POPULATION" = S.POPULATION
WHEN NOT MATCHED THEN INSERT ("MARKET_ID","POPULATION") VALUES (S.MARKET_ID, S.POPULATION);
-- Q0944 [OK]
INSERT INTO "DIM_DATE" ("SALES_DATE") VALUES (DATE '2021-12-23');
-- Q0945 [OK]
DELETE FROM "SALES_POSITIONS" WHERE "SALES_ID" = 661531;
-- Q0946 [OK]
SELECT "AMOUNT", "ARTICLE_ID" FROM "SALES_POSITIONS" LIMIT 100;
-- Q0947 [OK]
UPDATE "MARKETS" SET "POPULATION" = 19101907 WHERE "MARKET_ID" = 2832995;
-- Q0948 [OK]
SELECT
  S."MARKET_ID",
  S."SALES_DATE",
  S."SALES_ID",
  S."PRICE",
  SUM(S."PRICE") OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE") AS DAY_MARKET_REVENUE,
  ROW_NUMBER() OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE" ORDER BY S."PRICE" DESC NULLS LAST) AS RN
FROM "SALES" S
WHERE S."SALES_DATE" IS NOT NULL
QUALIFY RN <= 50
ORDER BY DAY_MARKET_REVENUE DESC NULLS LAST;
-- Q0949 [OK]
UPDATE "MARKETS" SET "POPULATION" = 13422746 WHERE "MARKET_ID" = 7233003;
-- Q0950 [OK]
SELECT
  S."MARKET_ID",
  S."SALES_DATE",
  S."SALES_ID",
  S."PRICE",
  SUM(S."PRICE") OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE") AS DAY_MARKET_REVENUE,
  ROW_NUMBER() OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE" ORDER BY S."PRICE" DESC NULLS LAST) AS RN
FROM "SALES" S
WHERE S."SALES_DATE" IS NOT NULL
QUALIFY RN <= 50
ORDER BY DAY_MARKET_REVENUE DESC NULLS LAST;
-- Q0951 [OK]
UPDATE "MARKETS" SET "POPULATION" = 17798277 WHERE "MARKET_ID" = 8809806;
-- Q0952 [OK_PREP]
SELECT * FROM "ARTICLE" WHERE "ARTICLE_ID" = ?;
-- Q0953 [OK]
UPDATE "MARKETS" SET "POPULATION" = 11850970 WHERE "MARKET_ID" = 2536311;
-- Q0954 [OK]
INSERT INTO "DIM_DATE" ("SALES_DATE") VALUES (DATE '2022-08-23');
-- Q0955 [FAIL]
UPDATE "UNKNOWN_TABLE" SET "X" = 1;
-- Q0956 [OK]
INSERT INTO "MARKETS" ("MARKET_ID","POPULATION") VALUES (8123578, 5581704);
-- Q0957 [OK]
SELECT M."MARKET_ID", C."COUNTRY_CODE", M."POPULATION" FROM "MARKETS" M LEFT JOIN "CITIES" C ON C."CITY_ID" = M."CITY_ID" LIMIT 200;
-- Q0958 [OK]
MERGE INTO "MARKETS" T
USING (SELECT 911137 AS MARKET_ID, 1665942 AS POPULATION) S
ON (T."MARKET_ID" = S.MARKET_ID)
WHEN MATCHED THEN UPDATE SET T."POPULATION" = S.POPULATION
WHEN NOT MATCHED THEN INSERT ("MARKET_ID","POPULATION") VALUES (S.MARKET_ID, S.POPULATION);
-- Q0959 [OK]
INSERT INTO "DIM_DATE" ("SALES_DATE") VALUES (DATE '2007-12-04');
-- Q0960 [OK]
SELECT "DISTRICT", "CITY_NAME" FROM "CITIES" LIMIT 100;
-- Q0961 [OK]
SELECT "ZIP_CODE" FROM "CITIES" LIMIT 100;
-- Q0962 [OK]
INSERT INTO "MARKETS" ("MARKET_ID","POPULATION") VALUES (9334544, 7161679);
-- Q0963 [OK]
MERGE INTO "MARKETS" T
USING (SELECT 4664521 AS MARKET_ID, 5641453 AS POPULATION) S
ON (T."MARKET_ID" = S.MARKET_ID)
WHEN MATCHED THEN UPDATE SET T."POPULATION" = S.POPULATION
WHEN NOT MATCHED THEN INSERT ("MARKET_ID","POPULATION") VALUES (S.MARKET_ID, S.POPULATION);
-- Q0964 [OK]
UPDATE "MARKETS" SET "POPULATION" = 4052149 WHERE "MARKET_ID" = 2211756;
-- Q0965 [OK]
INSERT INTO "DIM_DATE" ("SALES_DATE") VALUES (DATE '2012-07-23');
-- Q0966 [OK]
SELECT "LATITUDE", "LONGITUDE", "AREA", "CITY" FROM "MARKETS" LIMIT 100;
-- Q0967 [OK]
SELECT
  S."MARKET_ID",
  S."SALES_DATE",
  S."SALES_ID",
  S."PRICE",
  SUM(S."PRICE") OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE") AS DAY_MARKET_REVENUE,
  ROW_NUMBER() OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE" ORDER BY S."PRICE" DESC NULLS LAST) AS RN
FROM "SALES" S
WHERE S."SALES_DATE" IS NOT NULL
QUALIFY RN <= 50
ORDER BY DAY_MARKET_REVENUE DESC NULLS LAST;
-- Q0968 [OK]
SELECT M."MARKET_ID", C."COUNTRY_CODE", M."POPULATION" FROM "MARKETS" M LEFT JOIN "CITIES" C ON C."CITY_ID" = M."CITY_ID" LIMIT 200;
-- Q0969 [OK]
UPDATE "MARKETS" SET "POPULATION" = 423507 WHERE "MARKET_ID" = 9215057;
-- Q0970 [OK]
UPDATE "MARKETS" SET "POPULATION" = 18502860 WHERE "MARKET_ID" = 199;
-- Q0971 [OK]
SELECT
  S."MARKET_ID",
  S."SALES_DATE",
  S."SALES_ID",
  S."PRICE",
  SUM(S."PRICE") OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE") AS DAY_MARKET_REVENUE,
  ROW_NUMBER() OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE" ORDER BY S."PRICE" DESC NULLS LAST) AS RN
FROM "SALES" S
WHERE S."SALES_DATE" IS NOT NULL
QUALIFY RN <= 50
ORDER BY DAY_MARKET_REVENUE DESC NULLS LAST;
-- Q0972 [OK]
INSERT INTO "DIM_DATE" ("SALES_DATE") VALUES (DATE '2023-12-22');
-- Q0973 [OK]
SELECT S."SALES_ID", S."SALES_DATE", SP."ARTICLE_ID", SP."AMOUNT" FROM "SALES" S JOIN "SALES_POSITIONS" SP ON SP."SALES_ID" = S."SALES_ID" LIMIT 200;
-- Q0974 [OK]
MERGE INTO "MARKETS" T
USING (SELECT 4631737 AS MARKET_ID, 3598983 AS POPULATION) S
ON (T."MARKET_ID" = S.MARKET_ID)
WHEN MATCHED THEN UPDATE SET T."POPULATION" = S.POPULATION
WHEN NOT MATCHED THEN INSERT ("MARKET_ID","POPULATION") VALUES (S.MARKET_ID, S.POPULATION);
-- Q0975 [OK]
INSERT INTO "DIM_DATE" ("SALES_DATE") VALUES (DATE '2015-02-27');
-- Q0976 [OK]
INSERT INTO "DIM_DATE" ("SALES_DATE") VALUES (DATE '2018-05-10');
-- Q0977 [OK]
INSERT INTO "DIM_DATE" ("SALES_DATE") VALUES (DATE '2015-01-13');
-- Q0978 [OK]
MERGE INTO "MARKETS" T
USING (SELECT 6064356 AS MARKET_ID, 3049970 AS POPULATION) S
ON (T."MARKET_ID" = S.MARKET_ID)
WHEN MATCHED THEN UPDATE SET T."POPULATION" = S.POPULATION
WHEN NOT MATCHED THEN INSERT ("MARKET_ID","POPULATION") VALUES (S.MARKET_ID, S.POPULATION);
-- Q0979 [OK_PREP]
INSERT INTO "MARKETS" ("MARKET_ID","POPULATION") VALUES (?, ?);
-- Q0980 [OK]
DELETE FROM "SALES_POSITIONS" WHERE "SALES_ID" = 1344657;
-- Q0981 [OK]
INSERT INTO "MARKETS" ("MARKET_ID","POPULATION") VALUES (8924001, 8712740);
-- Q0982 [OK]
SELECT
  S."MARKET_ID",
  S."SALES_DATE",
  S."SALES_ID",
  S."PRICE",
  SUM(S."PRICE") OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE") AS DAY_MARKET_REVENUE,
  ROW_NUMBER() OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE" ORDER BY S."PRICE" DESC NULLS LAST) AS RN
FROM "SALES" S
WHERE S."SALES_DATE" IS NOT NULL
QUALIFY RN <= 50
ORDER BY DAY_MARKET_REVENUE DESC NULLS LAST;
-- Q0983 [OK]
UPDATE "MARKETS" SET "POPULATION" = 5627790 WHERE "MARKET_ID" = 5760155;
-- Q0984 [OK]
INSERT INTO "MARKETS" ("MARKET_ID","POPULATION") VALUES (7040047, 3302980);
-- Q0985 [OK]
SELECT
  S."MARKET_ID",
  S."SALES_DATE",
  S."SALES_ID",
  S."PRICE",
  SUM(S."PRICE") OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE") AS DAY_MARKET_REVENUE,
  ROW_NUMBER() OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE" ORDER BY S."PRICE" DESC NULLS LAST) AS RN
FROM "SALES" S
WHERE S."SALES_DATE" IS NOT NULL
QUALIFY RN <= 50
ORDER BY DAY_MARKET_REVENUE DESC NULLS LAST;
-- Q0986 [OK]
INSERT INTO "MARKETS" ("MARKET_ID","POPULATION") VALUES (6504770, 9954282);
-- Q0987 [OK]
SELECT SP."SALES_ID", A."PRODUCT_GROUP", SUM(SP."AMOUNT") AS UNITS FROM "SALES_POSITIONS" SP JOIN "ARTICLE" A ON A."ARTICLE_ID" = SP."ARTICLE_ID" GROUP BY SP."SALES_ID", A."PRODUCT_GROUP" ORDER BY UNITS DESC NULLS LAST LIMIT 200;
-- Q0988 [OK]
SELECT "LATITUDE", "CITY_ID" FROM "MARKETS" WHERE "LATITUDE" IS NOT NULL LIMIT 100;
-- Q0989 [OK]
SELECT SP."SALES_ID", A."PRODUCT_GROUP", SUM(SP."AMOUNT") AS UNITS FROM "SALES_POSITIONS" SP JOIN "ARTICLE" A ON A."ARTICLE_ID" = SP."ARTICLE_ID" GROUP BY SP."SALES_ID", A."PRODUCT_GROUP" ORDER BY UNITS DESC NULLS LAST LIMIT 200;
-- Q0990 [OK]
DELETE FROM "SALES_POSITIONS" WHERE "SALES_ID" = 6811497;
-- Q0991 [OK]
DELETE FROM "SALES_POSITIONS" WHERE "SALES_ID" = 1148823;
-- Q0992 [OK]
DELETE FROM "SALES_POSITIONS" WHERE "SALES_ID" = 7975472;
-- Q0993 [OK]
INSERT INTO "DIM_DATE" ("SALES_DATE") VALUES (DATE '2022-05-27');
-- Q0994 [OK]
SELECT "BASE_SALES_PRICE", "PRODUCT_GROUP", "QUANTITY_UNIT" FROM "ARTICLE" LIMIT 100;
-- Q0995 [OK]
SELECT
  S."MARKET_ID",
  S."SALES_DATE",
  S."SALES_ID",
  S."PRICE",
  SUM(S."PRICE") OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE") AS DAY_MARKET_REVENUE,
  ROW_NUMBER() OVER (PARTITION BY S."MARKET_ID", S."SALES_DATE" ORDER BY S."PRICE" DESC NULLS LAST) AS RN
FROM "SALES" S
WHERE S."SALES_DATE" IS NOT NULL
QUALIFY RN <= 50
ORDER BY DAY_MARKET_REVENUE DESC NULLS LAST;
-- Q0996 [OK]
MERGE INTO "MARKETS" T
USING (SELECT 3093648 AS MARKET_ID, 7789255 AS POPULATION) S
ON (T."MARKET_ID" = S.MARKET_ID)
WHEN MATCHED THEN UPDATE SET T."POPULATION" = S.POPULATION
WHEN NOT MATCHED THEN INSERT ("MARKET_ID","POPULATION") VALUES (S.MARKET_ID, S.POPULATION);
-- Q0997 [OK]
UPDATE "MARKETS" SET "POPULATION" = 16058526 WHERE "MARKET_ID" = 4262278;
-- Q0998 [OK_PREP]
SELECT * FROM "CITIES" WHERE "COUNTRY_CODE" = ? LIMIT 100;
-- Q0999 [FAIL]
UPDATE "UNKNOWN_TABLE" SET "X" = 1;
-- Q1000 [OK]
MERGE INTO "MARKETS" T
USING (SELECT 6935459 AS MARKET_ID, 6152286 AS POPULATION) S
ON (T."MARKET_ID" = S.MARKET_ID)
WHEN MATCHED THEN UPDATE SET T."POPULATION" = S.POPULATION
WHEN NOT MATCHED THEN INSERT ("MARKET_ID","POPULATION") VALUES (S.MARKET_ID, S.POPULATION);
